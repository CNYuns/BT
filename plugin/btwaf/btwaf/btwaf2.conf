lua_socket_log_errors off;
lua_shared_dict spider 10m;
lua_shared_dict btwaf 30m;
lua_shared_dict drop_ip 10m;
lua_shared_dict drop_sum 30m;
lua_shared_dict btwaf_data 30m;
lua_shared_dict ipinfo 10m;
lua_shared_dict cc 30m;
lua_shared_dict smart_cc 20m;
lua_shared_dict uri_total 20m;
lua_shared_dict ip 10m;
lua_shared_dict ip_tmp 25m;
lua_shared_dict url_tmp 15m;
lua_shared_dict url 10m;
lua_shared_dict user 1m;
lua_shared_dict checklru 30m;
lua_shared_dict iplru 10m;
lua_package_path "/www/server/btwaf/?.lua;/www/server/btwaf/public/?.lua;/www/server/btwaf/lib/?.lua";
init_by_lua_file  /www/server/btwaf/init.lua;
#init_worker_by_lua_file /www/server/btwaf/worker.lua;
access_by_lua_file /www/server/btwaf/waf.lua;
header_filter_by_lua_file /www/server/btwaf/header.lua;
#body_filter_by_lua_file /www/server/btwaf/body.lua;
log_by_lua_file /www/server/btwaf/logs.lua;