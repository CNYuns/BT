import{c as e,s as a,o as s,r as l,v as t,x as o,y as r,e as n,C as c,z as i,D as m,A as u,ap as d,ad as p,ab as f}from"./base-lib.js?v=1764656280";import{p as y,_ as v}from"./validator.js?v=1764656280";import{u as _,Q as b,k as h,b as j,_ as x}from"./utils-lib.js?v=1764656280";import{b2 as w,b3 as V}from"./firewall.js?v=1764656280";import{H as C}from"./index346.js?v=1764656280";import{H as g}from"./store6.js?v=1764656280";import"./__commonjsHelpers__.js?v=1764656280";import"./index111.js?v=1764656280";import"./column.js?v=1764656280";import"./index108.js?v=1764656280";const k={class:"p-[2rem]"},D={class:"tip"},H=x(e({__name:"index",emits:["close"],setup(e,{expose:x,emit:H}){const S=C(),T=g(),{repairTypeActive:U}=a(S),{isMalwareConfirm:A}=a(T),I=H,{payment:q}=_(),z=j(),F=s({cycle:"0",channel:[],status:!0}),M=l(),N=l(!1),O=async(e=!1)=>{const{data:a}=await w();F.cycle=a.cycle,F.channel=""===a.channel?[]:a.channel.split(","),e&&z.success("刷新成功")};return x({onConfirm:async()=>{if("ltd"!==q.value.authType)return y({sourceId:59}),void z.error("抱歉！该功能为企业版专享功能！");F.channel=F.channel.filter(e=>e);let e=F.channel.join(",");e?(await M.value.validate(),b({loading:N,request:V({day:Number(F.cycle),channel:e,status:F.status?1:0}),message:!0,success:e=>{e.status&&(O(),"overview"===U.value&&(A.value=!0,T.setCapabilityStatus("vul_scan",F.status),T.getSafeOverviewData()),I("close"))}})):z.error("请选择告警方式")}}),t(()=>{O()}),(e,a)=>{const s=d,l=p,t=h,y=v,_=f;return o(),r("div",k,[n(_,{model:i(F),ref_key:"safeScanForm",ref:M,disabled:i(N)},{default:c(()=>[n(l,{label:"自动扫描"},{default:c(()=>[n(s,{modelValue:i(F).status,"onUpdate:modelValue":a[0]||(a[0]=e=>i(F).status=e)},null,8,["modelValue"])]),_:1}),n(l,{label:"周期",prop:"cycle"},{default:c(()=>[n(t,{class:"!w-[14rem]",modelValue:i(F).cycle,"onUpdate:modelValue":a[1]||(a[1]=e=>i(F).cycle=e),min:0,type:"number",textType:"天"},{append:c(()=>[...a[4]||(a[4]=[m(" 天 ",-1)])]),_:1},8,["modelValue"])]),_:1}),n(l,{label:"告警方式",prop:"give"},{default:c(()=>[n(y,{class:"!w-[36rem]",modelValue:i(F).channel,"onUpdate:modelValue":a[2]||(a[2]=e=>i(F).channel=e),limit:["sms","wx_account"]},null,8,["modelValue"])]),_:1})]),_:1},8,["model","disabled"]),u("div",D,[u("ul",null,[u("li",null,[a[5]||(a[5]=m(" 点击配置后状态未更新，尝试点击【 ",-1)),u("span",{class:"text-primary hover:text-primaryDark cursor-pointer",onClick:a[3]||(a[3]=e=>O(!0))},"手动刷新"),a[6]||(a[6]=m(" 】 ",-1))])])])])}}}),[["__scopeId","data-v-08a50683"]]);export{H as default};
