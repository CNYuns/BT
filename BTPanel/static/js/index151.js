import{_ as t}from"./index109.js?v=1764728423";import{p as a,V as e,Q as s,l as i,b as o}from"./utils-lib.js?v=1764728423";import{cx as c,cg as n,cO as l,cP as r,cu as m,cQ as p,cR as d,cS as u,cT as f}from"./validator.js?v=1764728423";import{c as h,r as y,aE as b,v as x,x as g,y as j,e as _,C as w,z as k}from"./base-lib.js?v=1764728423";import{u as v}from"./column.js?v=1764728423";import"./__commonjsHelpers__.js?v=1764728423";import"./index110.js?v=1764728423";import"./index107.js?v=1764728423";const N={class:"py-[1rem] px-16px"},q=h({__name:"index",props:{compData:{default:()=>({})}},emits:["close"],setup(h,{expose:q,emit:C}){const D=o(),T=h,E=C,L=y(T.compData.editorTabsActive.history||[]),Q=[{label:"版本时间",prop:"time",render:t=>b("span",{},(t=>{const a=new Date(1e3*Number(t));return isNaN(a.getTime())?t:e(a)})(t))},v([{onClick:async t=>{const a={filename:n.path,history:t},e=await s({request:l(a)}),i=r(n.id);e.status?(m.value={id:n.id,st_mtime:t,path:n.path,type:"editor"},E("close"),await p({title:"".concat(n.title," <-> ").concat(n.title),type:"diff",mode:"diff",path:n.path}),await d({mode:"ace/mode/".concat(n.mode),left:{content:e.data.data,editable:!1,copyLinkEnabled:!1},right:{content:i.getValue(),editable:!1,copyLinkEnabled:!1}})):D.request(e)},width:65,title:"文件对比"},{onClick:async t=>{await a({title:"恢复历史文件",content:"是否恢复历史文件 ".concat(e(Number(t)),"?恢复历史文件后，当前文件内容将会被替换！")}),s({loading:"正在恢复历史文件，请稍后...",request:c({filename:n.path,history:t}),message:!0,success:t=>{t.status&&(T.compData.callback(),R())}})},title:"恢复"},{onClick:async t=>{await a({title:"删除历史文件",content:"是否删除历史文件 ".concat(e(Number(t)),"?删除历史文件后，将无法恢复！")}),s({loading:"正在删除历史文件，请稍后...",request:u({filename:n.path||"",history:t}),message:!0,success:t=>{t.status&&R()}})},title:"删除"}])],R=async()=>{try{const{data:t}=await f(n.path);L.value=t.historys}catch(t){}};return x(()=>{R()}),q({}),(a,e)=>{const s=i,o=t;return g(),j("div",N,[_(o,null,{content:w(()=>[_(s,{ref:"fileTableRef",height:"40rem",column:Q,description:"列表为空",data:k(L)},null,8,["data"])]),_:1})])}}});export{q as default};
