import{_ as t}from"./index109.js?v=1764728423";import{_ as e}from"./index118.js?v=1764728423";import{bT as a,V as s,Q as r,W as o,l as n}from"./utils-lib.js?v=1764728423";import{X as i}from"./firewall.js?v=1764728423";import{c as l,r as p,e as m,o as d,w as c,v as _,x as u,O as w,C as j,z as f}from"./base-lib.js?v=1764728423";import{k as h}from"./useController14.js?v=1764728423";import{u as b}from"./column.js?v=1764728423";import{dj as g}from"./validator.js?v=1764728423";import"./__commonjsHelpers__.js?v=1764728423";import"./useStore4.js?v=1764728423";import"./site.js?v=1764728423";import"./useController6.js?v=1764728423";import"./index110.js?v=1764728423";import"./index107.js?v=1764728423";const k=l({__name:"risk-detail",props:{compData:{default:()=>{}}},setup(l){const k=l,x=p([]),y=p(0),C=(t,e)=>{g({path:t})},v=p([{label:"巡检时间",width:"150px",render:t=>{const e=a(t.time,"number",0);return m("span",null,[s(e)])}},{label:"URL",render:t=>m("span",{class:"bt-link",title:t.url,onClick:()=>window.open(t.url,"_blank","noopener,noreferrer")},[t.url])},{label:"关键词",prop:"content",width:"200px"},{label:"类型",prop:"risk_content",width:"200px"},{label:"风险位置",width:"150px",render:t=>h[t.risk_type]},b([{onClick:t=>{let e="/www/server/panel/class/projectModel/content/source/",a=e+t.source_file;t.risk_type.indexOf("_update")>-1?((t,e)=>{"title_hash_update"!==t.risk_type&&"tail_hash_update"!==t.risk_type||(e="/www/server/panel/class/projectModel/content/hash/"+t.site_name+"/"),t.source_content_file;let a=e+t.new_content_file;C(a)})(t,e):C(a,t.content)},title:"详情"}])]),D=d({p:1,limit:10,testing_id:k.compData.testing_id}),U=async(t=1)=>{await r({loading:"正在获取IP规则列表，请稍后...",request:i(D),data:{data:[Array,x],page:o(y)}})};return c(()=>k.compData,t=>{D.testing_id=t.testing_id}),_(()=>U()),(a,s)=>{const r=n,o=e,i=t;return u(),w(i,{class:"p-[2rem]"},{content:j(()=>[m(r,{column:f(v),data:f(x)},null,8,["column","data"])]),"footer-right":j(()=>[m(o,{total:f(y),page:f(D).p,"onUpdate:page":s[0]||(s[0]=t=>f(D).p=t),row:f(D).limit,"onUpdate:row":s[1]||(s[1]=t=>f(D).limit=t),onChange:U},null,8,["total","page","row"])]),_:1})}}});export{k as default};
