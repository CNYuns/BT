import{_ as e}from"./index109.js?v=1764728423";import{_ as t}from"./index118.js?v=1764728423";import{u as a,bT as s,V as r,Q as o,W as l,l as i}from"./utils-lib.js?v=1764728423";import{getRiskList as n}from"./site.js?v=1764728423";import{c as p,W as m,r as c,b8 as d,v as u,I as _,x as h,O as f,C as j,J as w,z as b,e as x,L as g}from"./base-lib.js?v=1764728423";import{u as k}from"./column.js?v=1764728423";import{k as v}from"./useController14.js?v=1764728423";import{dj as y}from"./validator.js?v=1764728423";import"./__commonjsHelpers__.js?v=1764728423";import"./index110.js?v=1764728423";import"./useStore4.js?v=1764728423";import"./useController6.js?v=1764728423";import"./index107.js?v=1764728423";const C=p({__name:"risk-list",props:{compData:{default:()=>({isPopup:!1})}},setup(p){const C=p,{mainHeight:U}=a(),D=m(!1),H=c([]),L=c(0),M=c(C.compData.isPopup),O=(e,t)=>{y({path:e})},P=e=>{var t;let a="/www/server/panel/class/projectModel/content/source/",s=a+e.source_file;(null==(t=e.risk_type)?void 0:t.indexOf("_update"))>-1?((e,t)=>{"title_hash_update"!==e.risk_type&&"tail_hash_update"!==e.risk_type||(t="/www/server/panel/class/projectModel/content/hash/"+e.site_name+"/"),e.source_content_file;let a=t+e.new_content_file;O(a)})(e,a):O(s,e.content)},W=d({p:1,limit:20}),q=async()=>{await o({loading:D,request:n({...W}),data:{data:[Array,H],page:l(L)}})},z=[{label:"巡检时间",width:"150px",render:e=>{const t=s(e.time,"number",0);return x("span",null,[r(t)])}},{label:"URL",render:e=>x("span",{class:"bt-link",title:e.url,onClick:()=>window.open(e.url,"_blank","noopener,noreferrer")},[e.url])},{label:"关键词",prop:"content",width:"200px"},{label:"类型",prop:"risk_content",width:"200px"},{label:"风险位置",width:"150px",render:e=>v[e.risk_type]},k([{onClick:P,title:"详情"}])];return u(()=>q()),(a,s)=>{const r=i,o=t,l=e,n=_("bt-loading");return h(),f(l,{class:g({"p-[2rem]":b(M)})},{content:j(()=>[w(x(r,{ref:"table",column:b(z),data:b(H),description:"风险列表为空","max-height":b(M)?500:b(U)-300},null,8,["column","data","max-height"]),[[n,b(D)],[n,"正在加载风险列表，请稍后...","title"]])]),"footer-right":j(()=>[x(o,{total:b(L),page:b(W).p,"onUpdate:page":s[0]||(s[0]=e=>b(W).p=e),row:b(W).limit,"onUpdate:row":s[1]||(s[1]=e=>b(W).limit=e),onChange:q},null,8,["total","page","row"])]),_:1},8,["class"])}}});export{C as default};
