import{u as e,it as t,M as o,iu as a,Q as i,iv as n,iw as c,ix as s,iy as u,am as l,aK as r,p as d,eB as p,n as v,H as y,iz as m,iA as f,b as M,V as h,iB as g,iC as I,iD as T,iE as w,iF as b,b5 as N,eA as C,iG as P,iH as L}from"./utils-lib.js?v=1764728423";import{j as _,r as E,t as D,o as A,k as O,g as x}from"./base-lib.js?v=1764728423";import{p as B,b as S}from"./validator.js?v=1764728423";const V=_("PRODUCT-PAYMENT-STORE",()=>{const _=E({}),V=E(),R=E(!1),{payment:q,paymentVoucherType:U,authTypeTitle:F,isUpdatePayment:j,isRefreshSoftList:H,setAuthState:k,authExpirationTime:W,forceLtd:Y,aliyunEcsLtd:G,getUnbindNumber:J}=e(),{authType:K,voucherOpenTime:z,newUserVoucherOpenTime:Q,bindUser:Z,isGetCoupon:$}=D(q.value),X=E(!1),ee=E(),te=E(!1),oe=E(!1),ae=A({}),ie=E(!0),ne=E(!1),ce=A({cycleMode:{activeCycleInfo:{cycle:12},list:[]},numsMode:{list:[],activeNumsInfo:{count:1,price:0,discount:0}},couponMode:{status:!1,activeCouponId:"",activeCouponInfo:{},discountsTitle:"",disabled:!1,count:0,list:[],endTimeNum:0},couponInfo:{[t.pro]:[],[t.ltd]:[],[t.dev]:[]},enterpriseMode:{status:!1,isHidden:!1},devCycleInfo:{isGetOperated:!1,data:{}},voucherMode:{loading:!1,isExist:!1,proTypeList:{},typeActive:0,typeList:{},list:[],active:0,activeInfo:{pid:0,code:""}},payMode:{activePayType:"wechat",activeBuyInfo:{price:0,count:0,cycle:0,originalPrice:0,discount:0},activeBalanceInfo:{},balance:0,activePayCode:{apliy:"",wechat:""},qrcode:{value:"",size:110},payTips:{status:!1,name:"",day:0},isLastBuyRepeat:!1,lastPayTime:0,createOrderTime:[]}}),se=A({right:!0,left:!1}),ue=E(!1),le=A({d:"00",h:"00",m:"00",s:"00"});let re=null,de=null;const pe=A({status:!0,title:"正在获取产品信息，请稍侯..."}),ve=A({status:!0,title:"正在生成支付订单，请稍侯..."}),ye=A({status:!1,title:""}),me=E(!1),fe=E(!1),Me=E(),he=E(0),ge=O("payCloseCount",0),Ie=x(()=>"".concat("alipay"===(null==ce?void 0:ce.payMode.activePayType)?"ali":"wechat","-pay.svg")),Te=()=>{var e;const t=document.getElementById("list-box"),o=172*ce.cycleMode.list.length;if(null===t)return;const a=t.clientWidth;if(o<a)return;const i=document.getElementById("list"),n=Math.abs(parseInt(null==(e=window.getComputedStyle(i,null))?void 0:e.left,10));n+a-360<a?(i.style.left="0px",se.right=!0,se.left=!1):i.style.left="-".concat(n-360,"px")},we=async e=>{Te(),pe.status=!0,ce.enterpriseMode.status=!1;const{ltd:o}=t;switch("string"==typeof e&&(e=ae.typeList.find(t=>t.type===e)),ae.activeTypeInfo=e,ce.cycleMode.list=[],ce.numsMode.activeNumsInfo.count=1,ae.unbindAuthor.status=!1,ae.unbindAuthor.count=0,ot(),e.type){case"coupon":pe.title="正在获取产品抵扣券，请稍侯...",await tt({pid:e.pid}),pe.status=!1,ce.voucherMode.proTypeList[t.coupon]&&Xe({pid:t.coupon,list:ce.voucherMode.proTypeList[t.coupon].list}),ce.voucherMode.proTypeList[t.pro]&&Xe({pid:t.pro,list:ce.voucherMode.proTypeList[t.pro].list}),ce.voucherMode.proTypeList[o]&&Xe({pid:o,list:ce.voucherMode.proTypeList[o].list});break;case"plugin":case"ltd":case"pro":case"dev":pe.title="正在获取产品信息，请稍侯...",Z.value?await $e(e.pid):(vt(e.type),mt(),je()),pe.status=!1,be(ce.cycleMode.list[0])}},be=async(e,t)=>{var o;yt("cycle",e)&&(ce.numsMode.list=e.nums,ce.cycleMode.activeCycleInfo=e,ce.enterpriseMode.isHidden=!("ltd"===(null==ae?void 0:ae.activeTypeInfo.type)&&12===e.cycle),void 0===t&&!ce.enterpriseMode.isHidden&&ce.enterpriseMode.status&&(ce.enterpriseMode.status=!1),ot(),(null==(o=e.nums)?void 0:o.length)&&await Ne(e.nums[0]))},Ne=async e=>{var t,o;if(!yt("nums",e))return;ce.numsMode.activeNumsInfo=e;const a=[],{list:i}=ce.couponMode;if(("pro"===(null==ae?void 0:ae.activeTypeInfo.type)||"ltd"===(null==ae?void 0:ae.activeTypeInfo.type))&&i.length>0&&(i.forEach(t=>{Number(t.val1)<=e.price&&a.push(t)}),a.length))return ce.couponMode.status=!0,a.sort((e,t)=>Number(t.val2)-Number(e.val2)),Ce(null==(t=a[0].id)?void 0:t.toString()),!1;if(!ue.value&&ce.couponMode.count>0){const t=i.filter(t=>Number(t.val1)<=e.price)[0];t||(ce.couponMode.status=!1),ue.value=!0,ce.couponMode.activeCouponId=null==(o=null==t?void 0:t.id)?void 0:o.toString(),ce.couponMode.endTimeNum=Math.floor((null==t?void 0:t.endtime)-Math.floor((new Date).getTime()/1e3))}Le()},Ce=async e=>{if(!e)return ce.couponMode.status=!1,o.error("请选择优惠券");const t=ce.couponMode.list.find(t=>t.id===Number(e))||{};if(t.val1&&Number(t.val1)<=ce.numsMode.activeNumsInfo.price){ce.couponMode.status=!0,ce.couponMode.activeCouponId=e.toString();const t=ce.couponMode.list.find(t=>t.id===Number(e));void 0!==t&&(ce.couponMode.activeCouponInfo=t,ce.couponMode.endTimeNum=Math.floor(t.endtime-Math.floor((new Date).getTime()/1e3)),t.name.indexOf("0.99")>-1?ce.couponMode.discountsTitle=t.name:ce.couponMode.discountsTitle="已使用优惠券，立减".concat(t.val2,"元"))}Le()},Pe=E(!1),Le=async(e={pid:Number(ce.numsMode.activeNumsInfo.pid),cycle:Number(ce.cycleMode.activeCycleInfo.cycle),source:Number(ee.value),num:Number(ce.numsMode.activeNumsInfo.count),coupon:ce.couponMode.status&&ce.couponMode.activeCouponId||"",get_ali_msg:0,regain:0},s=!0)=>{var u;if(!G.value)try{const l=(new Date).getTime()/1e3;ce.payMode.createOrderTime.push(l),s&&(ve.status=!0);const{data:r}=await a(e),{activeTypeInfo:d}=ae,{pid:p}=d,{status:v}=ce.enterpriseMode;if(p===t.ltd&&(v&&Number(e.pid)!==t.dev||!v&&Number(e.pid)!==t.ltd)||p!==t.ltd&&Number(e.pid)!==p||Number(ce.numsMode.activeNumsInfo.count)!==e.num||e.cycle!==Number(ce.cycleMode.activeCycleInfo.cycle))return;if("string"==typeof r.data&&"inherit_order"===r.data)return o.msg({message:r.msg,type:"warning"}),await st(),Le();if("string"==typeof r.msg&&-1!==r.msg.indexOf("接口请求失败"))return void o.msg({customClass:"panel-cloud-error",dangerouslyUseHTMLString:!0,message:r.msg,type:"error",duration:0,showClose:!0});if(!r.status&&1e3===(null==(u=r.data)?void 0:u.code))return ye.status=!0,ve.status=!1,void(ye.title=r.data.msg);const{ali_msg:y,msg:m,extra:f,data:M,is_coupon:h,status_code:g}=r,{cash_fee:I,uid:T}=M;if(ce.payMode.activeBuyInfo=Qe(I,r),120===g&&f){if(ce.payMode.payTips.name=f.name,"pro"===ae.activeTypeInfo.type&&"永久授权"===W.value)return ae.unbindAuthor.status=!0,ae.unbindAuthor.count=null==f?void 0:f.rest_unbind_count,ve.status=!1,lt.value={type:null==ae?void 0:ae.activeTypeInfo.type,typeName:F.value,extra:f},!1;ce.payMode.payTips.status=!0;const e=(new Date(1e3*f.end_time).getTime()-(new Date).getTime())/864e5;ce.payMode.payTips.day=Math.ceil(e)}else ce.payMode.payTips.status=!1;if(h&&h.length>0&&z.value<(new Date).getTime()/1e3&&100!==z.value)me.value=!0,Fe({isCoupon:h});else if(!fe.value&&ce.couponMode.list.length>0&&!te.value&&!me.value){fe.value=!0;const{val1:e,val2:t,id:o,pid:a}=ce.couponMode.list[0];return void Ce(o)}if(M.returnTime=l,ce.payMode.activeBalanceInfo=M,ce.payMode.lastPayTime<=0){if(!M.pid)return void o.error("请求失败");i({request:n({pid:M.pid}),data:{res:[Number,"buyVerify"]},success:e=>{e&&(ce.payMode.lastPayTime=e.buyVerify,De())}})}else De();const{credits:w}=await i({request:c({uid:T}),data:{res:[Number,"credits"]}});ce.payMode.balance=w/100;const{createOrderTime:b}=ce.payMode;if(b[b.length-1]!==M.returnTime)return!1;ve.status=!1,ce.payMode.balance>=ce.payMode.activeBuyInfo.price?ce.payMode.activePayType="balance":ce.payMode.activeBuyInfo.price>=6e3?(Pe.value=!0,ce.payMode.activePayType="wechat"===ce.payMode.activePayType?"alipay":ce.payMode.activePayType):ce.payMode.balance<ce.payMode.activeBuyInfo.price&&(ce.payMode.activeBuyInfo.price<6e3?ce.payMode.activePayType="wechat":ce.payMode.activePayType="alipay"),Pe.value&&ce.payMode.activeBuyInfo.price<6e3&&(ce.payMode.activePayType="wechat",Pe.value=!1),ce.payMode.activePayCode.apliy=y,ce.payMode.activePayCode.wechat=m,ce.payMode.qrcode.value="wechat"===ce.payMode.activePayType?m:y,"ltd"===(null==ae?void 0:ae.activeTypeInfo.type)&&Oe(ce.numsMode.activeNumsInfo.count),re&&clearTimeout(re),"coupon"!==(null==ae?void 0:ae.activeTypeInfo.type)&&setTimeout(()=>{ie.value=!0,We((new Date).getTime()/1e3)},5e3),(()=>{const e={cycleMode:ce.cycleMode,numsMode:ce.numsMode,payMode:ce.payMode,typeTab:null==ae?void 0:ae.activeTypeInfo.type,enterpriseMode:ce.enterpriseMode,couponMode:ce.couponMode};sessionStorage.setItem("PAY-VIEW-INFO",JSON.stringify(e))})()}catch(l){}},_e=E({}),Ee=E(),De=()=>{(new Date).getTime()/1e3-ce.payMode.lastPayTime<1800?ce.payMode.isLastBuyRepeat=!0:ce.payMode.isLastBuyRepeat=!1},Ae=E(0),Oe=async e=>{let t=[];if(ce.devCycleInfo.isGetOperated&&ce.devCycleInfo.data.nums.length)t=ce.devCycleInfo.data.nums;else{const{data:e}=await s({pid:100000068});t=e[12].nums,ce.devCycleInfo.isGetOperated=!0,ce.devCycleInfo.data=e[12]}const o=t.find(t=>t.count===e);o&&(Ae.value=o.price)},xe=E(""),Be=E(!1),Se=E(Math.floor(Date.now()/1e3)),Ve=E([]),Re=E(!1),qe=E(),Ue=E(),Fe=async e=>{G.value||(Ve.value=e.isCoupon,Re.value=e.isHome||!1,qe.value=v({area:40,component:()=>y(()=>import("./index338.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),customClass:"voucherFetchView",compData:e,onCancel:()=>{Be.value&&window.location.reload()}}))},je=async()=>{G.value||q.value.bindUser||(Ue.value=v({area:40,component:()=>y(()=>import("./index438.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),customClass:"voucherFetchView"}))},He=async(e,t)=>{await ke(),t!==(null==ae?void 0:ae.activeTypeInfo.type)&&await we(t),await Ce(e)},ke=async()=>{G.value||(ce.couponInfo[t.pro]=[],ce.couponInfo[t.ltd]=[],ce.couponInfo[t.dev]=[],Z.value&&await i({request:m(),data:{res:[Array,"data"]},success:e=>{const t=(new Date).getTime()/1e3;e.data.forEach(e=>{var o;const a=Math.floor((e.endtime-Math.floor(t))/3600);let i=0;a>24?i=Math.floor(a/24):a>0&&(i=1),e.newName="".concat(e.name,"( ").concat(i,"天后过期)"),null==(o=ce.couponInfo[e.product_id])||o.push(e)}),ot()}}))},We=async e=>{try{if(!R.value)return;e&&sessionStorage.setItem("PAY-VIEW-INFO-TIME","".concat(e));const t=sessionStorage.getItem("PAY-VIEW-INFO-TIME");if(t){if(parseInt("".concat((new Date).getTime()/1e3-Number(t)),10)>600&&R.value)return ie.value=!1,sessionStorage.removeItem("PAY-VIEW-INFO-TIME"),d({title:"支付超时",icon:"warning",content:"由于您长时间未操作，支付超时，请刷新网页重新购买！",onConfirm:()=>{at(),window.location.reload()},onCancel:()=>{at(),window.location.reload()}});R.value||sessionStorage.removeItem("PAY-VIEW-INFO-TIME")}if(re&&clearTimeout(re),"coupon"===(null==ae?void 0:ae.activeTypeInfo.type)||ae.unbindAuthor.status)return;if("balance"===ce.payMode.activePayType)return void(re=setTimeout(()=>{We()},4e3));const o=(new Date).getTime()/1e3,{status:a,data:n}=await i({request:f({wxoid:ce.payMode.activeBalanceInfo.wxoid,py_type:"alipay"===ce.payMode.activePayType?"ali":""}),data:{status:[Boolean,"status"],data:[Object,"data"]}});if(n&&["WAIT_BUYER_PAY","TRADE_CLOSED"].includes(n.status)&&(ne.value=!0),a)ze();else{const e=(new Date).getTime()/1e3;de=setTimeout(We,e-o<1?4e3:3e3)}}catch(t){r(t)}},Ye=()=>{(window.location.pathname.includes("/waf")||Y.value)&&window.location.reload()},Ge=async()=>{-1!==window.location.pathname.indexOf("/soft/plugin")&&(j.value=!0,H.value=!0)},Je=E({}),Ke=async()=>{const{data:e}=await b({force:1}),{ltd:t,pro:o}=new N(e,{ltd:Number,pro:Number}).exportData();return k([0,o,t]),{ltd:t,pro:o}},ze=async()=>{var e,t,o;try{await Ge(),at();const a=await Ke();if("plugin"===(null==(e=null==ae?void 0:ae.activeTypeInfo)?void 0:e.type))return M().success("".concat(ae.activeTypeInfo.title,"支付成功"));const i="dev"===(null==(t=null==ae?void 0:ae.activeTypeInfo)?void 0:t.type)?"ltd":(null==(o=null==ae?void 0:ae.activeTypeInfo)?void 0:o.type)||"";Object.assign(Je.value,{type:ae.activeTypeInfo.type,typeTipsList:ae.activeTypeInfo.tipsList,cycle:ce.payMode.activeBuyInfo.cycle,count:ce.payMode.activeBuyInfo.count,lastTime:h(a[i]),title:ae.activeTypeInfo.title}),v({area:68,component:()=>y(()=>import("./index439.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)}),Ye()}catch(a){r(a)}},Qe=(e,t)=>{const{cycleMode:o,numsMode:a,couponMode:i}=ce,{activeCycleInfo:n}=o,c=n.originalPrice,{activeNumsInfo:s}=a,{activeCouponInfo:u,status:l}=i;let r=e/100,d=n.title||"",p=s.count||0;const v=c*p;return l&&(u.name.includes("0.99")?(r=v-u.val1,d="".concat(u.experimental_interval,"天"),p=1):r=t.price),{price:r,count:p,cycle:d,originalPrice:v,discount:u}},Ze=E(!1),$e=async e=>{try{Ze.value=!0;const{data:o}=await s({pid:e});Number(o.pid)===t.dev&&(delete o[1],delete o[6],delete o[36],ce.devCycleInfo.isGetOperated=!0,ce.devCycleInfo.data=o[12]);const a=[];for(const e in o)if(Object.prototype.hasOwnProperty.call(o,e)){const{price:t,tip:i,sprice:n,nums:c,sort:s}=o[e];if(!isNaN(Number(e))){const o=Number(e)%12==0?"".concat(Number(e)/12,"年"):"".concat(Number(e),"个月");a.push({cycle:Number(e),price:t,recommend:i,originalPrice:n,nums:c,sort:s,title:o,everyDay:(t/Number(e)/30).toFixed(2)})}}a.sort((e,t)=>e.sort-t.sort),ce.cycleMode.list=a}catch(o){r(o)}finally{Ze.value=!1}},Xe=e=>{const{list:t,pid:a}=e;return ce.voucherMode.list=t,ce.voucherMode.typeActive=a,t.length?et(t[0]):o.warn("暂无可用优惠券")},et=e=>{const{id:t,product_id:o,code:a}=e;ce.voucherMode.active=t,ce.voucherMode.activeInfo={pid:o,code:a}},tt=async e=>{try{ce.voucherMode.loading=!0,ce.voucherMode.list=[],ce.voucherMode.typeList={},ce.voucherMode.proTypeList={};const{data:t}=await g(e);ce.voucherMode.isExist=!(0===t.length),t.forEach(e=>{const{product_id:t,name:o}=e;ce.voucherMode.typeList.hasOwnProperty(t)?ce.voucherMode.typeList[t].list.push(e):ce.voucherMode.typeList[t]={name:o,pid:t,list:[e]}});["100000011","100000032"].reverse().forEach(e=>{if(ce.voucherMode.typeList[e]){const t=ce.voucherMode.typeList[e];ce.voucherMode.proTypeList[e]=t,delete ce.voucherMode.typeList[e]}})}catch(t){r(t)}finally{ce.voucherMode.loading=!1}},ot=()=>{var e;const{type:o,pid:a}=ae.activeTypeInfo;if(["plugin","coupon"].includes(o))ce.couponMode.count=0,ce.couponMode.list=[];else{let i=a;ce.enterpriseMode.status&&"ltd"===o&&(i=t.dev),ce.couponMode.count=(null==(e=ce.couponInfo[i])?void 0:e.length)||0,ce.couponMode.list=ce.couponInfo[i]}ce.couponMode={status:!1,activeCouponId:"",activeCouponInfo:{},discountsTitle:"",count:ce.couponMode.count,list:ce.couponMode.list,disabled:!ce.couponMode.count,endTimeNum:0},ce.couponMode.count<=0&&(ce.couponMode.disabled=!0,ce.couponMode.status=!1)},at=async()=>{window.onbeforeunload=()=>{},Mt(),V.value("close")},it=E(),nt=E(!1),ct=E([{type:"wechat",title:"微信扫码支付"},{type:"alipay",title:"支付宝扫码支付"},{type:"balance",title:"余额支付"},{type:"accounts",title:"对公转账"}]),st=async()=>{var e;try{await Ke()&&(o.request({msg:"刷新成功",status:!0}),(null==(e=null==ae?void 0:ae.activeTypeInfo)?void 0:e.type)&&we(ae.activeTypeInfo.type))}catch(t){r(t)}},ut=E(!1),lt=E({}),rt=E(!1),dt=E(),pt=e=>{lt.value=e,dt.value=v({area:[32,29],component:()=>y(()=>import("./index441.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)})},vt=e=>{ce.cycleMode.list="dev"===e?[{cycle:12,price:5999,recommend:!1,originalPrice:12e3,nums:[{count:1,price:-1,discount:0},{count:3,price:-1,discount:0},{count:5,price:-1,discount:0},{count:10,price:-1,discount:0},{count:20,price:-1,discount:0},{count:50,price:-1,discount:0},{count:100,price:-1,discount:0}],sort:1,title:"1年",everyDay:"16.66"}]:[{cycle:12,price:1399,recommend:!1,originalPrice:3588,nums:[{count:1,price:-1,discount:0},{count:3,price:-1,discount:0},{count:5,price:-1,discount:0},{count:10,price:-1,discount:0},{count:20,price:-1,discount:0},{count:50,price:-1,discount:0},{count:100,price:-1,discount:0}],sort:1,title:"1年",everyDay:"3.89"},{cycle:36,price:2999,recommend:!1,originalPrice:10764,nums:[{count:1,price:-1,discount:0},{count:3,price:-1,discount:0},{count:5,price:-1,discount:0},{count:10,price:-1,discount:0},{count:20,price:-1,discount:0},{count:50,price:-1,discount:0},{count:100,price:-1,discount:0}],sort:2,title:"3年",everyDay:"2.78"},{cycle:6,price:999,recommend:!1,originalPrice:1794,nums:[{count:1,price:-1,discount:0},{count:3,price:-1,discount:0},{count:5,price:-1,discount:0},{count:10,price:-1,discount:0},{count:20,price:-1,discount:0},{count:50,price:-1,discount:0},{count:100,price:-1,discount:0}],sort:3,title:"6个月",everyDay:"5.55"},{cycle:1,price:599,recommend:!1,originalPrice:599,nums:[{count:1,price:-1,discount:0},{count:3,price:-1,discount:0},{count:5,price:-1,discount:0},{count:10,price:-1,discount:0},{count:20,price:-1,discount:0},{count:50,price:-1,discount:0},{count:100,price:-1,discount:0}],sort:4,title:"1个月",everyDay:"19.97"}]},yt=(e,t)=>!(!Z.value&&("nums"===e&&1!==t.count||"cycle"===e&&12!==t.cycle))||(S(),!1),mt=()=>{let e=Number(sessionStorage.getItem("PAYMENT-NEW-COUPON-TIME"));(!e||e<(new Date).getTime())&&(e=(new Date).getTime()+6e5,sessionStorage.setItem("PAYMENT-NEW-COUPON-TIME",e.toString())),he.value=e},ft=E(0),Mt=()=>{Pe.value=!1,R.value=!1,ne.value=!1,fe.value=!1,de&&clearTimeout(de),re&&clearTimeout(re),Me.value&&clearInterval(Me.value)};return{voucherFetchInstance:qe,openNewUserVoucherFetchViewDialog:je,compData:_,isRemarksLoading:nt,productPriceLoading:Ze,isPlugin:X,productInfo:ae,product:ce,enterprise:Ae,tabLoading:pe,iSwitch:se,countDown:le,switchLeft:Te,switchRight:()=>{const e=document.getElementById("list-box"),t=172*ce.cycleMode.list.length,o=e.clientWidth;if(t<o)return;const a=document.getElementById("list"),i=Math.abs(parseInt(window.getComputedStyle(a,null).left,10));i+o+360>t?(a.style.left="-".concat(t-o,"px"),se.right=!1,se.left=!0):a.style.left="-".concat(i+360,"px")},changeTypeTabEvent:we,changeCycleTabEvent:be,changeNumsTabEvent:Ne,enterpriseEvent:e=>{ce.enterpriseMode.status=Boolean(e),e?be({cycle:12,price:ce.devCycleInfo.data.price,recommend:!1,originalPrice:ce.devCycleInfo.data.sprice,nums:ce.devCycleInfo.data.nums,sort:0,title:"1年",everyDay:(ce.devCycleInfo.data.price/12/30).toFixed(2)},"dev"):be(ce.cycleMode.list[0])},changeCouponBoxEvent:e=>{const{status:t,count:a,activeCouponId:i}=ce.couponMode;if(0===a)return ce.couponMode.status=!1,o.warn("暂无可用优惠券");if(ce.couponMode.status=void 0!==e?Boolean(e):!t,""!==i&&ce.couponMode.status)Ce(i);else if(""===i&&ce.couponMode.status)return o.request({msg:"请选择优惠券",status:!1}),ce.couponMode.status=!1,!1;Le()},changeCouponEvent:Ce,openPrivilegeContrast:()=>{it.value=v({area:[97,76],component:()=>y(()=>import("./index440.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)})},newUserVoucherFetchInstance:Ue,newUserVoucherEndTime:he,scanned:ne,errorMask:ye,bindUser:Z,paymentLoading:ve,payList:ct,changePayTypeEvent:async e=>{switch(ne.value=!1,e.type){case"wechat":if(ce&&(null==ce?void 0:ce.payMode.activeBuyInfo.price)>=6e3)return o.warn("刷新支付金额已超过微信单笔支付额度，请选择其他支付方式"),!1;ce.payMode.qrcode.value=ce.payMode.activePayCode.wechat;break;case"alipay":""===ce.payMode.activePayCode.apliy||e.isRegain?(await Le({pid:Number(ce.numsMode.activeNumsInfo.pid),cycle:Number(ce.cycleMode.activeCycleInfo.cycle),source:Number(ee.value),num:Number(ce.numsMode.activeNumsInfo.count),coupon:ce.couponMode.status&&ce.couponMode.activeCouponId||"",get_ali_msg:1,regain:e.isRegain?1:0},!0),ce.payMode.qrcode.value=ce.payMode.activePayCode.apliy,ne.value=!1):ce.payMode.qrcode.value=ce.payMode.activePayCode.apliy}ce.payMode.activePayType=e.type},paySuccessData:Je,openBuySuccessView:ze,changeBalanceBuyEvent:async()=>{var e,t,a,n,c,s,u,l;await i({loading:"正在支付中...",request:I({num:Number(null==(t=null==(e=null==ce?void 0:ce.numsMode)?void 0:e.activeNumsInfo)?void 0:t.count),cycle:Number(null==(n=null==(a=null==ce?void 0:ce.cycleMode)?void 0:a.activeCycleInfo)?void 0:n.cycle),uid:Number(null==(s=null==(c=null==ce?void 0:ce.payMode)?void 0:c.activeBalanceInfo)?void 0:s.uid),pid:Number(null==(l=null==(u=null==ce?void 0:ce.payMode)?void 0:u.activeBalanceInfo)?void 0:l.pid),coupon:ce.couponMode.status&&ce.couponMode.activeCouponId||""}),data:{res:String,success:Boolean},success:e=>{o.request({msg:e.res,status:e.success}),e.success&&ze()}})},changeRefreshAuthor:st,couponItem:Ve,closeAfterReload:Be,timeClose:xe,siteList:[{label:"今日内不再提醒",value:"today"},{label:"近7天内不再提醒",value:"week"},{label:"永久不再提醒",value:"forver"}],timeNow:Se,addZero:e=>e<10?"0".concat(e):"".concat(e),claimCouponEvent:async(e,t)=>{try{const{data:a}=await u({type:U.value});if($.value=!0,l(null==a?void 0:a.status)&&0===(null==a?void 0:a.status))return o.request({msg:a.msg,status:!1}),void(Be.value=!0);const i={100000011:"pro",100000032:"ltd",100000068:"dev"}[a.data[0].pid],{id:n}=a.data[0];o.request({msg:a.msg,status:!0});const c=await qe.value;if(null==c||c.unmount(),e&&"function"==typeof e&&e(),Re.value||t)return await B({disablePro:"pro"!==i,sourceId:Re.value?176:0,isHomeBubble:{id:n,pro:i}}),!1;await He(n,i)}catch(a){r(a)}},changeCloseTimeEvent:async(e,t=!0)=>{let a=0,i="";switch(xe.value=e,xe.value){case"today":a=new Date((new Date).toLocaleDateString()).getTime()+864e5-1,i="今日内不再通知";break;case"week":a=new Date((new Date).toLocaleDateString()).getTime()+6048e5-1,i="近7天内不再通知";break;case"forver":a=-100,i="永久不再通知"}if(a=Math.floor(a>0?a/1e3:a),t&&await d({title:"提示",content:"".concat(i,",是否确认?")}),Re.value)z.value=a,sessionStorage.setItem("voucherOpenTime",z.value.toString());else try{const e=await p({limit_time:a});t&&o.request(e)}catch(c){r(c)}const n=await qe.value;null==n||n.unmount(),$.value=!0},couponCompData:_e,changeVoucher:async()=>{Ce(_e.value.id);const e=await Ee.value;null==e||e.unmount()},activePayIcon:Ie,voucherLoading:ut,getVoucherCycleDescribe:(e,t)=>"month"===t?e%12?"".concat(e,"个月"):"".concat(e/12,"年"):"".concat(e+("year"===t?"年":"天")),useChangeVoucher:async()=>{if(ut.value=!0,""===(null==ce?void 0:ce.voucherMode.activeInfo.code))return o.warn("请选择抵扣券");const{status:e,extra:t,statusCode:a,msg:n}=await i({loading:"正在使用抵扣券，请稍侯...",request:T({pid:Number(null==ce?void 0:ce.voucherMode.activeInfo.pid),code:(null==ce?void 0:ce.voucherMode.activeInfo.code)||""}),data:{extra:[Object,"extra"],status:Boolean,status_code:[Number,"statusCode"],msg:String}});ut.value=!1,e?(await Ke(),o.request({msg:n,status:e}),Ge(),at(),Ye()):120!==a||e?o.request({msg:n,status:e}):(ut.value=!1,pt({type:null==ae?void 0:ae.activeTypeInfo.type,typeName:F.value,extra:t}))},changeVoucherEvent:et,changeVoucherTypeEvent:Xe,refreshSoftEvent:Ge,unbindBuyAuthorDialog:pt,authTypeTitle:F,authExpirationTime:W,getUnbindCount:async()=>{const e=await J();ft.value=e},unBindAuthor:()=>{pt({type:null==ae?void 0:ae.activeTypeInfo.type,typeName:F.value,extra:{rest_unbind_count:ft.value}})},isDisabledAuth:rt,authType:K,bindAuthData:lt,changeUnbindAuthor:async(e=!1)=>{if(lt.value.extra.rest_unbind_count>0)try{await d({title:"提示",content:"解绑当前【".concat(F.value,"授权】，继续操作！")}),rt.value=!0;const{data:a}=await w();if(o.request({msg:a.res,status:a.success}),a.success){await Ke(),e?setTimeout(()=>{we(ae.activeTypeInfo.type)},500):await tt({pid:t.coupon}),Ge();const o=await dt.value;null==o||o.unmount()}}catch(a){}finally{rt.value=!1}else window.open("https://www.bt.cn/admin/profe_ee","_blank","noopener,noreferrer")},privilegeList:["多对一技术支持","全年5次安全排查","5分钟极速响应","30+款付费插件","20+企业版专享功能","1000条免费短信（年付）","2张SSL商用证书（年付）","一对一服务（年付）","WAF防火墙","更换授权IP","客服优先响应","15+款付费插件","15天无理由退款"],proPrivilegeList:[0,0,0,0,0,0,0,0,1,1,1,1,1],ltdPrivilegeList:[0,0,1,1,1,1,1,1,1,1,1,1,1],plusPrivilegeList:[1,1,1,1,1,1,1,1,1,1,1,1,1],go2tab:async e=>{we(e);const t=await it.value;null==t||t.unmount()},emits:V,onCancel:async()=>{if(G.value)return Ke(),at(),!1;if(!Z.value)return at(),!1;if(ge.value++,ge.value>=3){ge.value=0,U.value=5;const e=await(async(e={})=>(await i({request:C(e)})).data)({type:U.value});if(e.length>0)return Fe({isCoupon:e,close:at,isLimited:!0}),!1}try{await d({title:"温馨提示",content:'支付过程中，请勿关闭该页面，以免出现支付异常！<br><a\n\t\t\t\tclass="bt-link text-small"\n\t\t\t\thref="https://www.bt.cn/new/wechat_customer"\n\t\t\t\ttarget="_blank"\n\t\t\t\trel="noreferrer noopener"\n\t\t\t\t>支付遇到问题？联系客服</a\n\t\t\t>',isHtml:!0,width:"40rem"}),U.value=0,at()}catch(e){r(e)}return!1},init:async e=>{e&&(_.value=e),R.value=!0,(()=>{const{pluginInfo:e,disablePro:o}=_.value;X.value=!!e,ee.value=_.value.sourceId,oe.value=o,te.value=_.value.isHomeBubble,Object.assign(ae,{typeList:[{type:"plugin",title:X.value?e.title:"插件",describe:X.value?8===e.type?"【专业版】已包含此插件":"【企业版】已包含此插件":"",pid:X.value?e.pid:0,isHidden:!X.value,tipsTitle:"插件说明",tipsList:[]},{type:"pro",title:"".concat(L,"专业版"),describe:"适用于个人用户、个人项目",pid:t.pro,isHidden:o,tipsTitle:"专业版特权",tipsList:[]},{type:"ltd",title:"".concat(L,"企业版"),describe:"适用于官网，电商、教育、医疗等用户",pid:t.ltd,recommend:!0,tipsTitle:"企业版特权",tipsList:[]},{type:"dev",title:"企业运维托管",describe:"适用于无专业技术、需技术服务的企业",pid:t.dev,tipsTitle:"企业运维托管特权",isHidden:X.value,tipsList:["网站性能优化","网站安全扫描","网站攻击防护","服务器运维托管","企业版所有特权","文件防篡改配置","文件代码同步部署","系统文件垃圾清理","数据库数据同步部署","50x/40x网站报错处理","CPU内存占用过高处理"]},{type:"coupon",title:"抵扣券",describe:"抵扣券授权",pid:t.coupon,tipsTitle:"抵扣券来源",tipsList:["官网后台购买","活动页购买","推广赠送","更换绑定IP"]}],activityList:"",activeTypeInfo:{type:"pro",describe:"",title:"",pid:0,recommend:!1,tipsTitle:"",tipsList:[]},unbindAuthor:{status:!1,count:0}})})(),(async()=>{let e=sessionStorage.getItem("PAY-VIEW-INFO-REMARKS");e||await i({loading:nt,request:P(),data:{pro_list:[Array,"pro"],list:[Array,"ltd"],vip_pro_list:[Array,"vip_pro_list"],activity_list:[Array,"activityList"]},success:t=>{e=JSON.stringify(t),sessionStorage.setItem("PAY-VIEW-INFO-REMARKS",e)}});const t=JSON.parse(e);nt.value=!1;const{pro:o,ltd:a,vip_pro_list:n,activityList:c}=t;ae.typeList[1].tipsList=o,ae.typeList[2].tipsList=a,ae.typeList[3].tipsList=n,(new DOMParser).parseFromString(c,"text/xml"),ae.activityList=c||"",ae.activeTypeInfo=ae.typeList.find(e=>e.type===ae.activeTypeInfo.type),ke()})(),nt.value=!0;let o=(()=>{if(G.value)return"dev";let e="free"===K.value?"ltd":K.value;return oe.value||"ltd"===e||(e="pro"),e})();var a;const n=((e,t)=>null==t?void 0:t.some(t=>t.type===e))(o,null==(a=null==ae?void 0:ae.typeList)?void 0:a.filter(e=>!0!==(null==e?void 0:e.isHidden)));n||(o="ltd"),await we(o),(async()=>{if(te.value&&Object.keys(te.value).length>0&&"object"==typeof te.value){const{id:e,pro:t}=te.value;await He(e,t)}})(),q.value.bindUser&&(window.onbeforeunload=()=>"是否要离开")},$reset:Mt}});export{V as P};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
