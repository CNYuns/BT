var e=Object.defineProperty,t=(t,a,l)=>(((t,a,l)=>{a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l})(t,"symbol"!=typeof a?a+"":a,l),l);import{o as a,u as l,f as s,b4 as i,V as n,p as o,M as r,b5 as c,W as u,aK as p,b as d,Q as m,k as h,H as f,n as v,b6 as g,b7 as y,b8 as b,x as _,R as w,b9 as S,ba as k,bb as T,B as L,bc as E,y as x,$ as C,j as D,_ as I,aH as P,q as F,bd as R,N,be as O,am as j,az as A,m as V,a as z,bf as M,bg as q,t as H,aS as B,aA as U,bh as G,O as J,l as W,bi as $,al as Y,bj as K,bk as Q,bl as X,r as Z,bm as ee,bn as te,bo as ae,bp as le,bq as se,S as ie,br as ne,bs as oe,E as re,bt as ce,bu as ue,bv as pe,bw as de,bx as me,by as he,af as fe,G as ve,bz as ge,bA as ye,bB as be,bC as _e,ax as we,bD as Se,bE as ke,ak as Te,bF as Le,bG as Ee,bH as xe,bI as Ce}from"./utils-lib.js?v=1764728423";import{e as De,D as Ie,aA as Pe,ap as Fe,aH as Re,r as Ne,n as Oe,c as je,w as Ae,aJ as Ve,I as ze,J as Me,K as qe,x as He,y as Be,Q as Ue,S as Ge,A as Je,j as We,d as $e,t as Ye,o as Ke,W as Qe,b8 as Xe,aC as Ze,s as et,aE as tt,an as at,am as lt,i as st,C as it,z as nt,O as ot,G as rt,ad as ct,ab as ut,B as pt,R as dt,bd as mt,bc as ht,V as ft,H as vt,aB as gt,g as yt,a0 as bt,av as _t,v as wt,L as St,M as kt,P as Tt,aQ as Lt,a3 as Et,a6 as xt,E as Ct,q as Dt,p as It,F as Pt,b as Ft,bf as Rt,Y as Nt,Z as Ot,m as jt}from"./base-lib.js?v=1764728423";import{_ as At}from"./index110.js?v=1764728423";import{o as Vt,a as zt,u as Mt,c as qt}from"./column.js?v=1764728423";import{g as Ht}from"./__commonjsHelpers__.js?v=1764728423";import{_ as Bt}from"./index107.js?v=1764728423";const Ut=e=>a.post("plugin/get_soft_list",{data:e,customType:"default"}),Gt=e=>a.post("deployment/DelPackage",{data:e,customType:"default",check:"msg"}),Jt=()=>a.post("site/GetPHPVersion",{customType:"default",check:"array"}),Wt=e=>a.post("site/AddSite",{data:e,customType:"default",check:"object"}),$t=e=>a.post("deployment/SetupPackage",{data:e,customType:"default",check:"msg"}),Yt=e=>a.post("auth/create_plugin_other_order",{data:e,loading:"正在获取支付信息，请稍候...",customType:"default",check:"object"}),Kt=e=>a.post("files/GetFileBody",{data:e}),Qt=e=>a.post("plugin/install_plugin",{data:e,check:"object"}),Xt=e=>a.post("ajax/GetOpeLogs",{data:e,check:"msg"}),Zt=e=>a.post("ftp/set_ftp_logs",{data:e,check:"msg"}),ea=()=>a.post("ajax/GetMemcachedStatus",{}),ta=e=>a.post("ajax/SetMemcachedCache",{data:e,check:"msg"}),aa=()=>a.post("ajax/GetNginxStatus",{check:"object"}),la=()=>a.post("config/GetNginxValue",{check:"array"}),sa=e=>a.post("config/SetNginxValue",{data:e,check:"msg"}),ia=()=>a.post("config/get_ols_value",{}),na=e=>a.post("config/set_ols_value",{data:e,check:"msg"}),oa=()=>a.post("database/GetRunStatus",{check:"object"}),ra=e=>a.post("database/GetErrorLog",{data:e,check:"string"}),ca=e=>a.post("database/GetErrorLog",{data:e,check:"msg"}),ua=e=>a.post("database/GetSlowLogs",{data:e,check:"msg"}),pa=()=>a.post("database/GetMySQLBinlogs",{check:"msg"}),da=e=>a.post("database/BinLog",{data:e,check:"msg"}),ma=e=>a.post("database/ClearMysqlBinLog",{data:e,check:"msg"}),ha=()=>a.post("database/GetMySQLInfo",{check:"object"}),fa=e=>a.post("database/SetDataDir",{data:e,check:"msg"}),va=e=>a.post("database/SetMySQLPort",{data:e,check:"msg"}),ga=e=>a.post("database/mysql_oom_adj",{data:e,check:"msg"}),ya=()=>a.post("database/GetDbStatus",{check:"object"}),ba=e=>a.post("database/SetDbConf",{data:e,check:"msg"}),_a=e=>a.post("ajax/GetPHPConfig",{data:e,check:"object"}),wa=e=>a.post("files/UninstallSoft",{data:e,check:"msg"}),Sa=e=>a.post("files/InstallSoft",{data:e,check:"msg"}),ka=e=>a.post("config/GetPHPConf",{data:e}),Ta=e=>a.post("config/SetPHPConf",{data:e,check:"msg"}),La=e=>a.post("config/setPHPDisable",{data:e,check:"msg"}),Ea=e=>a.post("config/getFpmConfig",{data:e,check:"object"}),xa=e=>a.post("config/setFpmConfig",{data:e,check:"msg"}),Ca=e=>a.post("ajax/GetPHPStatus",{data:e,check:"object"}),Da=e=>a.post("ajax/GetFpmSlowLogs",{data:e,check:"object"}),Ia=e=>a.post("ajax/GetFpmLogs",{data:e,check:"msg"}),Pa=e=>a.post("config/GetSessionConf",{data:e,check:"object"}),Fa=e=>a.post("config/GetSessionCount",{data:e,check:"object"}),Ra=e=>a.post("config/SetSessionConf",{data:e,check:"msg"}),Na=()=>a.post("config/DelOldSession",{check:"msg"}),Oa=e=>a.post("ajax/GetPHPInfo",{data:e,check:"string"}),ja=e=>a.post("ajax/php_info",{data:e,check:"object"}),Aa=e=>a.post("config/get_php_config",{data:e,check:"object"}),Va=e=>a.post("config/setPHPMaxSize",{data:e,check:"msg"}),za=e=>a.post("config/setPHPMaxTime",{data:e,check:"msg"}),Ma=()=>a.post("ajax/GetApacheStatus",{check:"object"}),qa=e=>a.post("site/set_restart_task",{data:e,check:"msg"}),Ha=()=>a.post("site/get_restart_task",{check:"msg"}),Ba=()=>a.post("config/GetApacheValue",{check:"array"}),Ua=e=>a.post("config/SetApacheValue",{data:e,check:"msg"}),Ga=e=>a.post("files/DeleteFile",{data:e,check:"msg"}),Ja=()=>a.post("deployment/check_project_env",{check:"object"}),Wa=e=>a.post("deployment/GetJarPath",{data:e,check:"object"}),$a=e=>a.post("/mod/java/project/create_project",{data:e,check:"object",customType:"model"}),Ya=e=>a.post("/mod/php/php_async/create_project",{data:e,customType:"model",check:"object"}),Ka=()=>a.post("/mod/java/project/get_system_info",{check:"msg",customType:"model"}),Qa=()=>a.post("deployment/GetInLog",{check:"msg"}),Xa=()=>a.post("database/GetmvDataDirSpeed",{check:"object"}),Za=()=>a.post("plugin/RegetCloudPHPExt",{check:"object"}),el=e=>a.post("config/phpPeclUninstall",{data:e,check:"msg"}),tl=e=>a.post("config/phpPeclInstall",{data:e,check:"msg"}),al=e=>a.post("config/GetPeclInstallList",{data:e,check:"array"}),ll=e=>a.post("config/GetPhpPeclLog",{data:e,check:"msg"}),{setAuthState:sl,enterpriseRec:il,payment:nl}=l(),ol=e=>{const{type:t}=e;return{label:"app"===t?"软件名称":"名称",prop:"title",width:250,sortable:e.sortable,showOverflowTooltip:!1,render:a=>{var l;const i="soft_ico/ico-"+((null==(l=a.name)?void 0:l.indexOf("php-"))>-1?"php":a.name)+".png",n="/dep_ico/".concat(a.name,".png"),o=a.title.indexOf("PHP-")>-1?"PHP":a.title;return De("div",{class:"whitespace-normal inline-flex items-center p-[2px] ".concat(a.setup?"cursor-pointer":""),title:a.setup?"打开插件":"".concat(o," ").concat(a.version),onClick:()=>e.onClick(a)},[De(s,{src:"app"===t?i:n,class:"".concat(10===a.type?"!h-[20px] !w-[22px]":""," soft-ico-img"),type:"img"},{error:()=>De("img",{src:"/static/images/soft_ico/icon_plug.svg",alt:""},null)}),De("span",null,["".concat(a.setup?o:a.title," ").concat(a.version||"")]),De("span",{class:"text-warning ".concat(a.is_beta?"":"hidden")},[Ie("[测试版]")])])}}},rl=()=>({label:"开发商",width:80,render:e=>De("span",{class:"truncate inline-block w-[8rem]"},[Ie(" "),e.author||"官方"])}),cl=e=>({label:"app"===e?"说明":"介绍",showOverflowTooltip:!1,render:e=>De("div",{class:"leading-[16px]",innerHTML:e.ps},null)}),ul=e=>{const{onClick:t,sortable:a}=e;return{label:"评分",prop:"score",width:80,sortable:a,render:e=>e.hasOwnProperty("score")?De("span",{class:"bt-link inline-block w-[4rem]",onClick:()=>t(e)},[e.score?e.score:"无评分"]):De("span",null,[Ie("--")])}},pl=()=>({label:"价格/天",width:70,render:e=>e.price>0?De("span",{class:"text-warning"},["≈".concat((e.price/("btiplibrary"===e.name?365:30)).toFixed(2),"元"),Ie(" ")]):De("span",{class:"text-secondary"},[Ie("免费")])}),dl=e=>({label:"到期时间",width:130,showOverflowTooltip:!1,render:t=>{let a=t.endtime?n(t.endtime,"yyyy-MM-dd"):"--",l=De("span",{class:"bt-link",onClick:()=>e.onClick(t)},[Ie("(续费)")]);return t.price>0&&0===t.endtime&&!nl.value.bindUser?De("span",null,[Ie("--")]):(t.price>0?[0,-1].includes(t.endtime)?(l=De("i",null,null),a=0===t.endtime?"永久":"未开通"):[1,-2].includes(t.endtime)&&(a=t.endtime>1?a:"已到期"):(a="--",l=De("i",null,null)),De("span",null,[a,l]))}}),ml=()=>({label:"位置",width:50,render:e=>e.setup?De("span",{class:"flex"},[De("i",{title:"打开插件文件目录",class:"text-[var(--el-color-warning-light-3)] cursor-pointer svgtofont-folder-open !text-large",onClick:()=>Vt({path:e.install_checks})},null)]):De("span",null,[Ie("--")])}),hl=e=>({label:"首页显示",prop:"labels",width:80,render:t=>t.setup?De(Fe,{size:"small",modelValue:t.index_display,"onUpdate:modelValue":e=>t.index_display=e,onChange:a=>e.onChange(t,Boolean(a))},null):De("span",null,[Ie("--")])}),fl=e=>({label:"操作",align:"right",width:175,showOverflowTooltip:!1,render:(t,a)=>{var l;const n="soft_ico/ico-".concat((null==(l=null==t?void 0:t.name)?void 0:l.includes("php-"))?"php":t.name,".png");let o=e;const r="/dep_ico/".concat(t.name,".png");i(e)&&(o=e(t));const c=![5,6,13,7,8,12,10,11].includes(t.type);return De(Pe,{popperClass:"el-popover-shadow el-light-popover !py-[6px]",trigger:"hover",placement:"top-start",enterable:!1,"show-after":200,"hide-after":0,width:"auto"},{default:()=>[De("div",{class:"flex items-center p-[2px] whitespace-nowrap"},[De(s,{src:c?r:n,class:"".concat(c?"":"!h-[20px] !w-[22px]"," soft-ico-img"),type:"img"},{error:()=>De("img",{src:"/static/images/soft_ico/icon_plug.svg",alt:""},null)}),De("span",null,["".concat(t.title," ").concat(t.version)]),De("span",{class:"text-warning ".concat(t.is_beta?"":"hidden")},[Ie("[测试版]")])])],reference:()=>De("div",{class:"text-right w-full"},[o.map((e,a)=>{if(!(e.isHide&&e.isHide(t)||"更新"===e.title&&"tomcat"===t.name))return De("span",{class:"soft-link"},[De("span",{class:"bt-link",title:e.title,onClick:a=>{if("pay"==e.type&&10===t.type){const{buyThirdPluginView:e}=xc();return e(t)}return e.onClick(t,e.type,e.sourceId),!1}},[e.title]),a!==o.length-1?De(At,null,null):""])})])})}}),vl=async(e,t)=>{try{if(await rp())return;let a="i";switch(t){case"install":a="i";break;case"update":a="u";break;case"repair":a="r"}if(10!==e.type){const t={...e,callback:()=>{const{refreshRouteData:e}=Ic();e("1")}};await Ju({name:e.name,type:a,pluginInfo:t})}else{await o({title:"安装第三方插件",content:"您真的要安装[".concat(e.title,"]插件吗？"),icon:"question-filled"});let t=r.load("正在获取插件信息，请稍后...");const a=await Sl(e);if(!a.status)return r.error(a.msg);const{data:l}=await Qt({sName:e.name,version:e.versions[0].m_version,min_version:e.versions[0].version});if(t.close(),l.hasOwnProperty("status")&&!l.status)return r.error(l.msg);const{installOtherEvent:s}=xc();s(l)}}catch(a){}},gl=async(e,t)=>{const l=t?await(s={sName:e.name},a.post("plugin/add_index",{data:s,customType:"default",check:"msg"})):await(e=>a.post("plugin/remove_index",{data:e,customType:"default",check:"msg"}))({sName:e.name});var s;return r.request(l),l},yl=e=>{window.open(e,"_blank","noopener,noreferrer")},bl=async e=>{const{softList:t,total:a,historyList:l,ltd:s,pro:i,m_list:n,typeList:o,isForce:r}=new c(e,{"list.data":[Array,"softList"],"list.page":u(),ltd:Number,pro:Number,search_history:[Array,"historyList"],m_list:Array,type:[Array,"typeList"],is_force:[Number,e=>({isForce:Boolean(e)})]}).exportData();sl([0,i,s]);return{softList:[...t,...[...n].map(e=>({...e,is_docker:1}))],total:a,historyList:l,typeList:o,isForce:r}},_l=e=>{let t="";t=e?"软件列表更新成功":e||il.value?"云端连接失败，无法获取最新软件列表，请检查网络或稍后重试":"未绑定宝塔官网账号，无法获取最新软件列表",r.msg({dangerouslyUseHTMLString:!e,message:t,type:e?"success":"warning",duration:2e3})},wl=e=>{window.open(e.preview_url,"_blank","noopener,noreferrer")},Sl=async e=>{try{const{data:t,msg:a,status:l}=await Yt({pid:e.pid,cycle:"1",type:0});return t}catch(t){}},kl=async(e,t,a)=>{const{authExpirationTime:s,forceLtd:i,aliyunEcsLtd:n}=l();let o={disablePro:8!==e.type,compulsionLtd:8!==e.type,sourceId:a,plugin:!0,pluginInfo:e};-2===Number(s.value)&&(a=32),n.value&&(o={disablePro:!0,compulsionLtd:!0,sourceId:a,plugin:!0,pluginInfo:e}),await Gu(o)},Tl=e=>{Re().push({path:e.route})},Ll=async e=>{const t=await rp();if(!e.setup||t)return;if([8,12].includes(e.type)&&e.endtime<0)return r.error("加载失败：该插件未购买或已到期");const a=["mysql","pureftpd","nginx","apache","tomcat","memcached","openlitespeed","phpmyadmin"].includes(e.name),s=-1!==e.name.indexOf("php-");if(a||s)return Yu({pluginInfo:e});if(!(await kp(e.name)))return!1;sessionStorage.setItem("pluginViewInfo",JSON.stringify({...e,built:e.built?"1":"0"}));const{pluginInfo:i}=l();i.value.visible=!0,i.value.id=e.name,i.value.name=e.title,i.value.callback=(null==e?void 0:e.callback)||null},El=e=>a.post("files/GetFileBody",{data:e,check:"object"}),xl=e=>a.post("files/GetDirNew",{data:e,check:"ignore"}),Cl=e=>a.post("/files?action=GetDirNew&tojs=GetFiles",{customType:"model",data:e}),Dl=e=>a.post("files/MvFile",{data:e,check:"msg"}),Il=e=>a.post("files/".concat("dir"===e.type?"CreateDir":"CreateFile"),{data:{path:e.path},check:"msg"}),Pl=e=>a.post("files/".concat("dir"===e.type?"DeleteDir":"DeleteFile"),{data:{path:e.path},check:"msg"}),Fl=e=>a.post("files/del_files_store",{data:{path:e.path},check:"msg"}),Rl=e=>{const t=e.name?{dfile:e.path,filename:e.name}:{dfile:e.path};return a.post("files/CheckExistsFiles",{loading:"正在粘贴文件，请稍候...",data:t,check:"array"})},Nl=e=>a.post("files/CopyFile",{data:{sfile:e.sfile,dfile:e.dfile},check:"msg"}),Ol=e=>a.post("files/MvFile",{data:e,check:"msg"}),jl=e=>a.post("files/Get_Recycle_bin",{data:e,check:"object"}),Al=e=>a.post("files/Close_Recycle_bin_new",{data:e,check:"msg"}),Vl=e=>a.post("files/Re_Recycle_bin",{data:e,check:"msg"}),zl=e=>a.post("files/Del_Recycle_bin_new",{data:e,check:"msg"}),Ml=e=>a.post("files/download_file",{data:e,check:"object"}),ql=e=>a.post("/files/zip/get_zip_files",{data:e,check:"object",customType:"model"}),Hl=e=>a.post("/files/gz/get_zip_files",{data:e,check:"object",customType:"model"}),Bl=e=>a.post("files/remove_download_url",{data:e,check:"msg"}),Ul=e=>a.post("/files/logs/get_logs_info",{data:e,check:"object",customType:"model"}),Gl=e=>a.post("files/Zip",{data:e,check:"msg"}),Jl=e=>a.post("files/ZipAndDownload",{data:e,check:"msg"}),Wl=e=>a.post("files/UnZip",{data:e,check:"msg"}),$l=e=>a.post("files/get_file_attribute",{data:e,check:"object"}),Yl=e=>a.post("files/re_history",{data:e,check:"object"}),Kl=e=>a.post("files/GetFileAccess",{data:e,check:"object"}),Ql=e=>a.post("/files/zip/add_zip_file",{data:e,check:"msg",customType:"model"}),Xl=e=>a.post("/files/gz/add_zip_file",{data:e,check:"msg",customType:"model"}),Zl=e=>a.post("/files/zip/get_fileinfo_by",{data:e,check:"object",customType:"model"}),es=e=>a.post("/files/gz/get_fileinfo_by",{data:e,check:"object",customType:"model"}),ts=e=>a.post("/files/zip/write_zip_file",{data:e,check:"msg",customType:"model"}),as=e=>a.post("/files/gz/write_zip_file",{data:e,check:"msg",customType:"model"}),ls=e=>a.post("/files/zip/extract_byfiles",{data:e,check:"msg",customType:"model"}),ss=e=>a.post("/files/gz/extract_byfiles",{data:e,check:"msg",customType:"model"}),is=e=>a.post("/files/zip/delete_zip_file",{data:e,check:"msg",customType:"model"}),ns=e=>a.post("/files/gz/delete_zip_file",{data:e,check:"msg",customType:"model"}),os=e=>a.post("/files/size/get_batch_path_size",{data:e,check:"msg",customType:"model"}),rs=e=>a.post("files/add_files_rsync",{data:e,check:"msg"}),cs=()=>a.post("files/file_history_list",{check:"array"}),us=e=>a.post("files/GetFileHistory",{data:e,check:"msg"}),ps=e=>a.post("files/del_file_history",{data:e,check:"object"}),ds=e=>a.post("files/SetBatchData",{data:e,check:"msg"}),ms=e=>a.post("files/BatchPaste",{data:e,check:"msg"}),hs=e=>a.post("files/GetDirSize",{data:e,check:"string"}),fs=e=>a.post("files/CheckTaskStatus",{data:e,check:"string"}),vs=e=>a.post("files/file_history",{data:e}),gs=e=>a.post("files/read_history",{data:e,check:"object"}),ys=e=>a.post("files/del_history",{data:e,check:"msg"}),bs=(e,t)=>a.post("/files/".concat("upload"===t?"upload/upload_file":"down/download_file"),{data:{data:JSON.stringify(e)},check:"msg",customType:"model"});var _s,ws,Ss,ks={exports:{}};function Ts(e){return e&&"object"==typeof e&&!Array.isArray(e)&&null!==e}_s=ks,Ss=-1,(ws=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32}).Diff=function(e,t){return[e,t]},ws.prototype.diff_main=function(e,t,a,l){void 0===l&&(l=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+1e3*this.Diff_Timeout);var s=l;if(null==e||null==t)throw new Error("Null input. (diff_main)");if(e==t)return e?[new ws.Diff(0,e)]:[];void 0===a&&(a=!0);var i=a,n=this.diff_commonPrefix(e,t),o=e.substring(0,n);e=e.substring(n),t=t.substring(n),n=this.diff_commonSuffix(e,t);var r=e.substring(e.length-n);e=e.substring(0,e.length-n),t=t.substring(0,t.length-n);var c=this.diff_compute_(e,t,i,s);return o&&c.unshift(new ws.Diff(0,o)),r&&c.push(new ws.Diff(0,r)),this.diff_cleanupMerge(c),c},ws.prototype.diff_compute_=function(e,t,a,l){var s;if(!e)return[new ws.Diff(1,t)];if(!t)return[new ws.Diff(Ss,e)];var i=e.length>t.length?e:t,n=e.length>t.length?t:e,o=i.indexOf(n);if(-1!=o)return s=[new ws.Diff(1,i.substring(0,o)),new ws.Diff(0,n),new ws.Diff(1,i.substring(o+n.length))],e.length>t.length&&(s[0][0]=s[2][0]=Ss),s;if(1==n.length)return[new ws.Diff(Ss,e),new ws.Diff(1,t)];var r=this.diff_halfMatch_(e,t);if(r){var c=r[0],u=r[1],p=r[2],d=r[3],m=r[4],h=this.diff_main(c,p,a,l),f=this.diff_main(u,d,a,l);return h.concat([new ws.Diff(0,m)],f)}return a&&e.length>100&&t.length>100?this.diff_lineMode_(e,t,l):this.diff_bisect_(e,t,l)},ws.prototype.diff_lineMode_=function(e,t,a){var l=this.diff_linesToChars_(e,t);e=l.chars1,t=l.chars2;var s=l.lineArray,i=this.diff_main(e,t,!1,a);this.diff_charsToLines_(i,s),this.diff_cleanupSemantic(i),i.push(new ws.Diff(0,""));for(var n=0,o=0,r=0,c="",u="";n<i.length;){switch(i[n][0]){case 1:r++,u+=i[n][1];break;case Ss:o++,c+=i[n][1];break;case 0:if(o>=1&&r>=1){i.splice(n-o-r,o+r),n=n-o-r;for(var p=this.diff_main(c,u,!1,a),d=p.length-1;d>=0;d--)i.splice(n,0,p[d]);n+=p.length}r=0,o=0,c="",u=""}n++}return i.pop(),i},ws.prototype.diff_bisect_=function(e,t,a){for(var l=e.length,s=t.length,i=Math.ceil((l+s)/2),n=i,o=2*i,r=new Array(o),c=new Array(o),u=0;u<o;u++)r[u]=-1,c[u]=-1;r[n+1]=0,c[n+1]=0;for(var p=l-s,d=p%2!=0,m=0,h=0,f=0,v=0,g=0;g<i&&!((new Date).getTime()>a);g++){for(var y=-g+m;y<=g-h;y+=2){for(var b=n+y,_=(L=y==-g||y!=g&&r[b-1]<r[b+1]?r[b+1]:r[b-1]+1)-y;L<l&&_<s&&e.charAt(L)==t.charAt(_);)L++,_++;if(r[b]=L,L>l)h+=2;else if(_>s)m+=2;else if(d&&(k=n+p-y)>=0&&k<o&&-1!=c[k]&&L>=(S=l-c[k]))return this.diff_bisectSplit_(e,t,L,_,a)}for(var w=-g+f;w<=g-v;w+=2){for(var S,k=n+w,T=(S=w==-g||w!=g&&c[k-1]<c[k+1]?c[k+1]:c[k-1]+1)-w;S<l&&T<s&&e.charAt(l-S-1)==t.charAt(s-T-1);)S++,T++;if(c[k]=S,S>l)v+=2;else if(T>s)f+=2;else if(!d){var L;if((b=n+p-w)>=0&&b<o&&-1!=r[b])if(_=n+(L=r[b])-b,L>=(S=l-S))return this.diff_bisectSplit_(e,t,L,_,a)}}}return[new ws.Diff(Ss,e),new ws.Diff(1,t)]},ws.prototype.diff_bisectSplit_=function(e,t,a,l,s){var i=e.substring(0,a),n=t.substring(0,l),o=e.substring(a),r=t.substring(l),c=this.diff_main(i,n,!1,s),u=this.diff_main(o,r,!1,s);return c.concat(u)},ws.prototype.diff_linesToChars_=function(e,t){var a=[],l={};function s(e){for(var t="",s=0,n=-1,o=a.length;n<e.length-1;){-1==(n=e.indexOf("\n",s))&&(n=e.length-1);var r=e.substring(s,n+1);(l.hasOwnProperty?l.hasOwnProperty(r):void 0!==l[r])?t+=String.fromCharCode(l[r]):(o==i&&(r=e.substring(s),n=e.length),t+=String.fromCharCode(o),l[r]=o,a[o++]=r),s=n+1}return t}a[0]="";var i=4e4,n=s(e);return i=65535,{chars1:n,chars2:s(t),lineArray:a}},ws.prototype.diff_charsToLines_=function(e,t){for(var a=0;a<e.length;a++){for(var l=e[a][1],s=[],i=0;i<l.length;i++)s[i]=t[l.charCodeAt(i)];e[a][1]=s.join("")}},ws.prototype.diff_commonPrefix=function(e,t){if(!e||!t||e.charAt(0)!=t.charAt(0))return 0;for(var a=0,l=Math.min(e.length,t.length),s=l,i=0;a<s;)e.substring(i,s)==t.substring(i,s)?i=a=s:l=s,s=Math.floor((l-a)/2+a);return s},ws.prototype.diff_commonSuffix=function(e,t){if(!e||!t||e.charAt(e.length-1)!=t.charAt(t.length-1))return 0;for(var a=0,l=Math.min(e.length,t.length),s=l,i=0;a<s;)e.substring(e.length-s,e.length-i)==t.substring(t.length-s,t.length-i)?i=a=s:l=s,s=Math.floor((l-a)/2+a);return s},ws.prototype.diff_commonOverlap_=function(e,t){var a=e.length,l=t.length;if(0==a||0==l)return 0;a>l?e=e.substring(a-l):a<l&&(t=t.substring(0,a));var s=Math.min(a,l);if(e==t)return s;for(var i=0,n=1;;){var o=e.substring(s-n),r=t.indexOf(o);if(-1==r)return i;n+=r,0!=r&&e.substring(s-n)!=t.substring(0,n)||(i=n,n++)}},ws.prototype.diff_halfMatch_=function(e,t){if(this.Diff_Timeout<=0)return null;var a=e.length>t.length?e:t,l=e.length>t.length?t:e;if(a.length<4||2*l.length<a.length)return null;var s=this;function i(e,t,a){for(var l,i,n,o,r=e.substring(a,a+Math.floor(e.length/4)),c=-1,u="";-1!=(c=t.indexOf(r,c+1));){var p=s.diff_commonPrefix(e.substring(a),t.substring(c)),d=s.diff_commonSuffix(e.substring(0,a),t.substring(0,c));u.length<d+p&&(u=t.substring(c-d,c)+t.substring(c,c+p),l=e.substring(0,a-d),i=e.substring(a+p),n=t.substring(0,c-d),o=t.substring(c+p))}return 2*u.length>=e.length?[l,i,n,o,u]:null}var n,o,r,c,u,p=i(a,l,Math.ceil(a.length/4)),d=i(a,l,Math.ceil(a.length/2));return p||d?(n=d?p&&p[4].length>d[4].length?p:d:p,e.length>t.length?(o=n[0],r=n[1],c=n[2],u=n[3]):(c=n[0],u=n[1],o=n[2],r=n[3]),[o,r,c,u,n[4]]):null},ws.prototype.diff_cleanupSemantic=function(e){for(var t=!1,a=[],l=0,s=null,i=0,n=0,o=0,r=0,c=0;i<e.length;)0==e[i][0]?(a[l++]=i,n=r,o=c,r=0,c=0,s=e[i][1]):(1==e[i][0]?r+=e[i][1].length:c+=e[i][1].length,s&&s.length<=Math.max(n,o)&&s.length<=Math.max(r,c)&&(e.splice(a[l-1],0,new ws.Diff(Ss,s)),e[a[l-1]+1][0]=1,l--,i=--l>0?a[l-1]:-1,n=0,o=0,r=0,c=0,s=null,t=!0)),i++;for(t&&this.diff_cleanupMerge(e),this.diff_cleanupSemanticLossless(e),i=1;i<e.length;){if(e[i-1][0]==Ss&&1==e[i][0]){var u=e[i-1][1],p=e[i][1],d=this.diff_commonOverlap_(u,p),m=this.diff_commonOverlap_(p,u);d>=m?(d>=u.length/2||d>=p.length/2)&&(e.splice(i,0,new ws.Diff(0,p.substring(0,d))),e[i-1][1]=u.substring(0,u.length-d),e[i+1][1]=p.substring(d),i++):(m>=u.length/2||m>=p.length/2)&&(e.splice(i,0,new ws.Diff(0,u.substring(0,m))),e[i-1][0]=1,e[i-1][1]=p.substring(0,p.length-m),e[i+1][0]=Ss,e[i+1][1]=u.substring(m),i++),i++}i++}},ws.prototype.diff_cleanupSemanticLossless=function(e){function t(e,t){if(!e||!t)return 6;var a=e.charAt(e.length-1),l=t.charAt(0),s=a.match(ws.nonAlphaNumericRegex_),i=l.match(ws.nonAlphaNumericRegex_),n=s&&a.match(ws.whitespaceRegex_),o=i&&l.match(ws.whitespaceRegex_),r=n&&a.match(ws.linebreakRegex_),c=o&&l.match(ws.linebreakRegex_),u=r&&e.match(ws.blanklineEndRegex_),p=c&&t.match(ws.blanklineStartRegex_);return u||p?5:r||c?4:s&&!n&&o?3:n||o?2:s||i?1:0}for(var a=1;a<e.length-1;){if(0==e[a-1][0]&&0==e[a+1][0]){var l=e[a-1][1],s=e[a][1],i=e[a+1][1],n=this.diff_commonSuffix(l,s);if(n){var o=s.substring(s.length-n);l=l.substring(0,l.length-n),s=o+s.substring(0,s.length-n),i=o+i}for(var r=l,c=s,u=i,p=t(l,s)+t(s,i);s.charAt(0)===i.charAt(0);){l+=s.charAt(0),s=s.substring(1)+i.charAt(0),i=i.substring(1);var d=t(l,s)+t(s,i);d>=p&&(p=d,r=l,c=s,u=i)}e[a-1][1]!=r&&(r?e[a-1][1]=r:(e.splice(a-1,1),a--),e[a][1]=c,u?e[a+1][1]=u:(e.splice(a+1,1),a--))}a++}},ws.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,ws.whitespaceRegex_=/\s/,ws.linebreakRegex_=/[\r\n]/,ws.blanklineEndRegex_=/\n\r?\n$/,ws.blanklineStartRegex_=/^\r?\n\r?\n/,ws.prototype.diff_cleanupEfficiency=function(e){for(var t=!1,a=[],l=0,s=null,i=0,n=!1,o=!1,r=!1,c=!1;i<e.length;)0==e[i][0]?(e[i][1].length<this.Diff_EditCost&&(r||c)?(a[l++]=i,n=r,o=c,s=e[i][1]):(l=0,s=null),r=c=!1):(e[i][0]==Ss?c=!0:r=!0,s&&(n&&o&&r&&c||s.length<this.Diff_EditCost/2&&n+o+r+c==3)&&(e.splice(a[l-1],0,new ws.Diff(Ss,s)),e[a[l-1]+1][0]=1,l--,s=null,n&&o?(r=c=!0,l=0):(i=--l>0?a[l-1]:-1,r=c=!1),t=!0)),i++;t&&this.diff_cleanupMerge(e)},ws.prototype.diff_cleanupMerge=function(e){e.push(new ws.Diff(0,""));for(var t,a=0,l=0,s=0,i="",n="";a<e.length;)switch(e[a][0]){case 1:s++,n+=e[a][1],a++;break;case Ss:l++,i+=e[a][1],a++;break;case 0:l+s>1?(0!==l&&0!==s&&(0!==(t=this.diff_commonPrefix(n,i))&&(a-l-s>0&&0==e[a-l-s-1][0]?e[a-l-s-1][1]+=n.substring(0,t):(e.splice(0,0,new ws.Diff(0,n.substring(0,t))),a++),n=n.substring(t),i=i.substring(t)),0!==(t=this.diff_commonSuffix(n,i))&&(e[a][1]=n.substring(n.length-t)+e[a][1],n=n.substring(0,n.length-t),i=i.substring(0,i.length-t))),a-=l+s,e.splice(a,l+s),i.length&&(e.splice(a,0,new ws.Diff(Ss,i)),a++),n.length&&(e.splice(a,0,new ws.Diff(1,n)),a++),a++):0!==a&&0==e[a-1][0]?(e[a-1][1]+=e[a][1],e.splice(a,1)):a++,s=0,l=0,i="",n=""}""===e[e.length-1][1]&&e.pop();var o=!1;for(a=1;a<e.length-1;)0==e[a-1][0]&&0==e[a+1][0]&&(e[a][1].substring(e[a][1].length-e[a-1][1].length)==e[a-1][1]?(e[a][1]=e[a-1][1]+e[a][1].substring(0,e[a][1].length-e[a-1][1].length),e[a+1][1]=e[a-1][1]+e[a+1][1],e.splice(a-1,1),o=!0):e[a][1].substring(0,e[a+1][1].length)==e[a+1][1]&&(e[a-1][1]+=e[a+1][1],e[a][1]=e[a][1].substring(e[a+1][1].length)+e[a+1][1],e.splice(a+1,1),o=!0)),a++;o&&this.diff_cleanupMerge(e)},ws.prototype.diff_xIndex=function(e,t){var a,l=0,s=0,i=0,n=0;for(a=0;a<e.length&&(1!==e[a][0]&&(l+=e[a][1].length),e[a][0]!==Ss&&(s+=e[a][1].length),!(l>t));a++)i=l,n=s;return e.length!=a&&e[a][0]===Ss?n:n+(t-i)},ws.prototype.diff_prettyHtml=function(e){for(var t=[],a=/&/g,l=/</g,s=/>/g,i=/\n/g,n=0;n<e.length;n++){var o=e[n][0],r=e[n][1].replace(a,"&amp;").replace(l,"&lt;").replace(s,"&gt;").replace(i,"&para;<br>");switch(o){case 1:t[n]='<ins style="background:#e6ffe6;">'+r+"</ins>";break;case Ss:t[n]='<del style="background:#ffe6e6;">'+r+"</del>";break;case 0:t[n]="<span>"+r+"</span>"}}return t.join("")},ws.prototype.diff_text1=function(e){for(var t=[],a=0;a<e.length;a++)1!==e[a][0]&&(t[a]=e[a][1]);return t.join("")},ws.prototype.diff_text2=function(e){for(var t=[],a=0;a<e.length;a++)e[a][0]!==Ss&&(t[a]=e[a][1]);return t.join("")},ws.prototype.diff_levenshtein=function(e){for(var t=0,a=0,l=0,s=0;s<e.length;s++){var i=e[s][0],n=e[s][1];switch(i){case 1:a+=n.length;break;case Ss:l+=n.length;break;case 0:t+=Math.max(a,l),a=0,l=0}}return t+=Math.max(a,l)},ws.prototype.diff_toDelta=function(e){for(var t=[],a=0;a<e.length;a++)switch(e[a][0]){case 1:t[a]="+"+encodeURI(e[a][1]);break;case Ss:t[a]="-"+e[a][1].length;break;case 0:t[a]="="+e[a][1].length}return t.join("\t").replace(/%20/g," ")},ws.prototype.diff_fromDelta=function(e,t){for(var a=[],l=0,s=0,i=t.split(/\t/g),n=0;n<i.length;n++){var o=i[n].substring(1);switch(i[n].charAt(0)){case"+":try{a[l++]=new ws.Diff(1,decodeURI(o))}catch(u){throw new Error("Illegal escape in diff_fromDelta: "+o)}break;case"-":case"=":var r=parseInt(o,10);if(isNaN(r)||r<0)throw new Error("Invalid number in diff_fromDelta: "+o);var c=e.substring(s,s+=r);"="==i[n].charAt(0)?a[l++]=new ws.Diff(0,c):a[l++]=new ws.Diff(Ss,c);break;default:if(i[n])throw new Error("Invalid diff operation in diff_fromDelta: "+i[n])}}if(s!=e.length)throw new Error("Delta length ("+s+") does not equal source text length ("+e.length+").");return a},ws.prototype.match_main=function(e,t,a){if(null==e||null==t||null==a)throw new Error("Null input. (match_main)");return a=Math.max(0,Math.min(a,e.length)),e==t?0:e.length?e.substring(a,a+t.length)==t?a:this.match_bitap_(e,t,a):-1},ws.prototype.match_bitap_=function(e,t,a){if(t.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var l=this.match_alphabet_(t),s=this;function i(e,l){var i=e/t.length,n=Math.abs(a-l);return s.Match_Distance?i+n/s.Match_Distance:n?1:i}var n=this.Match_Threshold,o=e.indexOf(t,a);-1!=o&&(n=Math.min(i(0,o),n),-1!=(o=e.lastIndexOf(t,a+t.length))&&(n=Math.min(i(0,o),n)));var r,c,u=1<<t.length-1;o=-1;for(var p,d=t.length+e.length,m=0;m<t.length;m++){for(r=0,c=d;r<c;)i(m,a+c)<=n?r=c:d=c,c=Math.floor((d-r)/2+r);d=c;var h=Math.max(1,a-c+1),f=Math.min(a+c,e.length)+t.length,v=Array(f+2);v[f+1]=(1<<m)-1;for(var g=f;g>=h;g--){var y=l[e.charAt(g-1)];if(v[g]=0===m?(v[g+1]<<1|1)&y:(v[g+1]<<1|1)&y|(p[g+1]|p[g])<<1|1|p[g+1],v[g]&u){var b=i(m,g-1);if(b<=n){if(n=b,!((o=g-1)>a))break;h=Math.max(1,2*a-o)}}}if(i(m+1,a)>n)break;p=v}return o},ws.prototype.match_alphabet_=function(e){for(var t={},a=0;a<e.length;a++)t[e.charAt(a)]=0;for(a=0;a<e.length;a++)t[e.charAt(a)]|=1<<e.length-a-1;return t},ws.prototype.patch_addContext_=function(e,t){if(0!=t.length){if(null===e.start2)throw Error("patch not initialized");for(var a=t.substring(e.start2,e.start2+e.length1),l=0;t.indexOf(a)!=t.lastIndexOf(a)&&a.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)l+=this.Patch_Margin,a=t.substring(e.start2-l,e.start2+e.length1+l);l+=this.Patch_Margin;var s=t.substring(e.start2-l,e.start2);s&&e.diffs.unshift(new ws.Diff(0,s));var i=t.substring(e.start2+e.length1,e.start2+e.length1+l);i&&e.diffs.push(new ws.Diff(0,i)),e.start1-=s.length,e.start2-=s.length,e.length1+=s.length+i.length,e.length2+=s.length+i.length}},ws.prototype.patch_make=function(e,t,a){var l,s;if("string"==typeof e&&"string"==typeof t&&void 0===a)l=e,(s=this.diff_main(l,t,!0)).length>2&&(this.diff_cleanupSemantic(s),this.diff_cleanupEfficiency(s));else if(e&&"object"==typeof e&&void 0===t&&void 0===a)s=e,l=this.diff_text1(s);else if("string"==typeof e&&t&&"object"==typeof t&&void 0===a)l=e,s=t;else{if("string"!=typeof e||"string"!=typeof t||!a||"object"!=typeof a)throw new Error("Unknown call format to patch_make.");l=e,s=a}if(0===s.length)return[];for(var i=[],n=new ws.patch_obj,o=0,r=0,c=0,u=l,p=l,d=0;d<s.length;d++){var m=s[d][0],h=s[d][1];switch(o||0===m||(n.start1=r,n.start2=c),m){case 1:n.diffs[o++]=s[d],n.length2+=h.length,p=p.substring(0,c)+h+p.substring(c);break;case Ss:n.length1+=h.length,n.diffs[o++]=s[d],p=p.substring(0,c)+p.substring(c+h.length);break;case 0:h.length<=2*this.Patch_Margin&&o&&s.length!=d+1?(n.diffs[o++]=s[d],n.length1+=h.length,n.length2+=h.length):h.length>=2*this.Patch_Margin&&o&&(this.patch_addContext_(n,u),i.push(n),n=new ws.patch_obj,o=0,u=p,r=c)}1!==m&&(r+=h.length),m!==Ss&&(c+=h.length)}return o&&(this.patch_addContext_(n,u),i.push(n)),i},ws.prototype.patch_deepCopy=function(e){for(var t=[],a=0;a<e.length;a++){var l=e[a],s=new ws.patch_obj;s.diffs=[];for(var i=0;i<l.diffs.length;i++)s.diffs[i]=new ws.Diff(l.diffs[i][0],l.diffs[i][1]);s.start1=l.start1,s.start2=l.start2,s.length1=l.length1,s.length2=l.length2,t[a]=s}return t},ws.prototype.patch_apply=function(e,t){if(0==e.length)return[t,[]];e=this.patch_deepCopy(e);var a=this.patch_addPadding(e);t=a+t+a,this.patch_splitMax(e);for(var l=0,s=[],i=0;i<e.length;i++){var n,o,r=e[i].start2+l,c=this.diff_text1(e[i].diffs),u=-1;if(c.length>this.Match_MaxBits?-1!=(n=this.match_main(t,c.substring(0,this.Match_MaxBits),r))&&(-1==(u=this.match_main(t,c.substring(c.length-this.Match_MaxBits),r+c.length-this.Match_MaxBits))||n>=u)&&(n=-1):n=this.match_main(t,c,r),-1==n)s[i]=!1,l-=e[i].length2-e[i].length1;else if(s[i]=!0,l=n-r,c==(o=-1==u?t.substring(n,n+c.length):t.substring(n,u+this.Match_MaxBits)))t=t.substring(0,n)+this.diff_text2(e[i].diffs)+t.substring(n+c.length);else{var p=this.diff_main(c,o,!1);if(c.length>this.Match_MaxBits&&this.diff_levenshtein(p)/c.length>this.Patch_DeleteThreshold)s[i]=!1;else{this.diff_cleanupSemanticLossless(p);for(var d,m=0,h=0;h<e[i].diffs.length;h++){var f=e[i].diffs[h];0!==f[0]&&(d=this.diff_xIndex(p,m)),1===f[0]?t=t.substring(0,n+d)+f[1]+t.substring(n+d):f[0]===Ss&&(t=t.substring(0,n+d)+t.substring(n+this.diff_xIndex(p,m+f[1].length))),f[0]!==Ss&&(m+=f[1].length)}}}}return[t=t.substring(a.length,t.length-a.length),s]},ws.prototype.patch_addPadding=function(e){for(var t=this.Patch_Margin,a="",l=1;l<=t;l++)a+=String.fromCharCode(l);for(l=0;l<e.length;l++)e[l].start1+=t,e[l].start2+=t;var s=e[0],i=s.diffs;if(0==i.length||0!=i[0][0])i.unshift(new ws.Diff(0,a)),s.start1-=t,s.start2-=t,s.length1+=t,s.length2+=t;else if(t>i[0][1].length){var n=t-i[0][1].length;i[0][1]=a.substring(i[0][1].length)+i[0][1],s.start1-=n,s.start2-=n,s.length1+=n,s.length2+=n}return 0==(i=(s=e[e.length-1]).diffs).length||0!=i[i.length-1][0]?(i.push(new ws.Diff(0,a)),s.length1+=t,s.length2+=t):t>i[i.length-1][1].length&&(n=t-i[i.length-1][1].length,i[i.length-1][1]+=a.substring(0,n),s.length1+=n,s.length2+=n),a},ws.prototype.patch_splitMax=function(e){for(var t=this.Match_MaxBits,a=0;a<e.length;a++)if(!(e[a].length1<=t)){var l=e[a];e.splice(a--,1);for(var s=l.start1,i=l.start2,n="";0!==l.diffs.length;){var o=new ws.patch_obj,r=!0;for(o.start1=s-n.length,o.start2=i-n.length,""!==n&&(o.length1=o.length2=n.length,o.diffs.push(new ws.Diff(0,n)));0!==l.diffs.length&&o.length1<t-this.Patch_Margin;){var c=l.diffs[0][0],u=l.diffs[0][1];1===c?(o.length2+=u.length,i+=u.length,o.diffs.push(l.diffs.shift()),r=!1):c===Ss&&1==o.diffs.length&&0==o.diffs[0][0]&&u.length>2*t?(o.length1+=u.length,s+=u.length,r=!1,o.diffs.push(new ws.Diff(c,u)),l.diffs.shift()):(u=u.substring(0,t-o.length1-this.Patch_Margin),o.length1+=u.length,s+=u.length,0===c?(o.length2+=u.length,i+=u.length):r=!1,o.diffs.push(new ws.Diff(c,u)),u==l.diffs[0][1]?l.diffs.shift():l.diffs[0][1]=l.diffs[0][1].substring(u.length))}n=(n=this.diff_text2(o.diffs)).substring(n.length-this.Patch_Margin);var p=this.diff_text1(l.diffs).substring(0,this.Patch_Margin);""!==p&&(o.length1+=p.length,o.length2+=p.length,0!==o.diffs.length&&0===o.diffs[o.diffs.length-1][0]?o.diffs[o.diffs.length-1][1]+=p:o.diffs.push(new ws.Diff(0,p))),r||e.splice(++a,0,o)}}},ws.prototype.patch_toText=function(e){for(var t=[],a=0;a<e.length;a++)t[a]=e[a];return t.join("")},ws.prototype.patch_fromText=function(e){var t=[];if(!e)return t;for(var a=e.split("\n"),l=0,s=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;l<a.length;){var i=a[l].match(s);if(!i)throw new Error("Invalid patch string: "+a[l]);var n=new ws.patch_obj;for(t.push(n),n.start1=parseInt(i[1],10),""===i[2]?(n.start1--,n.length1=1):"0"==i[2]?n.length1=0:(n.start1--,n.length1=parseInt(i[2],10)),n.start2=parseInt(i[3],10),""===i[4]?(n.start2--,n.length2=1):"0"==i[4]?n.length2=0:(n.start2--,n.length2=parseInt(i[4],10)),l++;l<a.length;){var o=a[l].charAt(0);try{var r=decodeURI(a[l].substring(1))}catch(c){throw new Error("Illegal escape in patch_fromText: "+r)}if("-"==o)n.diffs.push(new ws.Diff(Ss,r));else if("+"==o)n.diffs.push(new ws.Diff(1,r));else if(" "==o)n.diffs.push(new ws.Diff(0,r));else{if("@"==o)break;if(""!==o)throw new Error('Invalid patch mode "'+o+'" in: '+r)}l++}}return t},(ws.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0}).prototype.toString=function(){for(var e,t=["@@ -"+(0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1)+" +"+(0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2)+" @@\n"],a=0;a<this.diffs.length;a++){switch(this.diffs[a][0]){case 1:e="+";break;case Ss:e="-";break;case 0:e=" "}t[a+1]=e+encodeURI(this.diffs[a][1])+"\n"}return t.join("").replace(/%20/g," ")},_s.exports=ws,_s.exports.diff_match_patch=ws,_s.exports.DIFF_DELETE=Ss,_s.exports.DIFF_INSERT=1,_s.exports.DIFF_EQUAL=0;var Ls={DIFF_EQUAL:0,DIFF_DELETE:-1,DIFF_INSERT:1,EDITOR_RIGHT:"right",EDITOR_LEFT:"left",RTL:"rtl",LTR:"ltr",SVG_NS:"http://www.w3.org/2000/svg",DIFF_GRANULARITY_SPECIFIC:"specific",DIFF_GRANULARITY_BROAD:"broad"};const Es=Ls;const xs=Ls;const Cs=ks.exports,Ds=function e(t,a){return Ts(t)&&Ts(a)&&Object.keys(a).forEach(l=>{Ts(a[l])?(t[l]&&Ts(t[l])||(t[l]=a[l]),e(t[l],a[l])):Object.assign(t,{[l]:a[l]})}),t},Is=function(e,t,a=!1){let l=null,s=!0;return(...i)=>{const n=()=>{e.apply(this,i),l=null};a&&s&&(s=!1,n()),l||(l=setTimeout(n,t))}},Ps=function(e,t){let a;return(...l)=>{const s=this;clearTimeout(a),a=setTimeout(()=>e.apply(s,l),t)}},Fs=function(e=""){return e.replace(/\r\n/g,"\n")},Rs=function(e,t,a,l){const s=e+(a-e)/2;return"M ".concat(e," ").concat(t," C ").concat(s,",").concat(t," ").concat(s,",").concat(l," ").concat(a,",").concat(l)},Ns=function(e,t){let{mode:a}=e.options;return t===Es.EDITOR_LEFT&&null!==e.options.left.mode&&(a=e.options.left.mode),t===Es.EDITOR_RIGHT&&null!==e.options.right.mode&&(a=e.options.right.mode),a},Os=function(e,t){let{theme:a}=e.options;return t===xs.EDITOR_LEFT&&null!==e.options.left.theme&&(a=e.options.left.theme),t===xs.EDITOR_RIGHT&&null!==e.options.right.theme&&(a=e.options.right.theme),a},js=function(e,t){return e.ace.getSession().doc.getLine(t)},As=function(e){return document.getElementById(e.options.left.id).offsetHeight},Vs=function(e){const t=document.createElement("div"),a={class:e.className,style:"top:".concat(e.topOffset,"px"),title:e.tooltip,"data-diff-index":e.diffIndex};for(const l in a)t.setAttribute(l,a[l]);return t.innerHTML=e.arrowContent,t},zs=function(e,t){const a=Math.random().toString(36).substr(2,5),l="js-".concat(t,"-").concat(a),s=e.querySelector(".".concat(t));if(s)return s.id=s.id||l,s.id;const i=document.createElement("div");return e.appendChild(i),i.className=t,i.id=l,i.id},Ms={on:function(e,t,a,l){const s="document"===e?document:document.querySelector(e);s.addEventListener(t,e=>{const t=s.querySelectorAll(a),{target:i}=e;for(let a=0,n=t.length;a<n;a+=1){let n=i;const o=t[a];for(;n&&n!==s;)n===o&&l.call(o,e),n=n.parentNode}})}},qs=Ls;let Hs;function Bs(e={}){if(!(this instanceof Bs))return new Bs(e);const t=this;t.options=Ds({ace:window?window.ace:void 0,mode:null,theme:null,element:null,diffGranularity:qs.DIFF_GRANULARITY_BROAD,lockScrolling:!1,showDiffs:!0,showConnectors:!0,maxDiffs:5e3,left:{id:null,content:null,mode:null,theme:null,editable:!0,copyLinkEnabled:!0},right:{id:null,content:null,mode:null,theme:null,editable:!0,copyLinkEnabled:!0},classes:{gutterID:"acediff__gutter",diff:"acediff__diffLine",connector:"acediff__connector",newCodeConnectorLink:"acediff__newCodeConnector",newCodeConnectorLinkContent:"&#8594;",deletedCodeConnectorLink:"acediff__deletedCodeConnector",deletedCodeConnectorLinkContent:"&#8592;",copyRightContainer:"acediff__copy--right",copyLeftContainer:"acediff__copy--left"},connectorYOffset:0},e);const{ace:a}=t.options;if(!a){return new Error("No ace editor found nor supplied - `options.ace` or `window.ace` is missing")}if(Hs=function(e){if(e.Range)return e.Range;const t=e.acequire||e.require;return!!t&&t("ace/range")}(a),!Hs){return new Error("Could not require Range module for Ace. Depends on your bundling strategy, but it usually comes with Ace itself. See https://ace.c9.io/api/range.html, open an issue on GitHub ace-diff/ace-diff")}if(null===t.options.element){return new Error("You need to specify an element for Ace-diff - `options.element` is missing")}if(t.options.element instanceof HTMLElement?t.el=t.options.element:t.el=document.body.querySelector(t.options.element),!t.el){const e="Can't find the specified element ".concat(t.options.element);return new Error(e)}t.options.left.id=zs(t.el,"acediff__left"),t.options.classes.gutterID=zs(t.el,"acediff__gutter"),t.options.right.id=zs(t.el,"acediff__right"),t.el.innerHTML='<div class="acediff__wrap">'.concat(t.el.innerHTML,"</div>"),t.editors={left:{ace:a.edit(t.options.left.id),markers:[],lineLengths:[]},right:{ace:a.edit(t.options.right.id),markers:[],lineLengths:[]},editorHeight:null},t.editors.left.ace.getSession().setMode(Ns(t,qs.EDITOR_LEFT)),t.editors.right.ace.getSession().setMode(Ns(t,qs.EDITOR_RIGHT)),t.editors.left.ace.setReadOnly(!t.options.left.editable),t.editors.right.ace.setReadOnly(!t.options.right.editable),t.editors.left.ace.setTheme(Os(t,qs.EDITOR_LEFT)),t.editors.right.ace.setTheme(Os(t,qs.EDITOR_RIGHT)),t.editors.left.ace.setValue(Fs(t.options.left.content),-1),t.editors.right.ace.setValue(Fs(t.options.right.content),-1),t.editors.editorHeight=As(t),setTimeout(()=>{t.lineHeight=t.editors.left.ace.renderer.lineHeight,function(e){e.editors.left.ace.getSession().on("changeScrollTop",Is(()=>{$s(e)},16)),e.editors.right.ace.getSession().on("changeScrollTop",Is(()=>{$s(e)},16));const t=e.diff.bind(e);e.editors.left.ace.on("change",t),e.editors.right.ace.on("change",t),e.options.left.copyLinkEnabled&&Ms.on("#".concat(e.options.classes.gutterID),"click",".".concat(e.options.classes.newCodeConnectorLink),t=>{Gs(e,t,qs.LTR)});e.options.right.copyLinkEnabled&&Ms.on("#".concat(e.options.classes.gutterID),"click",".".concat(e.options.classes.deletedCodeConnectorLink),t=>{Gs(e,t,qs.RTL)});const a=Ps(()=>{e.editors.availableHeight=document.getElementById(e.options.left.id).offsetHeight,e.diff()},250);window.addEventListener("resize",a),Us=()=>{window.removeEventListener("resize",a)}}(t),function(e){e.copyRightContainer=document.createElement("div"),e.copyRightContainer.setAttribute("class",e.options.classes.copyRightContainer),e.copyLeftContainer=document.createElement("div"),e.copyLeftContainer.setAttribute("class",e.options.classes.copyLeftContainer),document.getElementById(e.options.classes.gutterID).appendChild(e.copyRightContainer),document.getElementById(e.options.classes.gutterID).appendChild(e.copyLeftContainer)}(t),ti(t),t.diff()},1)}Bs.prototype={setOptions(e){Ds(this.options,e),this.diff()},getNumDiffs(){return this.diffs.length},getEditors(){return{left:this.editors.left.ace,right:this.editors.right.ace}},diff(){const e=new Cs,t=this.editors.left.ace.getSession().getValue(),a=this.editors.right.ace.getSession().getValue(),l=e.diff_main(a,t);e.diff_cleanupSemantic(l),this.editors.left.lineLengths=Js(this.editors.left),this.editors.right.lineLengths=Js(this.editors.right);const s=[],i={left:0,right:0};l.forEach((e,t,a)=>{const n=e[0];let o=e[1];a[t+1]&&o.endsWith("\n")&&a[t+1][1].startsWith("\n")&&(o+="\n",l[t][1]=o,l[t+1][1]=l[t+1][1].replace(/^\n/,"")),0!==o.length&&(n===qs.DIFF_EQUAL?(i.left+=o.length,i.right+=o.length):n===qs.DIFF_DELETE?(s.push(Ks(this,qs.DIFF_DELETE,i.left,i.right,o)),i.right+=o.length):n===qs.DIFF_INSERT&&(s.push(Ks(this,qs.DIFF_INSERT,i.left,i.right,o)),i.left+=o.length))},this),this.diffs=function(e,t){const a=[];function l(t){return e.options.diffGranularity===qs.DIFF_GRANULARITY_SPECIFIC?t<1:t<=1}t.forEach((e,t)=>{if(0===t)return void a.push(e);let s=!1;for(let i=0;i<a.length;i+=1)if(l(Math.abs(e.leftStartLine-a[i].leftEndLine))&&l(Math.abs(e.rightStartLine-a[i].rightEndLine))){a[i].leftStartLine=Math.min(e.leftStartLine,a[i].leftStartLine),a[i].rightStartLine=Math.min(e.rightStartLine,a[i].rightStartLine),a[i].leftEndLine=Math.max(e.leftEndLine,a[i].leftEndLine),a[i].rightEndLine=Math.max(e.rightEndLine,a[i].rightEndLine),s=!0;break}s||a.push(e)});const s=[];return a.forEach(e=>{e.leftStartLine===e.leftEndLine&&e.rightStartLine===e.rightEndLine||s.push(e)}),s}(this,s),this.diffs.length>this.options.maxDiffs||(Ys(this),li(this))},destroy(){const e=this.editors.left.ace.getValue();this.editors.left.ace.destroy();let t=this.editors.left.ace.container,a=t.cloneNode(!1);a.textContent=e,t.parentNode.replaceChild(a,t);const l=this.editors.right.ace.getValue();this.editors.right.ace.destroy(),t=this.editors.right.ace.container,a=t.cloneNode(!1),a.textContent=l,t.parentNode.replaceChild(a,t),document.getElementById(this.options.classes.gutterID).innerHTML="",Us()}};let Us=()=>{};function Gs(e,t,a){const l=parseInt(t.target.getAttribute("data-diff-index"),10),s=e.diffs[l];let i,n,o,r,c,u;a===qs.LTR?(i=e.editors.left,n=e.editors.right,o=s.leftStartLine,r=s.leftEndLine,c=s.rightStartLine,u=s.rightEndLine):(i=e.editors.right,n=e.editors.left,o=s.rightStartLine,r=s.rightEndLine,c=s.leftStartLine,u=s.leftEndLine);let p="";for(let m=o;m<r;m+=1)p+="".concat(js(i,m),"\n");const d=n.ace.getSession().getScrollTop();n.ace.getSession().replace(new Hs(c,0,u,0),p),n.ace.getSession().setScrollTop(parseInt(d,10)),e.diff()}function Js(e){const t=e.ace.getSession().doc.getAllLines(),a=[];return t.forEach(e=>{a.push(e.length+1)}),a}function Ws(e,t,a,l,s){const i=e.editors[t];l<a&&(l=a);const n="".concat(s," ").concat(l>a?"lines":"targetOnly");i.markers.push(i.ace.session.addMarker(new Hs(a,0,l-1,1),n,"fullLine"))}function $s(e){Ys(e),li(e),function(e){const t=e.editors.left.ace.getSession().getScrollTop(),a=e.editors.right.ace.getSession().getScrollTop();e.copyRightContainer.style.cssText="top: ".concat(-t,"px"),e.copyLeftContainer.style.cssText="top: ".concat(-a,"px")}(e)}function Ys(e){e.editors.left.markers.forEach(t=>{e.editors.left.ace.getSession().removeMarker(t)},e),e.editors.right.markers.forEach(t=>{e.editors.right.ace.getSession().removeMarker(t)},e)}function Ks(e,t,a,l,s){let i={},n=/^\n/.test(s);if(t===qs.DIFF_INSERT){var o=Qs(e.editors.left,a,s),r=Zs(e.editors.right,l),c=Xs(e.editors.right,r);const t=Xs(e.editors.left,o.startLine);let d=r;0===Xs(e.editors.left,o.startLine)&&n&&(n=!1),0===o.startChar&&ei(e.editors.right,l,n)&&(d=r+1);var u=o.startLine===o.endLine,p=0;(o.startChar>0||u&&s.length<t)&&c>0&&o.startChar<t&&p++,i={leftStartLine:o.startLine,leftEndLine:o.endLine+1,rightStartLine:d,rightEndLine:d+p}}else{o=Qs(e.editors.right,l,s),r=Zs(e.editors.left,a),c=Xs(e.editors.left,r);const t=Xs(e.editors.right,o.startLine);let d=r;0===Xs(e.editors.right,o.startLine)&&n&&(n=!1),0===o.startChar&&ei(e.editors.left,a,n)&&(d=r+1);u=o.startLine===o.endLine,p=0;(o.startChar>0||u&&s.length<t)&&c>0&&o.startChar<t&&p++,i={leftStartLine:d,leftEndLine:d+p,rightStartLine:o.startLine,rightEndLine:o.endLine+1}}return i}function Qs(e,t,a){const l={startLine:0,startChar:0,endLine:0,endChar:0},s=t+a.length;let i=0,n=!1,o=!1;e.lineLengths.forEach((e,a)=>{i+=e,!n&&t<i&&(l.startLine=a,l.startChar=t-i+e,n=!0),!o&&s<=i&&(l.endLine=a,l.endChar=s-i+e,o=!0)}),l.startChar>0&&Xs(e,l.startLine)===l.startChar&&(l.startLine++,l.startChar=0),0===l.endChar&&l.endLine--;const r=/\n$/.test(a);return l.startChar>0&&r&&l.endLine++,l}function Xs(e,t){return js(e,t).length}function Zs(e,t){const a=e.ace.getSession().doc.getAllLines();let l=0,s=0;for(let i=0;i<a.length;i+=1)if(s+=a[i].length+1,t<=s){l=i;break}return l}function ei(e,t,a){const l=e.ace.getSession().doc.getAllLines();let s=0;for(let i=0;i<l.length;i+=1){s+=l[i].length+1;let e=s;if(a&&(e-=1),t===e)break}return ei}function ti(e){e.gutterHeight=document.getElementById(e.options.classes.gutterID).clientHeight,e.gutterWidth=document.getElementById(e.options.classes.gutterID).clientWidth;const t=ai(e,qs.EDITOR_LEFT),a=ai(e,qs.EDITOR_RIGHT),l=Math.max(t,a,e.gutterHeight);e.gutterSVG=document.createElementNS(qs.SVG_NS,"svg"),e.gutterSVG.setAttribute("width",e.gutterWidth),e.gutterSVG.setAttribute("height",l),document.getElementById(e.options.classes.gutterID).appendChild(e.gutterSVG)}function ai(e,t){return(t===qs.EDITOR_LEFT?e.editors.left:e.editors.right).ace.getSession().getLength()*e.lineHeight}function li(e){!function(e){document.getElementById(e.options.classes.gutterID).removeChild(e.gutterSVG),ti(e)}(e),function(e){e.copyLeftContainer.innerHTML="",e.copyRightContainer.innerHTML=""}(e),e.diffs.forEach((t,a)=>{e.options.showDiffs&&(Ws(e,qs.EDITOR_LEFT,t.leftStartLine,t.leftEndLine,e.options.classes.diff),Ws(e,qs.EDITOR_RIGHT,t.rightStartLine,t.rightEndLine,e.options.classes.diff),e.options.showConnectors&&function(e,t,a,l,s){const i=e.editors.left.ace.getSession().getScrollTop(),n=e.editors.right.ace.getSession().getScrollTop();e.connectorYOffset=1;const o=t*e.lineHeight-i+.5,r=e.gutterWidth+1,c=l*e.lineHeight-n+.5,u=a*e.lineHeight-i+e.connectorYOffset+.5,p=e.gutterWidth+1,d=s*e.lineHeight-n+e.connectorYOffset+.5,m=Rs(-1,o,r,c),h=Rs(p,d,-1,u),f="L".concat(r,",").concat(c," ").concat(p,",").concat(d),v="L".concat(-1,",").concat(u," ").concat(-1,",").concat(o),g="".concat(m," ").concat(f," ").concat(h," ").concat(v),y=document.createElementNS(qs.SVG_NS,"path");y.setAttribute("d",g),y.setAttribute("class",e.options.classes.connector),e.gutterSVG.appendChild(y)}(e,t.leftStartLine,t.leftEndLine,t.rightStartLine,t.rightEndLine),function(e,t,a){if(t.leftEndLine>t.leftStartLine&&e.options.left.copyLinkEnabled){const l=Vs({className:e.options.classes.newCodeConnectorLink,topOffset:t.leftStartLine*e.lineHeight,tooltip:"Copy to right",diffIndex:a,arrowContent:e.options.classes.newCodeConnectorLinkContent});e.copyRightContainer.appendChild(l)}if(t.rightEndLine>t.rightStartLine&&e.options.right.copyLinkEnabled){const l=Vs({className:e.options.classes.deletedCodeConnectorLink,topOffset:t.rightStartLine*e.lineHeight,tooltip:"Copy to left",diffIndex:a,arrowContent:e.options.classes.deletedCodeConnectorLinkContent});e.copyLeftContainer.appendChild(l)}}(e,t,a))},e)}const si=Ht(Bs),ii=d(),ni=Ne("");let oi=Ne([]);const ri=Ne(null),ci=Ne(null),ui=Ne([]),pi=Ne(!1),di=Ne(!0),mi=Ne(null),hi=Ne(null),fi=Ne(null),vi=()=>{ri.value=null,ci.value=null,pi.value=!1},gi=async(e,t,a)=>{let l={p:1,showRow:500,sort:"name",reverse:"False",path:e,search:t||""};a&&(l.all=a);try{const{data:e}=await Cl(l),t=[],a=[];return e.dir.forEach(a=>{t.push(uc("dir",a,void 0,e.path))}),e.files.forEach(t=>{a.push(uc("file",t,void 0,e.path))}),[...t,...a]}catch(s){return[]}},yi=async(e,t,a)=>{if(e.data.isNew)return t([]);const l=pn(ji.id||"");if(ui.value=ui.value.filter(e=>".Recycle_bin"!==e),".Recycle_bin"===e.data.fileName)return ii.error("此为回收站目录，请在右上角按【回收站】按钮打开"),void t([]);if(0===e.level){const e=((null==l?void 0:l.path)||a.path).split("/");e.pop();const s=await gi(e.join("/")||"/www");return oi.value=s,t(s)}if(e.level>0){return t(await gi(e.data.path))}return e.upper?t(e.upper):void 0},bi=async()=>{ui.value.length=0;const e=ni.value;if("/"===e)return void ii.error("已经是根目录了");const t=e.split("/");t.pop();let a=t.join("/");a||(a="/"),ni.value=a;const l=await gi(a);oi.value=l,vi()},_i=async(e,t,a)=>{var l,s;ci.value||(ri.value=t),e.isFile&&((null==(l=null==e?void 0:e.path)?void 0:l.includes("/dev/pts"))?ii.error("系统目录文件不支持编辑"):"text"===Ar(null==(s=e.fileName)?void 0:s.split(".").pop())?qr(e):ii.error("暂不支持该类型文件编辑"))},wi=(e,t,a)=>{e.preventDefault(),e.stopPropagation(),ci.value=t||null,a.value.show(e),pi.value=!1},Si=async e=>{const t=await gi(ni.value,null!=e?e:"");oi.value=t,vi()},ki=(e,t,a)=>{const l=a.value.getNode(t);if(l)if(l.childNodes&&l.childNodes.length>0){const t=l.childNodes[0];a.value.insertBefore(e,t.data)}else a.value.append(e,l.data);else a.value.data.unshift(e),a.value.updateKeyChildren(null,a.value.data);Oe(()=>{setTimeout(()=>{var e,t,a,l;null==(t=null==(e=fi.value)?void 0:e.$el)||t.focus(),a=fi,l=hi,Oe(()=>{var e;const t=null==(e=a.value)?void 0:e.$el,s=l.value;if(t&&s){const e=t.getBoundingClientRect(),a=s.getBoundingClientRect();(e.top<a.top||e.bottom>a.bottom)&&(s.scrollTop+=e.top-a.top-(s.clientHeight/2-e.height/2))}})},100)}),vi()},Ti=async()=>{try{ui.value.length=0,vi(),await Si(),ii.success("刷新成功")}catch(e){p(e)}},Li=({data:{path:e,isFile:t}})=>t?e.replace(/\/[^\/]*$/,""):e,Ei=e=>{const t=ri.value,a=ci.value?ci.value.path:t?Li(t):ni.value,l=t?(e=>e.data.isFile?Li(e):e.data.path)(t):null,s={icon:"icon-".concat(e),ext:"",fileName:"",time:"",ps:"",size:0,type:e,user:"root",rootLevel:"0",isLink:"",isShare:!1,isTop:!1,isFav:!1,isOsPs:!1,isSearch:!1,isReName:!0,isNew:!0,isSync:"",isLock:!1,path:"".concat(a,"/"),tamperProofId:0,isFile:"dir"!==e};return pi.value=!0,{newFile:s,dataPathFileName:l}},xi=()=>{ui.value.length=0},Ci=je({__name:"index",props:{rowData:{type:Object,default:()=>({})},refreshData:{type:Function,default:()=>{}},value:{type:Object,default:()=>({})}},emits:["update:value"],setup(e,{expose:t,emit:a}){const l=d(),s=e,i=a,n=Ne(s.rowData);let o="";const r=(e,t)=>{const a=e.match(/^(.*\/)/),l=a?a[1]:"";return"".concat(l).concat(t)},c=e=>{e.stopPropagation(),e.preventDefault(),n.value.fileName=e.target.value,f({row:n.value})},u=()=>{f({row:n.value})},p=()=>{var e;if(n.value.isReName=!1,n.value.isNew){const t=mi.value.getNode(null==(e=n.value)?void 0:e.path);mi.value.remove(t.data)}pi.value=!1},f=async({row:e})=>{if(""!==e.fileName)if(yr(e.fileName))l.error('文件名不能包含以下字符：\\ / : * ? " < > |');else if(e.isNew){const t="".concat(e.path,"/").concat(e.fileName);await m({loading:"正在新建文件，请稍候...",request:Il({path:t.replace(/\/\//g,"/"),type:e.type}),message:!0,success:t=>{t.status&&(e.isReName=!1,pi.value=!1,s.refreshData())}})}else{if(e.fileName===o)return void l.error("文件名没有变化");await m({loading:"正在重命名，请稍候...",request:Dl({sfile:r(e.path,o),dfile:r(e.path,e.fileName),rename:!0}),message:!0,success:t=>{t.status&&(e.isReName=!1,pi.value=!1,s.refreshData())}})}else l.error("文件名不能为空")};return Ae(()=>s.rowData,()=>{s.rowData&&(n.value=s.rowData,i("update:value",n.value))},{immediate:!0}),Ve(()=>{n.value.isReName&&Oe(()=>{o=n.value.fileName}),pi.value=n.value.isReName}),t({reNameInputRef:fi}),(e,t)=>{const a=h,l=ze("focus");return Me((He(),Be("div",{class:"flex items-center !w-[100%] pr-[.5rem]",onClick:t[2]||(t[2]=Ge(()=>{},["stop"]))},[Me(De(a,{ref_key:"reNameInputRef",ref:fi,class:"rename-input h-[20px] ml-2px",width:"auto",modelValue:n.value.fileName,"onUpdate:modelValue":t[0]||(t[0]=e=>n.value.fileName=e),onKeydown:t[1]||(t[1]=Ue(Ge(()=>{},["stop"]),["native"])),onKeyup:Ue(c,["enter","native"])},null,8,["modelValue"]),[[l]]),Je("span",{class:"svgtofont-el-select ml-[.5rem] !text-extraLarge font-800",style:{color:"#20a53a"},onClick:Ge(u,["stop"])}),Je("span",{class:"svgtofont-el-close-bold ml-[.5rem] !text-extraLarge font-800",style:{color:"#f34a4a"},onClick:Ge(p,["stop"])})],512)),[[qe,n.value.isReName]])}}}),Di=We("FILES-ACE-STORE",()=>{const{routerActive:e,mainHeight:t}=l(),a=gc(),{bindKeydown:s}=a,i=Ne(),n=Ne(),o=Ne(!0),c=Ne(!0),u=async()=>{xi(),Yi();const e=await n.value;null==e||e.unmount()},p=Ne([{title:"保存",icon:"svgtofont-el-select",click:()=>{d()&&In(ji)}},{title:"全部保存",icon:"svgtofont-icon-minmax-black",click:()=>{d()&&Rn()}},{title:"刷新",icon:"svgtofont-el-refresh-right",click:async()=>{d()&&wn(ji,!0)}},{title:"搜索",icon:"svgtofont-el-search",click:()=>{d()&&Ni.value.execCommand("find")}},{title:"替换",icon:"svgtofont-icon-log",click:()=>{d()&&Ni.value.execCommand("replace")}},{title:"跳转行",icon:"svgtofont-icon-login-address",click:()=>{d()&&N("jump")}},{title:"字体大小",icon:"svgtofont-left-xterm",click:()=>{d()&&N("font")}},{title:"主题",icon:"svgtofont-icon-drag",click:()=>{d()&&N("theme")}},{title:"设置",icon:"svgtofont-left-config",click:()=>{d()&&N("set")}},{title:"快捷键",icon:"svgtofont-el-question-filled",click:()=>{const e=zi.value.find(e=>"快捷键"===e.title);if(e)return Tn(e.id),void N("shortcutKey");_n({type:"custom",title:"快捷键",component:$e(()=>f(()=>import("./index150.js?v=1764728423"),__vite__mapDeps([]),import.meta.url))})}}]),d=()=>!(!mn()||"custom"===ji.type)||(r.error("当前页面不支持该操作"),!1),h=Ne(0),g=Ne(!1),y=Ne(null),b=Ne(""),_=Ne("btn"),w=Ne(!1),S=Ne(""),k=Ne([]),T=Ne(""),L=Ne(null),E=Ne(null);let x=Ne();const C=e=>{const t=mi.value.getNode(e);t&&e.isNew&&mi.value.remove(t),t&&e.isReName&&(e.isReName=!1),pi.value=!1},D=(e,t)=>{C(x.value),wi(e,t,E)},I=e=>zi.value.some(t=>t.path===e.path)?"text-[#cca700]":"",P=Ne(),F=Ne(),R=Ne(!1),N=e=>{Ai.value=e,R.value=""!==e,e&&window.addEventListener("click",O)},O=()=>{Ai.value="",window.removeEventListener("click",O)},j=Ne(null),A=Ne(null),V=Ne({}),z=(e,t)=>{if(Tn(e),t){const e=t.currentTarget||t.currentTarget,a=j.value,l=a.offsetWidth,s=e.offsetLeft-l/2+e.offsetWidth/2;a.scroll({left:s,behavior:"smooth"})}},M=e=>{e.preventDefault();const{deltaY:t}=e;j.value.scrollLeft+=t},{fontSize:q,tabSize:H,editorTheme:B,useSoftTabs:U}=Ye(Fi.aceEditor),G=Ne(ji.encoding),J=Ne(0),W=Ke({line:123,column:321,historys:[],tabsData:{type:"nbsp",number:4},encoding:"utf-8",only_read:!1,mode:"text"}),$=e=>{e&&(W.tabsData.number=e.tabSize,W.tabsData.type=e.useSoftTabs?"tab":"nbsp")},Y=Ne(),K=e=>{zi.value=zi.value.filter(t=>t.id===e),Ri.value=Ri.value.filter(t=>t.id===e),bn(e);const t=on(e);Ni.value.setSession(t),gn(Ni.value),fn(Y.value.item.isReadOnly),vn()},Q=()=>{zi.value.forEach(e=>{const t=on(e.id);t&&t.destroy()}),zi.value=[],Ri.value=[],Ni.value.setSession(null)};return{instance:n,fileItem:i,routerActive:e,btnShow:o,catalogueShow:c,onLeave:()=>{o.value=!1,setTimeout(()=>{o.value=!0},500)},close:u,onCancel:async()=>{var e;return await Nn()?(document.querySelector(".bt-dialog-header .svgtofont-icon-minmax-black")&&(null==(e=document.querySelector(".bt-dialog-header .svgtofont-icon-minmax-black"))||e.click()),fr(u),!1):(localStorage.removeItem("aceEditor"),xn(),u(),!1)},column:p,openPopup:e=>{mn?e.click():r.error("当前页面不支持该操作")},mainHeight:t,operSize:h,changeOpertion:e=>{h.value="search"===e?76:0},isShow:g,inputRef:y,inputFocus:()=>{g.value=!0,Oe(()=>{var e;null==(e=y.value)||e.focus()})},originalPath:b,changeCurrentPath:async()=>{try{if(g.value=!1,ni.value!==b.value){b.value=ni.value;const{data:e}=await m({request:Cl({p:1,showRow:500,sort:"name",reverse:"False",path:ni.value})}),t=e.dir.map(t=>uc("dir",t,void 0,e.path)),a=e.files.map(t=>uc("file",t,void 0,e.path));oi.value=[...t,...a],ni.value=e.path}}catch(e){}},type:_,isCheck:w,searchValue:S,changeValue:e=>{ui.value.length=0,S.value="","search"===e?(k.value=oi.value,T.value=ni.value,oi.value=[],di.value=!0):(oi.value=k.value,""===ni.value&&(b.value=T.value),ni.value=T.value)},searchFile:async()=>{const e=await gi(ni.value,S.value,w.value?"True":void 0);di.value=!1,e&&(oi.value=e,vi())},handleCommand:e=>{var t,a;const{newFile:l,dataPathFileName:s}=Ei(e),i=s||((null==(t=ci.value)?void 0:t.isFile)||null==(a=ci.value)?void 0:a.path);if(i){const e=mi.value.getNode(i);e&&(e.expanded=!0)}ki(l,i,mi)},closeSearch:()=>{_.value="btn",vi()},contextRef:E,treeProps:{label:"fileName",key:"path",isLeaf:"isFile"},initSidebarList:()=>{Oe(()=>{const e=(i.value.path||"/www").split("/");e.pop(),""===ni.value&&(b.value=e.join("/")),ni.value=e.join("/")})},loadNode:async(e,t,...a)=>{yi(e,t,i.value)},renderTree:(e,{node:t,data:a,store:l})=>{const{mode:s}=un(a.fileName);return De("span",{class:"flex flex-1 items-center w-full ".concat(a.isReName?"newFiles":"defaultFiles"),onContextmenu:e=>{e.preventDefault(),D(e,a)}},[De("span",{class:"icon-editor-left ".concat(a.isFile?"ace-".concat(s,"-icon ace-text-icon"):"ace-folder-icon")},null),a.isReName?De(Ci,{class:"el-tree-node__label",title:a.fileName,rowData:a,refreshData:Si,modelValue:x,"onUpdate:modelValue":e=>x=e,ref:L},null):De("span",{class:"el-tree-node__label ".concat(I(a)),title:a.fileName},[a.fileName])])},handleExpandChange:e=>{(null==e?void 0:e.path)&&!ui.value.includes(e.path)&&ui.value.push(e.path)},handleCollapseChange:e=>{const t=ui.value.indexOf(null==e?void 0:e.path);-1!==t&&ui.value.splice(t,1),C(x.value)},editorRef:P,editorDiffRef:F,showToolbar:R,watchEditorCustomToolbar:N,closeToolbar:O,initContent:async()=>{await(async e=>{await Qi(),Ni.value=await en(e),$(Fi.aceEditor)})(P.value),i.value&&await _n({title:i.value.fileName,type:i.value.type||"editor",path:i.value.path,size:i.value.size}),(async e=>{tn(e)})(F.value),await vs({name:i.value.fileName,path:i.value.path}),await $i()},resizeEditor:()=>{Ni.value&&Oe(()=>{Ni.value.resize()})},tabsElement:j,contextmenu:A,headerRightRow:V,changeTab:z,getDataChangeTab:()=>{Oe(()=>{var e;const t=zi.value[zi.value.length-1],a=null==(e=j.value)?void 0:e.children[zi.value.length-1];z(t.id,{currentTarget:a})})},closeTab:async e=>{Sn(e)},openContextMenu:e=>{A.value.show(e),V.value=ji},initContentHeader:()=>{Oe(()=>{j.value.addEventListener("wheel",M)})},$resetContentHeader:()=>{j.value&&j.value.removeEventListener("wheel",M)},fontSize:q,tabSize:H,editorTheme:B,useSoftTabs:U,encodingData:G,line:J,tool:[{title:"跳转到指定行",type:"jump"},{title:"设置编辑器字体大小",type:"font"},{title:"设置编辑器主题",type:"theme"},{title:"编辑器设置",type:"set"},{title:"设置文件保存编码格式",type:"encode"},{title:"设置文件保存空格设置",type:"encode"},{title:"设置文件保存行结束符",type:"lineBreak"}],set:[{title:"自动换行",type:"wrap"},{title:"代码自动完成",type:"enableLiveAutocompletion"},{title:"启用代码段",type:"enableSnippets"},{title:"显示隐藏字符",type:"showInvisibles"},{title:"显示行号",type:"showLineNumbers"}],tabData:[{title:"使用空格缩进",type:"nbsp"},{title:"使用制表符缩进",type:"tab"}],unTitleArr:["shortcutKey","","tab"],saveFont:()=>{Fi.aceEditor.fontSize>45||Fi.aceEditor.fontSize<12?r.error("字体设置范围超过12-45"):(Ni.value.setFontSize(Fi.aceEditor.fontSize),Xi())},jumpLine:()=>{J.value%1==0?Ni.value.gotoLine(J.value):r.error("请输入整数")},setCode:async e=>{ji.state=1,ji.encoding=e,await Xi(),await In(ji),G.value=e},setTabType:e=>{"string"==typeof e?(U.value="tab"===e,Fi.aceEditor.useSoftTabs="tab"===e):(H.value=e,Fi.aceEditor.tabSize=e),Xi()},setTheme:e=>{B.value=e,Ni.value.setTheme("ace/theme/"+e),Fi.aceEditor.editorTheme=e,Xi()},seting:e=>{Fi.aceEditor[e]=!Fi.aceEditor[e],Ni.value.setOption(e,Fi.aceEditor[e]),Xi(),$(Fi.aceEditor)},fileInfo:W,openHistory:()=>{v({title:"文件历史版本",area:55,component:()=>f(()=>import("./index151.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),compData:{editorTabsActive:ji,callback:()=>{wn(ji,!0)}}})},watchAceEditor:$,diffReHistory:async()=>{await Gi(Hi.value),await wn(Hi.value,!0),Hi.value={}},onConfirmCheckFile:async e=>{await Rn(),localStorage.removeItem("aceEditor"),xn(),e&&e()},onCancelCheckFile:e=>{localStorage.removeItem("aceEditor"),xn(),e&&e.onUnmount&&e.onUnmount()},compDataClose:Y,onConfirmClose:async()=>{try{switch(Y.value.type){case"close":await In(Y.value.item),Sn(Y.value.item);break;case"other":const e=Y.value.item.id,t=zi.value.filter(t=>t.id!==e&&1===t.state);t.length>0&&await Promise.all(t.map(e=>In(e))),K(e);break;case"all":await Rn(),Q()}}catch(e){}return!0},onCancelClose:e=>{switch(Y.value.type){case"close":Y.value.item.state=0,Sn(Y.value.item);break;case"other":K(Y.value.item.id);break;case"all":Q()}e&&e.onUnmount&&e.onUnmount()},init:()=>{window.addEventListener("keydown",Ui)},$reset:()=>{window.removeEventListener("keydown",Ui),s()}}}),Ii=d(),Pi="/www/server/panel/BTPanel/static/editor/ace.editor.config.json",Fi=Ke({supportedModes:{},nameOverrides:{},encodingList:[],themeList:[],aceEditor:{fontFamily:"Monaco, Menlo, 'Courier New', monospace",editorTheme:"monokai",fontSize:14,softLabel:!0,useSoftTabs:!0,tabSize:4,wrap:!0,enableSnippets:!0,enableLiveAutocompletion:!0,highlightActiveLine:!0,highlightSelectedWord:!0,animatedScroll:!0,showInvisibles:!1,showFoldWidgets:!0,showLineNumbers:!0,showGutter:!0,displayIndentGuides:!0}}),Ri=Qe([]),Ni=Qe(null),Oi=Qe(null),ji=Xe({id:"",type:"editor",title:"",path:"",mode:"",modeText:"",isReadOnly:!1,stTime:0,state:0,encoding:"UTF-8",historys:[],lineBreak:"LF"}),Ai=Qe(""),Vi=Xe({row:1,column:0,count:1}),zi=Ne([]),Mi=()=>window.ace,qi=()=>si,Hi=Ne(),Bi=Ne(null),Ui=e=>{if("F5"===e.key||"r"===e.key&&(e.metaKey||e.ctrlKey))return e.preventDefault(),void Ii.msg({customClass:"no-icon",message:"编辑器模式下无法刷新网页，请关闭后重试",type:"info",duration:3e3})},Gi=async e=>{try{await o({title:"恢复历史文件",width:"35rem",content:"是否恢复历史文件 ".concat(n(Number(e.st_mtime)),"?恢复历史文件后，当前文件内容将会被替换！")});const t=await y({filename:e.path,history:e.st_mtime});if(t.status){Ii.success("恢复成功");const t=dn(ji.id);zi.value.splice(t,1),wn(e)}else Ii.request(t)}catch(t){}},Ji=async e=>{var t;if(document.querySelector(".bt-dialog-header .svgtofont-icon-minmax-black"))return null==(t=document.querySelector(".bt-dialog-header .svgtofont-icon-minmax-black"))||t.click(),void(e&&_n(e))},Wi=async()=>{Bi.value=await Ii.load("正在获取文件内容，请稍候...")},$i=async()=>{Bi.value&&Bi.value.close()},Yi=()=>{zi.value.some(e=>1===e.state)||(window.onbeforeunload=null)},Ki=async(e,t)=>{let a=Ii.load("正在加载，请稍候...");try{const{data:a}=await Cn(e,"reverse",t);return a}catch(l){}finally{a&&a.close()}},Qi=async()=>{const e=sessionStorage.getItem("aceConfig");let t={};e&&(t=JSON.parse(e));const{data:a}=await Cn(Pi);(null==a?void 0:a.data)&&(t=JSON.parse(a.data),sessionStorage.setItem("aceConfig",JSON.stringify(t))),Fi.supportedModes=t.supportedModes||{Apache_Conf:["^htaccess|^htgroups|^htpasswd|^conf|htaccess|htgroups|htpasswd"],CSS:["css"],HTML:["html|htm|xhtml|vue|we|wpy"],Java:["java"],JavaScript:["js|jsm|jsx"],JSON:["json"],JSP:["jsp"],Makefile:["^Makefile|^GNUmakefile|^makefile|^OCamlMakefile|make"],Markdown:["md|markdown"],MySQL:["mysql"],Nginx:["nginx|conf"],PHP:["php|inc|phtml|shtml|php3|php4|php5|phps|phpt|aw|ctp|module"],Powershell:["ps1"],Python:["py"],SQL:["sql"],SQLServer:["sqlserver"],Text:["txt"],XML:["xml|rdf|rss|wsdl|xslt|atom|mathml|mml|xul|xbl|xaml"],YAML:["yaml|yml"],images:["icon|jpg|jpeg|png|bmp|gif|tif|emf"]},Fi.nameOverrides=t.nameOverrides||{PHP_Laravel_blade:"PHP (Blade Template)"},Fi.encodingList=t.encodingList||["ASCII","UTF-8","GBK","GB2312","BIG5"],Fi.themeList=t.themeList||["chrome","monokai","tomorrow_night_bright"],Fi.aceEditor=t.aceEditor||{editorTheme:"monokai",fontSize:14,softLabel:!1,useSoftTabs:!0,tabSize:4,wrap:!0,enableSnippets:!0,enableLiveAutocompletion:!0,highlightActiveLine:!0,highlightSelectedWord:!0,animatedScroll:!1,showInvisibles:!0,showFoldWidgets:!0,showLineNumbers:!0,showGutter:!0,displayIndentGuides:!1},Fi.aceEditor.fontFamily="12px/normal 'Consolas', 'Menlo', 'Monaco', 'Ubuntu Mono', 'source-code-pro', 'Courier New', monospace"},Xi=async()=>{const e=JSON.stringify(Fi);return await Dn({data:e,path:Pi,force:1})},Zi=()=>Fi.aceEditor,en=async e=>{const t=Mi(),{editorTheme:a,fontSize:l,fontFamily:s,showInvisibles:i,useSoftTabs:n,tabSize:o,keyboardHandler:r,enableLiveAutocompletion:c,enableSnippets:u,enableBasicAutocompletion:p}=Zi();t.config.set("basePath","/static/editor"),t.require("/ace/ext/language_tools");const d=t.edit(e,{theme:"ace/theme/".concat(a),fontSize:l,fontFamily:s,showInvisibles:i,useSoftTabs:n,tabSize:o,showPrintMargin:!1,keyboardHandler:r,enableLiveAutocompletion:c,enableSnippets:u,enableBasicAutocompletion:p});return En(d),d},tn=e=>{Oi.value=e},an=async e=>{const{editorTheme:t}=Zi(),{theme:a="ace/theme/".concat(t),mode:l="",left:s={},right:i={}}=e,n={element:Oi.value,theme:a,mode:l,left:{content:"",editable:!1,copyLinkEnabled:!1,...s},right:{content:"",editable:!1,copyLinkEnabled:!1,...i}};return ln(n),n},ln=e=>new(qi())(e),sn=(e,t)=>{const a=Mi(),{wrap:l}=Zi(),s=a.createEditSession(t,"ace/mode/".concat(e));return s.setOptions({wrap:l,readOnly:!1}),Ln(s),s},nn=e=>{Ni.value.setSession(e)},on=e=>{var t;return e?null==(t=Ri.value.find(t=>t.id===e))?void 0:t.session:Ni.value.getSession()},rn=e=>e?Ri.value.find(t=>t.id===e):Ni.value.getSession(),cn=e=>e?Ri.value.findIndex(t=>t.id===e):-1,un=e=>{let t=e.match(/\.([0-9A-z]*)$/);t=Array.isArray(t)?t[1]:"text";for(let i in Fi.supportedModes)for(var a=Fi.supportedModes[i][0].split("|"),l=i.toLowerCase(),s=0;s<a.length;s++)if(t.toLowerCase()==a[s].toLowerCase())return{name:i,mode:l};return{name:"Text",mode:"text"}},pn=e=>zi.value.find(t=>t.id===e),dn=e=>zi.value.findIndex(t=>t.id===e),mn=()=>zi.value.length>0,hn=(e,t)=>{const{getDataChangeTab:a}=Di();delete e.session;const l={id:"",type:"editor",title:"",path:"",mode:"",modeText:"",isReadOnly:!1,stTime:0,state:0,...e};return zi.value.push(l),a(),"editor"===e.type&&t&&Ri.value.push({id:l.id,session:t}),l},fn=(e=!1)=>{Ni.value.setReadOnly(e)},vn=()=>{Ni.value.focus()},gn=e=>{Vi.count=e.session.getLength()},yn=e=>zi.value.filter(t=>t.path===e),bn=async e=>{const t=pn(e);t&&(ji.id=e,ji.type=t.type,ji.title=t.title,"editor"===t.type?(ji.path=t.path,ji.mode=t.mode,ji.modeText=t.modeText,ji.isReadOnly=t.isReadOnly,ji.stTime=t.stTime,ji.state=t.state,ji.encoding=t.encoding,ji.historys=t.historys,ji.next=t.next,ji.pagination=t.pagination,ji.lineBreak=t.lineBreak):ji.component=t.component)},_n=async e=>{var t;try{let a={};if("editor"===e.type){const l=yn(e.path);if(l.length)return Tn(l[0].id);const s=await Cn(e.path),{data:i,status:n,msg:o}=s;let r=i;if(n){o&&"success"!==o&&Ii.warn(o),e.size>3145728&&Ii.warn("抱歉！文件大小超过3M，暂不支持在线编辑！");const l=e.filename||(null==(t=e.path)?void 0:t.split("/").pop());let s="";const{mode:i,name:n}=un(l);s=i,e.mode&&(s=e.mode);const c=An(r.data),u=sn(s,r.data);a=hn({id:g(10),path:e.path,type:"editor",title:l,mode:s,modeText:n,state:0,encoding:r.encoding,stTime:Number(r.st_mtime),isReadOnly:r.only_read,historys:r.historys||[],next:(null==r?void 0:r.next)||!1,pagination:1,lineBreak:c},u),nn(u),fn(r.only_read)}else Ii.error(o)}else a=hn({...e,id:g(10),state:0});bn(a.id)}catch(a){}},wn=async(e,t=!1)=>{if("editor"!==e.type)return;const a=Ii.load("获取文件内容中，请稍候...");try{const a=pn(e.id||""),{data:l}=await Cn(e.path);t&&Ni.value.session.setValue(l.data),a.stTime=Number(l.st_mtime),a.encoding=l.encoding,a.state=0,ji.state=0,a.isReadOnly=l.only_read,a.historys=l.historys||[],Ii.msg({message:"文件内容已更新！",type:"success"}),bn(a.id)}catch(l){}finally{a&&a.close()}},Sn=e=>{const{id:t}=e,a=dn(t),l=zi.value[a]||null,s=on(t),i=cn(t);if(e.state)return kn(e);l&&"editor"===l.type&&(null==s||s.destroy());if(zi.value.length>1){const e=zi.value[a+1]?a+1:a-1,t=zi.value[e].id;Tn(t,!0)}zi.value.splice(a,1),"editor"===l.type&&s&&(Ri.value[i].session.destroy(),Ri.value.splice(i,1))},kn=async e=>{try{vr("close",e)}catch(t){}},Tn=(e,t=!1)=>{var a;const l=dn(ji.id||""),s=dn(e),i=zi.value[s],n=rn(e);"editor"===i.type&&(ji.id===e&&t&&(null==(a=Ri.value[l])?void 0:a.session)&&(Ri.value[l].session=on()),n&&(nn(n.session),gn(n)),fn(i.isReadOnly),vn()),bn(e)},Ln=e=>{Vi.count=e.getLength(),e.on("change",()=>{const e=pn(ji.id||"");0===e.state&&(e.state=1,ji.state=1,window.onbeforeunload=function(){return"您有未保存的更改，确定要离开吗？"})}),e.selection.on("changeCursor",()=>{const t=Ni.value.getCursorPosition();Vi.count=e.getLength(),Vi.row=t.row+1,Vi.column=t.column}),e.on("changeScrollTop",Ze(async function(t){var a;const l=e.selection.session,s=l.getScrollTop(),i=l.getScreenLength()*Ni.value.renderer.lineHeight;if(s+Ni.value.renderer.$size.scrollerHeight>=i-100){const e=pn(ji.id);if(e.next){const t=await Ki(e.path,e.pagination);if(e.next=t.next,null==t?void 0:t.next){e.pagination&&e.pagination++;const l=null==(a=on(e.id))?void 0:a.getValue();Ni.value.session.setValue(l+t.data)}}}}),500)},En=e=>{const{watchEditorCustomToolbar:t}=Di();e.commands.addCommand({name:"saveFile",bindKey:{win:"Ctrl-S",mac:"Command-S"},exec:()=>{const e=pn(ji.id||"");In(e)}}),e.commands.addCommand({name:"saveAllFile",bindKey:{win:"Ctrl-Shift-S",mac:"Command-Shift-S"},exec:()=>{Rn()}}),e.commands.addCommand({name:"closeFile",bindKey:{win:"Ctrl-W",mac:"Command-W"},exec:()=>{Sn(ji.id)}}),e.commands.addCommand({name:"closeAllFile",bindKey:{win:"Ctrl-Shift-W",mac:"Command-Shift-W"},exec:()=>{zi.value.forEach(e=>{Sn(e.id)})}}),e.commands.addCommand({name:"goToLine",bindKey:{win:"Ctrl-I",mac:"Command-I"},exec:()=>{mn()&&"custom"!==ji.type?t("jump"):Ii.error("当前页面不支持该操作")},readonly:!1}),e.commands.addCommand({name:"undo",bindKey:{win:"Ctrl-Z",mac:"Command-Z"},exec:()=>{e.undo()}})},xn=()=>{Ni.value=null,ji.id="",ji.title="",ji.path="",ji.mode="",ji.modeText="",ji.isReadOnly=!1,ji.stTime=0,ji.state=0,ji.encoding="UTF-8",ji.historys=[],zi.value=[],Ri.value=[]},Cn=async(e,t,a)=>{let l={path:e,mode:t,p:a};return t||delete l.mode,a||delete l.p,await El(l)},Dn=async e=>{let t={path:e.path,data:e.data,encoding:e.encoding||"UTF-8",st_mtime:e.st_mtime,force:e.force||0,skip_conf_check:e.skip_conf_check||!1};return e.skip_conf_check||delete t.skip_conf_check,await b(t)},In=async(e,t=0,a=!1)=>{if(0===e.state)return Ii.msg({customClass:"no-icon",message:"文件未修改,无需保存！",type:"info"});const l=Ii.load("保存中，请稍候...");fn(!0);try{const l=on(e.id).getValue(),{path:s,encoding:i,stTime:n}=e,o={path:s,data:l,st_mtime:n,encoding:i,force:t};a&&(o.skip_conf_check=!0),e.state=3;const r=await Dn(o);if(!r.status)return(null==r?void 0:r.conf_check)?Fn(e,r.msg):Pn(e,r.msg);Ii.request(r),Yi(),await wn(e,!1)}catch(s){}finally{l&&l.close(),fn(!1)}},Pn=async(e,t)=>{const a=t.substr(0,t.length-1)+"，或选择强制保存。";e.state=1,await o({title:"提示",width:"35rem",icon:"warning",content:a}),await o({title:"是否强制保存",width:"35rem",icon:"warning",isHtml:!0,content:'<span style="color:#333">检测到文件已被修改，强制保存将会<span style="color:red">覆盖文件内容</span>，请谨慎操作!</span>'}),await In(e,1)},Fn=async(e,t)=>{const a=t.substr(0,t.length-1)+"，或选择强制保存。";e.state=1,await o({title:"提示",width:60,isHtml:!0,content:'<div class="custom-message-error-html">\n\t\t\t\t\t'.concat(a,'\n\t\t\t\t\t<div class="leading-[1.6rem] mt-1rem">请确认您要保存的配置文件内容无误与提示信息无关，注本次保存不会重载nginx/apache配置</div>\n\t\t\t\t</div>'),confirmText:"继续保存"}),await In(e,0,!0)},Rn=async()=>{const e=Ii.load("保存中，请稍候...");try{const e=[];for(let t=0;t<zi.value.length;t++){const a=zi.value[t];1===a.state&&e.push(In(a,0))}await Promise.all(e),Yi()}catch(t){}finally{e&&e.close()}},Nn=async()=>{let e=!1;return zi.value.length>0&&(e=zi.value.some(e=>1===e.state)),e},On=async e=>{const t=e.id;if(zi.value.filter(e=>e.id!==t&&1===e.state).length>0)vr("other",e);else{zi.value=zi.value.filter(e=>e.id===t),Ri.value=Ri.value.filter(e=>e.id===t),bn(t);const a=on(t);Ni.value.setSession(a),gn(Ni.value),fn(e.isReadOnly),vn()}},jn=async()=>{if(await Nn())try{vr("all")}catch(e){}else zi.value.forEach(e=>{const t=on(e.id);t&&t.destroy()}),zi.value=[],Ri.value=[],Ni.value.setSession(null)},An=e=>{if(!e)return"LF";return-1!==(e.length>2e4?e.substring(0,2e4):e).indexOf("\r\n")?"CRLF":"LF"},Vn=(e,t)=>{const a=pn(e);if(!a)return;if(a.lineBreak===t)return;const l="CRLF"===t?"CRLF":"LF",s="CRLF"===a.lineBreak?"CRLF":"LF";o({title:"更改行结束符",isHtml:!0,content:'<div class="custom-message-error-html">\n\t\t\t\t\t确定要将文件 "'.concat(a.title,'" 的行结束符从 ').concat(s,' 更改为<span style="color:red">').concat(l,'</span> 吗？\n\t\t\t\t\t<div class="leading-[1.6rem]">\n\t\t\t\t\t\t此操作将修改文件中所有的行结束符，并在<span style="color:red">保存</span>后生效。\n\t\t\t\t\t</div>\n\t\t\t\t</div>'),confirmText:"保存",cancelText:"取消",onConfirm:async()=>{try{const e=on(a.id);if(!e)return!0;let s=e.getValue();return"CRLF"===t&&"LF"===a.lineBreak?s=s.replace(/\n/g,"\r\n"):"LF"===t&&"CRLF"===a.lineBreak&&(s=s.replace(/\r\n/g,"\n")),e.setValue(s),a.lineBreak=t,0===a.state&&(a.state=1),await In(a),Ii.success("已将行结束符更改为 ".concat(l)),!0}catch(e){return Ii.error("更改行结束符失败"),!1}}}).catch(()=>{})},zn=()=>{Ri.value.forEach(e=>e.destroy()),Ri.value=[]},Mn=Object.freeze(Object.defineProperty({__proto__:null,editorCustomToolbar:Ai,editorDiffExample:Oi,editorExample:Ni,editorOption:Fi,editorRowColumnCount:Vi,editorSeesion:Ri,editorTabs:zi,editorTabsActive:ji,enableRefresh:Yi,handleKeyDown:Ui,handleScroll:Ki,minimizeEvent:Ji,reHistoryRow:Hi,recoverEvent:Gi,useAce:Mi,useCheckFileChange:Nn,useCheckFileCompatibility:e=>{const{mode:t}=un(e);return Fi.supportedModes[t]},useCheckTabsEmpty:mn,useCloseAllTabs:jn,useCloseOtherTabs:On,useCreateAceEditorExample:en,useCreateAceEditorSession:sn,useCreateDiffEditorExample:tn,useCreateDiffEditorView:ln,useCreateEditorTabs:_n,useCreateTabsItem:hn,useCutEditorTabs:Tn,useDestroyAllEditorSession:zn,useDestroyEditorData:xn,useDetectLineBreakType:An,useDiffAce:qi,useEditorLoading:Wi,useEditorPathFilter:yn,useEditorUnLoading:$i,useEventMount:En,useFindIndexTabs:dn,useFindTabsData:pn,useGetAceEditorSession:on,useGetAceEditorSessionData:rn,useGetAceEditorSessionIndex:cn,useGetAceOptions:Zi,useGetEditorOptions:Qi,useGetEditorTabsLineCount:gn,useGetFileBody:Cn,useGetFileMode:un,useInsertAceEditorSession:nn,useMonitorMount:Ln,useRandomId:()=>g(10),useRefreshFileContent:wn,useRemoveEditorCheckTabs:kn,useRemoveEditorTabs:Sn,useSaveAllFiles:Rn,useSaveEditorOptions:Xi,useSaveFileBody:Dn,useSaveFiles:In,useSetDiffEditorOptions:an,useSetEditorTabsActive:bn,useSetEditorTabsFocus:vn,useSetEditorTabsReadOnly:fn,useSetLineBreak:Vn,useforcedSaveConfig:Fn},Symbol.toStringTag,{value:"Module"})),qn=We("FILES-BATCH-SET-AUTH-STORE",()=>{const e=gc(),{fileTabActiveData:t}=et(e),{refreshFilesList:a}=e,l=Ne([]),s=Ke({owner:[],group:[],public:[],auth:0,user:"root",isDir:!0,checkNumber:""}),i=e=>{256&(e=parseInt(e.toString(),8))?s.owner.push("r"):s.owner=s.owner.filter(e=>"r"!==e),128&e?s.owner.push("w"):s.owner=s.owner.filter(e=>"w"!==e),64&e?s.owner.push("x"):s.owner=s.owner.filter(e=>"x"!==e),32&e?s.group.push("r"):s.group=s.group.filter(e=>"r"!==e),16&e?s.group.push("w"):s.group=s.group.filter(e=>"w"!==e),8&e?s.group.push("x"):s.group=s.group.filter(e=>"x"!==e),4&e?s.public.push("r"):s.public=s.public.filter(e=>"r"!==e),2&e?s.public.push("w"):s.public=s.public.filter(e=>"w"!==e),1&e?s.public.push("x"):s.public=s.public.filter(e=>"x"!==e),s.owner=Array.from(new Set(s.owner)),s.group=Array.from(new Set(s.group)),s.public=Array.from(new Set(s.public))};return{checkList:s,fileList:l,ownerOptions:[{label:"root",value:"root"},{label:"www",value:"www"},{label:"mysql",value:"mysql"}],reversePermission:()=>{let e=0;const t=(t,a,l,s)=>{t.includes("r")&&(e|=a),t.includes("w")&&(e|=l),t.includes("x")&&(e|=s)};for(t(s.owner,256,128,64),t(s.group,32,16,8),t(s.public,4,2,1),s.auth=e.toString(8);s.auth.length<3;)s.auth="0"+s.auth},checkNumber:e=>{s.checkNumber=e;const t=String(e).replace(/[^\d]/g,"").slice(0,3);s.auth=t,i(Number(s.auth))},changeUser:e=>{s.user=e},setFileAuths:async e=>{let i=s.auth.toString();if(i.length>3)r.error("请输入正确权限");else if(s.checkNumber.match(/\D/g))r.error("请输入正确权限");else if(i.match(/\D/g))r.error("请输入正确权限");else{for(;i.length<3;)i="0"+i;await m({loading:"正在设置文件权限，请稍后...",request:ds({user:s.user,access:i,all:s.isDir?"True":"False",type:"3",path:t.value.param.path,data:JSON.stringify(l.value)}),message:!0,success:t=>{t.status&&(a(),e&&e())}})}},getFileAuths:async()=>{await m({request:Kl({filename:"".concat(t.value.param.path)}),success:e=>{if(e.status){const t=e.data;s.auth=t.chmod,s.user=t.chown,i(Number(t.chmod))}else r.error(e.msg)}})},$reset:()=>{Object.assign(s,{owner:[],group:[],public:[],auth:0,user:"root",isDir:!0,checkNumber:""}),l.value=[]}}}),Hn=We("FILES-CLOUD-STORAGE-STORE",()=>{const e=gc(),{fileTabActiveData:t}=et(e),{refreshFilesList:l,getRealTask:s}=e,i=Ne(),o=Ne(),c=Ne(),u=Ne(!1),p=Ne([]),d=Ne(!0),h=Ne(""),f=Ne([]),v=Ne(""),g=Ne([]),y=Ne([]),b=Ne([zt({key:"name"}),{label:"文件名",prop:"name",width:"300",render:e=>De("span",{class:[null===e.type?"bt-open-dir folder-open-icon":"bt-open-dir file-text-icon"]},[De("i",{class:"icon"},null),De("span",{onClick:t=>{null===e.type&&w((""===v.value?"":v.value+"/")+e.name)}},[e.name])])},{label:"大小",prop:"size",render:e=>{let t=null!==e.size?_(Number(e.size)):"-";return null===e.type&&(t="-"),tt("span",t)}},{label:"更新时间",prop:"time",render:e=>""===e.type?"<span>"+n(e.time)+"</span>":"-"}]),w=e=>{v.value!==e&&(v.value=e,S())},S=async()=>{var e,t,l;try{u.value=!0;const s=await(l={path:v.value,pname:i.value.pname},a.post("/plugin?action=a&s=get_list&name=".concat(l.pname),{data:{path:l.path},check:"object",customType:"model"}));if(u.value=!1,!s.status)return L(),r.msg({message:"请先配置云存储",type:"warning"}),void Sp({name:i.value.pname});p.value=(null==(t=null==(e=s.data)?void 0:e.list)?void 0:t.sort((e,t)=>null===e.type?-1:null===t.type?1:0))||[],T(p.value),s.data.hasOwnProperty("path")&&k(s.data.path)}catch(s){}},k=e=>{let t="";v.value=e,g.value=[{title:"根目录",path:"",type:"dir"}],""!==e?(e&&"/"===e[e.length-1]&&(e=e.slice(0,-1)),e.split("/").forEach((e,a)=>{t+="/".concat(e).replace(/\/\//g,"/"),g.value.push({title:""===e&&0==a?"根目录":e,path:t,type:"dir"})}),f.value=g.value):f.value=g.value};Ne(!1);const T=e=>{Oe(()=>{const t=document.querySelectorAll(".oss-table .el-table__body-wrapper .el-checkbox");"down"===i.value.type?t.forEach((t,a)=>{null===e[a].type?t.style.display="none":t.style.display="block"}):t.forEach((e,t)=>{e.style.display="none"})})},L=async()=>{const e=await o.value;null==e||e.unmount()};return{compData:i,instance:o,ossTable:c,isTagMode:d,temporaryPath:h,showPathList:f,tableColumns:b,tableData:p,loading:u,handleSelectionChange:e=>{e.length>1?(c.value.getTable().clearSelection(),c.value.getTable().toggleRowSelection(e.pop())):y.value=e},temporaryBlur:()=>{d.value=!0,h.value=""},temporaryFocus:()=>{d.value=!1,h.value=v.value},temporaryEnter:e=>{var t;let a=null==(t=e.target)?void 0:t.value;a=a.replace(/\/+/g,"/"),"/"!==a&&(a=a.replace(/\/+$/g,"")),a!==h.value&&(v.value=a,S()),e.target.blur()},goBack:()=>{var e;1!==g.value.length&&(v.value=(null==(e=g.value[g.value.length-2])?void 0:e.path)||"/",S())},watchTableData:T,getDirList:S,filePathJump:w,onConfirm:async()=>{const{pname:e,type:a}=i.value;let n={};if("down"==a){if(0===y.value.length)return void r.error("请选择勾选需要下载的文件");n={name:e,url:y.value[0].download,path:t.value.param.path,filename:y.value[0].name}}else n={name:e,filename:i.value.rowData.path,object_name:v.value};return(await m({loading:"正在执行中，请稍后...",request:bs(n,a),message:!0,success:e=>{e.status&&(s(),l())}})).status},$reset:()=>{d.value=!0,h.value="",v.value="",p.value=[],f.value=[],g.value=[],y.value=[]}}}),Bn=We("FILES-COMPRESS-PREVIEW-STORE",()=>{const e=gc(),{fileTabActiveData:t}=et(e),{refreshFilesList:a}=e,l=Ne(""),s=Ne(),i=Ne();let n;const c=Ke({file:{data:{},path:"当前压缩包"},isDblclick:!1,addList:[]}),u=Ne(!1),p=Ne(!0),d=Ke({visible:!1,form:{filename:"",path:"/"}}),h=Ne(!1),f=Ne(!1),v=Ke({tableBatchData:[{label:"批量解压",value:"decompress",isRefBatch:!0,event:()=>{}},{label:"批量删除",value:"delete",isRefBatch:!0,event:()=>{}}],batchConfig:{isRecurrence:!1,describe:{title:"",th:"",message:"",propsValue:"name"},tableDisplayConfig:{label:"状态",prop:"status",render:e=>tt("span",{})}},decompressTableColumn:[{label:"文件名",prop:"filename"},{label:"大小",prop:"file_size",width:70,render:e=>tt("span",{},e.file_size?_(e.file_size):"--")}],selectList:[]}),g=Ne(),y=e=>{c.isDblclick=!0,e.date_time||(c.file.path="".concat(c.file.path,"/").concat(e.filename),setTimeout(()=>{c.isDblclick=!1},200))},b=e=>(e.shift(),e.join("/")),w=e=>{if(0===v.selectList.length){const t=e.findIndex(e=>e.filename===d.form.filename);return[e[t].uploadName]}return v.selectList.map(e=>e.uploadName)},S=e=>{let t=[];return Object.entries(e).forEach(([e,a])=>{if("object"==typeof a)if(a.is_dir)t.push("".concat(a.filename,"/"));else if(a.hasOwnProperty("fullpath"))t.push("".concat(a.fullpath));else{const e=S(a);t=t.concat(e)}}),t},k=async(e,t)=>{const a=c.file.path.split("/").filter(e=>""!==e);a.join("/").replace("当前压缩包/","").replace("当前压缩包","");const l=a.length>1?a.join("/").replace("当前压缩包/","")+"/":"";0===v.selectList.length&&await o({title:"删除文件【".concat(e.filename,"】"),content:"您真的要删除文件【".concat(e.filename,"】吗？")});let i=[],r=[];0!==e.is_dir&&0===v.selectList.length&&(i=S(e)),r=v.selectList.length>0?(()=>{let e=[];return v.selectList.forEach(t=>{if(t.uploadName.includes("/dddir")){const a=S(t);e=e.concat(a)}else t.is_dir?e.push("".concat(t.filename,"/")):e.push("".concat(t.fullpath))}),e})():[...i,"".concat(l).concat(e.filename).concat(0!==e.is_dir?"/":"")];const u={data:JSON.stringify({sfile:s.value.path,filenames:r})},p="zip"===s.value.ext?is:ns;h.value=!0;const d=await m({loading:"正在删除文件，请稍后...",request:p(u),message:!0,success:e=>{v.selectList=[],e.status&&(L(),f.value=!1)}});return n&&n(),h.value=!1,d.status},T=Ne([zt({key:"filename"}),{label:"名称",prop:"filename",render:e=>De("div",{class:"flex items-center cursor-pointer",onClick:t=>{e.date_time||(t.stopPropagation(),y(e))}},[De("img",{class:"mr-[.5rem] w-[2.5rem] h-[2.5rem]",src:"/static/images/file_icon/".concat(e.date_time?"file":"folder_win10",".png")},null),De("span",{class:"hover:text-primary"},[e.filename])])},{label:"大小",prop:"file_size",width:100,render:e=>tt("span",{class:"cursor-pointer"},e.file_size?_(e.file_size):"--")},{label:"修改时间",prop:"date_time",width:270,render:e=>tt("span",{class:"cursor-pointer"},e.date_time?e.date_time:"--")},Mt([{onClick:async(e,t,a)=>{var l;if(a.stopPropagation(),a.preventDefault(),"text"!==Ar(null==(l=e.fileName)?void 0:l.split(".").pop()))return void r.error("暂不支持该类型文件编辑");const i=c.file.path.split("/").filter(e=>""!==e),n={data:JSON.stringify({sfile:s.value.path,filename:(i.length>1?i.join("/").replace("当前压缩包/","")+"/":"")+e.filename})},o="zip"===s.value.ext?Zl:es,u=await m({loading:"正在获取文件，请稍后...",request:o(n)});u.status?rr(u.data,s.value,e.filename,i.length>1?i.join("/").replace("当前压缩包",""):""):r.request(u)},isHide:e=>{const t=e.filename.split(".").pop()||"file";return"text"!==Ar(t)||0!==e.is_dir},title:"编辑"},{onClick:async(e,a,l)=>{l.stopPropagation(),l.preventDefault(),Object.assign(d,{visible:!0,form:{filename:e.filename,path:t.value.param.path||"/"}})},title:"解压"},{onClick:k,title:"删除"}])]),L=async()=>{const e="zip"===s.value.ext?ql:Hl;await m({loading:u,request:e({data:JSON.stringify({sfile:s.value.path})}),success:async e=>{if(!e.status){r.request(e);const t=await i.value;null==t||t.unmount()}c.file.data=e.data,p.value&&(Oe(()=>{g.value.getTable().toggleAllSelection()}),p.value=!1)}})},E=[{label:"解压",value:"decompress",event:async(e,t,a,l,s)=>{v.selectList=a.value,Object.assign(d,{visible:!0,form:{filename:"",path:"/"}}),n=s}},{label:"删除",value:"delete",event:async(e,t,a,l,s)=>{v.selectList=a.value,f.value=!0,n=s}}];return{instance:i,compressData:c,deCompressPopupData:d,fileItem:s,tableColumn:T,loading:u,fileTableRef:g,batch:v,batchOptions:E,batchDeletePopup:f,delEvent:k,confirmDeCompress:async(e,t)=>{const l=JSON.parse(JSON.stringify(t)),i={data:JSON.stringify({zip_path:b(l),sfile:s.value.path,extract_path:d.form.path+"/",filenames:w(e)})},o="zip"===s.value.ext?ls:ss,c=await m({loading:"正在解压文件，请稍后...",request:o(i)});if(c.status){if(c.type)return dr(c.data,i,"zip"===s.value.ext?ls:ss),void(d.visible=!1);r.success("解压成功"),a()}else r.request(c);n&&n(),d.visible=!1},openPathDialog:()=>{qu({type:"dir",path:d.form.path,change:e=>{d.form.path=e}})},cellDblclick:y,goPath:e=>{const t=c.file.path.split("/").filter(e=>""!==e);let a="";for(let l=0;l<=e;l++)a+="/".concat(t[l]);c.file.path=a,"/当前压缩包"===a&&g.value.getTable().toggleAllSelection()},addFile:async()=>{qu({type:"file",path:d.form.path,change:async e=>{const t=c.file.path.split("/").slice(1).join("/").replace("当前压缩包","");u.value=!0,c.addList=[e];const a="zip"===s.value.ext?Ql:Xl;await m({loading:"正在添加文件，请稍后...",request:a({data:JSON.stringify({sfile:s.value.path,r_path:t?"/".concat(t):"",f_list:c.addList})}),message:!0,success:L}),u.value=!1}})},init:()=>{l.value=s.value.path||"",L(),d.form.path=t.value.param.path||"/"},$reset:()=>{p.value=!0,h.value=!1,f.value=!1,Object.assign(c,{file:{data:{},path:"当前压缩包"},isDblclick:!1,addList:[]})}}}),Un=We("FILES-CREATE-SYMBOLIC-LINK-STORE",()=>{const e=gc(),{refreshFilesList:t}=e,l=Ke({path:"",filename:"",disable:!1}),s=Ne(),i=Ke({path:[{validator:(e,t,a)=>{""===t?a(new Error("请选择正确的文件地址!")):a()},trigger:["blur","change"]}],filename:[{validator:(e,t,a)=>{""===t?a(new Error("请输入新文件名!")):yr(t)?a(new Error('文件名不能包含 /\\:*?"<>|符号!')):a()},trigger:["blur"]}]});return{quickFormRef:s,quickForm:l,quickRules:i,openFile:()=>{qu({type:"all",change:e=>{l.path=e}})},onConfirm:async e=>{try{const n={sfile:l.path,dfile:br(l.filename)};await s.value.validate(),l.disable=!0,await m({loading:"正在创建软链接...",request:(i=n,a.post("files/CreateLink",{data:i,check:"msg"})),message:!0,success:a=>{a.status&&(t(),e())}})}catch(n){}finally{l.disable=!1}var i},$reset:()=>{Object.assign(l,{path:"",filename:"",disable:!1})}}}),Gn=We("FILES-FAVORITES-MANAGE-STORE",()=>{const e=gc(),{favoriteList:t}=et(e),{refreshFilesList:a}=e,l=Ne(),s=Ne(t.value),i=Ke({loading:!1,data:[]}),n=Ne([{label:"路径",prop:"path"},Mt([{onClick:async e=>{if("dir"===e.type)wr(e.path);else{const t={...e,fileName:e.name,ext:e.ext||e.name.split(".").pop()};Ur(t)}const t=await l.value;null==t||t.unmount()},title:"打开"},{onClick:async e=>{await o({title:"删除收藏",content:"即将删除收藏路径【".concat(e.name,"】")}),m({loading:"正在删除收藏路径，请稍后...",request:Fl({path:e.path}),message:!0,success:e=>{e.status&&nc()}})},title:"删除"}])]);return{instance:l,tableColumn:n,favoriteList:t,favTableData:i,onCancel:()=>{s.value.length!==t.value.length&&a()},$reset:()=>{Object.assign(i,{loading:!1,data:[]})}}});function Jn(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!st(e)}const Wn=We("FILES-FORMAT-CONVERSION-STORE",()=>{const e=gc(),{fileTabActiveData:t}=et(e),{refreshFilesList:l}=e,s=Ne(),i=Ne(),o=Ne("conver"),c=Ne("执行转换"),u=Ne(!1),p=Ke({fileList:[],selectList:[],path:"",del:!1,allKey:""}),d=Ne(!1),h=Ke({all:[],audio:[],image:[],video:[]}),f=Ne([zt({key:"fileName"}),{label:"文件名",prop:"fileName"},{label:"格式类型",prop:"ext",width:80},{label:"转换为",prop:"status",width:190,renderHeader:()=>{var e;let t;return De("div",{class:"items-center inline-flex !w-[190px]"},[De("span",null,[Ie("转换为")]),De(at,{class:"!w-[8rem] ml-4px",modelValue:p.allKey||(null==(e=h.all[0])?void 0:e.value),onChange:e=>{p.allKey=e,p.fileList=p.fileList.map(t=>({...t,format:e}))}},Jn(t=h.all.map(e=>De(lt,{key:e.value,label:e.label,value:e.value},null)))?t:{default:()=>[t]})])},render:(e,t)=>{let a=null;return["audio","image","video"].forEach(t=>{var l,s;if(h[t].map(e=>e.value).includes(e.ext)){let i;e.format=e.format||(null==(l=h[t].at(0))?void 0:l.value),a=De("div",null,[De(at,{class:"!w-[12rem]",style:{display:e.isCustom?"none":"block"},modelValue:e.format||(null==(s=h[t].at(0))?void 0:s.value),onChange:t=>{e.format=t}},Jn(i=h[t].map(e=>De(lt,{key:e.value,label:e.label,value:e.value},null)))?i:{default:()=>[i]})])}}),a||(a=tt("span",{class:"text-[red]"},"不支持转换")),a}},{label:"执行状态",prop:"status",width:90,render:(e,t)=>{const a=["待转换","转换中","转换成功","转换失败"];let l=null;return h.all.map(e=>e.value).includes(e.ext)&&(l=tt("span",{},a[e.status])),l||(l=tt("span",{class:"text-[red]"},"无法转换")),l}},Mt([{onClick:e=>{p.fileList=p.fileList.filter(t=>t.path!==e.path)},title:"取消"}])]),v=async()=>{await m({loading:d,request:a.post("/files/conversion/get_convert_liet",{check:"msg",customType:"model"}),data:{all:[Array,e=>e.map(e=>({key:e,label:e}))],audio:[Array,e=>e.map(e=>({key:e,label:e}))],image:[Array,e=>e.map(e=>({key:e,label:e}))],video:[Array,e=>e.map(e=>({key:e,label:e}))]},success:e=>{Object.keys(e).forEach(t=>{e[t]=e[t].map(e=>({value:e.key,label:e.label}))}),h.all=e.all,h.audio=e.audio,h.image=e.image,h.video=e.video}})},g=Ke({fileList:[],p:1,limit:10}),y=Ne([{label:"操作时间",prop:"time",width:160,render:e=>tt("span",{},n(e.time))},{label:"操作类型",prop:"type",width:80},{label:"操作日志",prop:"operation"},{label:"操作结果",prop:"status",width:160}]),b=async()=>{var e;await m({request:(e={p:g.p,limit:g.limit},a.post("/files/conversion/get_log",{data:e,check:"object",customType:"model"})),success:e=>{if(e.status){const t=e.data.msg.data;g.fileList="string"==typeof t?[]:t}else r.error(e.msg)}})},_=async()=>{const e=await i.value;null==e||e.unmount()};return{instance:i,fileItem:s,activeName:o,tableColumn:f,loading:d,formatData:p,subLoad:u,btnText:c,addFile:()=>{qu({type:"file",change:async e=>{const t=await $l({filename:e});t.status?p.fileList.push({status:0,ext:t.data.st_type,...t.data,path:e,fileName:t.data.name}):r.error(t.msg)}})},openFile:e=>{qu({type:"dir",change:e=>{p.path=e}})},goConversion:async()=>{const e=[];if(p.selectList.forEach(t=>{if(0===t.status){const a=t.name.split(".");a.pop(),e.push({input_file:t.path,output_file:"".concat(p.path,"/").concat(a,".").concat(t.format)})}}),!e.length)return r.error("没有需要转换的文件");var t;c.value="转换中",u.value=!0,await m({loading:"正在转换中，请稍后...",request:(t={is_save:p.del?1:0,pdata:JSON.stringify(e)},a.post("/files/conversion/run",{data:t,check:"msg",customType:"model"})),success:e=>{w(e.data)?(e.data.forEach(e=>{e.msg=e.msg||(e.status?"转换成功":"转换失败")}),l(),_(),mc({title:"转换结果",resultData:e.data})):(c.value="执行转换",u.value=!1,r.error(e.msg))}})},handleSelectionChange:e=>{p.selectList=e},logTableColumn:y,tableData:g,getData:b,handleTabEvent:e=>{"conver"===e?v():b()},init:()=>{var e,a;v(),p.fileList=Array.isArray(s.value)?null==(e=s.value)?void 0:e.map(e=>({status:0,...e,name:e.fileName})):[{status:0,...s.value,name:null==(a=s.value)?void 0:a.fileName}],p.path=t.value.param.path},$reset:()=>{u.value=!1,d.value=!1,Object.assign(p,{fileList:[],selectList:[],path:"",del:!1,allKey:""}),Object.assign(g,{fileList:[],p:1,limit:10}),Object.assign(h,{all:[],audio:[],image:[],video:[]}),c.value="执行转换"}}}),$n=We("FILES-OVERLAY-TIPS-STORE",()=>{const{getGlobalInfo:e}=l(),t=gc(),{fileTabActiveData:a,copyFilesData:s}=et(t),{refreshFilesList:i,getRealTask:c}=t,u=Ne(),p=Ne(""),d=Ne(),h=Ne([zt({key:"filename"}),{prop:"filename",label:"文件名"},{prop:"size",label:"大小",render:e=>De("span",null,[e.is_dir?"--":_(e.size)])},{prop:"mtime",width:136,label:"最后修改时间",render:e=>n(Number(e.mtime))}]),f=Ke({addend1:0,addend2:0,sum:0}),v=Ne(!1),g=Ne(),y=Ne([]),b=Ne([]),w=e=>{if(e.endsWith(".tar.gz")){const t=e.substring(0,e.length-7);return"".concat(t,"-副本.tar.gz")}{const t=e.lastIndexOf(".");if(-1===t)return"".concat(e,"-副本");{const a=e.substring(0,t),l=e.substring(t);return"".concat(a,"-副本").concat(l)}}},S=Ke({type:"",size:0,filename:"",mtime:0,is_dir:!1}),k=Ke({name:[{validator:(e,t,a)=>{"rename"===S.type&&t===u.value.fileData[0].filename&&a(new Error("名称重复，请输入新文件名!")),""===t?a(new Error("请输入新文件名!")):a()},trigger:["blur"]}]});return{compData:u,fileTabActiveData:a,sitesPath:p,overlayFormRef:g,overlayForm:S,tableLoading:v,quickRules:k,calcData:f,tableColumns:h,tableData:b,handleSelectionChange:e=>{y.value=e},watchType:e=>{"single"===u.value.type&&(S.filename="over"===e?u.value.fileData[0].filename:w(u.value.fileData[0].filename))},fileFormat:w,onConfirm:async e=>{if("single"===u.value.type){const t={path:a.value.param.path,name:S.filename},{data:l}=await Rl(t);l.length>0&&await o({title:"覆盖文件",content:"检测到同名文件，您确定要覆盖当前【".concat(S.filename,"】文件？")});const n={sfile:s.value.files[0].path,dfile:a.value.param.path+"/"+S.filename};"rename"===S.type&&(n.rename=!0);const u="copy"===s.value.type?Nl:Ol;return void(await m({loading:"正在处理文件，请稍后...",request:u(n),success:t=>{t.status&&(t.msg="文件覆盖成功!",i(),Rr()),r.request(t),c(),e()}}))}if(f.sum===f.addend1+f.addend2){let t=y.value.map(e=>e.filename);await m({loading:"正在处理文件，请稍后...",request:ms({type:"copy"===s.value.type?1:2,path:a.value.param.path,skip_files:JSON.stringify(t)}),message:!0,success:t=>{t.status&&(i(),Rr()),c(),e()}})}else r.error("请输入正确的计算结果")},init:async t=>{b.value="batch"==u.value.type?u.value.fileData:[],await(async()=>{const t=await e();p.value=(null==t?void 0:t.sites_path)||""})(),f.sum=void 0,f.addend1=Math.round(9*Math.random()+1),f.addend2=Math.round(9*Math.random()+1),"batch"==u.value.type?(b.value=u.value.fileData,d.value=t.value,d.value.handleAllChange(!0)):(S.type="rename",S.size=u.value.fileData[0].size,S.filename=w(u.value.fileData[0].filename),S.mtime=u.value.fileData[0].mtime,S.is_dir=u.value.fileData[0].is_dir)},$reset:()=>{b.value=[],y.value=[]}}}),Yn=We("FILES-TAMPER-STORE",()=>{const{refreshFilesList:e}=gc(),t=Ne(),l=Ne("关闭"),s=Ne("文件"),i=Ne(""),n=Ke({fileName:!0,ext:!1});return{isStart:l,isFile:s,compData:t,checkList:n,onConfirm:async()=>{var l,s;if(!n.ext&&!n.fileName)return void r.error("请至少选择一项");const o={pid:t.value.data.tamperProofId,settings:[]},c=t.value.data.path;if("create"===i.value&&0==t.value.data.tamperProofId)return void(async l=>{let s=t.value.data.path,i=[];if(t.value.data.isFile){const e=s.lastIndexOf("/");if(-1!==e&&(s=s.substring(0,e)),n.fileName){let e=t.value.data.path.split("/"),a=e.length>=2?e[e.length-2]:"";i.push("".concat(a,"/").concat(t.value.data.fileName))}n.ext&&i.push("."+t.value.data.fileName.split(".").pop())}var o;await m({loading:"正在创建目录保护，请稍后...",request:(o={path:s,exts:JSON.stringify(i)},a.post("/tamper_core/create_path.json",{data:o,check:"object",customType:"model"})),message:!0,success:t=>{t.status&&(e(),l&&l())}})})(close);if(t.value.data.isFile)(null==(l=t.value.data)?void 0:l.isLock)?(n.fileName&&(o.settings.push({key:"remove_bf",values:[c]}),o.settings.push({key:"add_wf",values:[c]})),n.ext&&o.settings.push({key:"remove_bf",values:["."+t.value.data.fileName.split(".").pop()]})):(n.fileName&&(o.settings.push({key:"add_bf",values:[c]}),o.settings.push({key:"remove_wf",values:[c]})),n.ext&&o.settings.push({key:"add_bf",values:["."+t.value.data.fileName.split(".").pop()]}));else if(null==(s=t.value.data)?void 0:s.isLock){var u=i.value;-1!=t.value.data.path.indexOf("/www/server/panel/class")&&(u="add_wd"),o.settings.push({key:u,values:[t.value.data.path]})}else o.settings.push({key:i.value,values:[c]});o.settings=JSON.stringify(o.settings);var p;return(await m({loading:"正在执行中，请稍后...",request:(p=o,a.post("/tamper_core/batch_setting.json",{data:p,check:"object",customType:"model"})),message:!0,success:t=>{t.status&&e()}})).status},init:()=>{var e;l.value=(null==(e=t.value.data)?void 0:e.isLock)?"关闭":"开启",s.value="file"===t.value.data.type?"文件":"目录",(async()=>{var e;await m({request:(e={path:t.value.data.path},a.post("/tamper_core/get_effective_path.json",{data:e,customType:"model"})),success:e=>{i.value=e.data.data.action[0]}})})()},$reset:()=>{i.value="",Object.assign(n,{fileName:!0,ext:!1})}}}),Kn=We("FILES-TASK-STORE",()=>{const{refreshFilesList:e}=gc(),t=Ne();let a=null;const l=Ne([]),s=async()=>{try{const t=await S({status:-3});if(0===t.data.length)return clearInterval(a),e(),void i();l.value=t.data,a=setTimeout(s,2e3)}catch(t){p(t)}},i=async()=>{const e=await t.value;null==e||e.unmount()};return{instance:t,taskData:l,getLog:s,cancel:async e=>{await o({title:"删除任务",content:"您真的要删除当前任务【".concat(e.name,":").concat(e.shell,"】吗？")}),m({loading:"正在删除，请稍后...",request:k({id:e.id}),message:!0,success:s})},$reset:()=>{l.value=[],clearInterval(a)}}}),Qn=We("FILES-IMAGE-PREVIEW-STORE",()=>{const{fileTabActiveData:e,imageList:t}=et(gc()),a=Ne(),l=window.location.protocol+"//"+window.location.host+"/download?filename=",s=Ne(""),i=Ne([]);return{fileItem:a,image:s,imagesArr:i,init:()=>{s.value="".concat(l).concat(a.value.path),(async()=>{i.value=t.value.map(t=>"".concat(l).concat(e.value.param.path,"/").concat(t[0]))})()},$reset:()=>{i.value=[]}}}),Xn=We("FILES-IMPORT-DATABASE-STORE",()=>{const e=Ne(),t=Ke({name:""}),l=Ne(!1),s=Ne(),i=Ke({name:[{validator:(e,t,a)=>{""===t?a(new Error("请选择压缩路径")):a()},trigger:["blur"]}]}),n=Ne([]);return{fileItem:e,quickFormRef:s,quickForm:t,quickRules:i,disable:l,databaseOptions:n,onConfirm:async()=>{await o({title:"导入数据库",content:"是否将【".concat(e.value.fileName,"】文件，导入【").concat(n.value.find(e=>e.value==t.name).label,"】数据库中，是否继续？")});const l={name:n.value.find(e=>e.value==t.name).label,file:e.value.path};await s.value.validate();var i;return(await m({loading:"正在导入数据库，请稍后...",request:(i=l,a.post("database/InputSql",{data:i,check:"msg"})),message:!0})).status},toggleName:e=>{t.name=e},getOptions:async()=>{await m({request:T({table:"databases"}),success:e=>{e.status&&(n.value=e.data.data.map(e=>({label:e.name,value:e.id})),n.value.length>0&&(t.name=n.value[0].value))}})},$reset:()=>{Object.assign(t,{name:""}),l.value=!1,n.value=[]}}}),Zn=We("FILES-VIDEO-STORE",()=>{const{fileTabActiveData:e}=et(gc()),t=Ne(""),l=Ne([]),s=e.value.param.path;return{currentPath:s,videoList:l,videoUrl:t,playVideo:e=>{t.value=s+"/"+e},getList:async()=>{var e;await m({request:(e={path:s},a.post("files/get_videos",{data:e,check:"array"})),data:[Array,l]})},$reset:()=>{t.value="",l.value=[]}}}),eo=We("FILES-SHARE-LIST-STORE",()=>{const e=Ne({}),{refreshFilesList:t}=gc(),l=Ne(!1),s=Ne([]),i=Ke({total:0,p:1,limit:12,file_name:""}),n=async()=>{var e;m({loading:l,request:(e={p:i.p,filename:i.file_name||""},a.post("files/get_download_url_list",{data:{p:1,...e},check:"object"})),data:{data:[Array,s],page:u(i)}})},r=Ne([{label:"分享名称",prop:"ps"},{label:"文件地址",prop:"filename"},{label:"过期时间",prop:"expire"},Mt([{onClick:e=>{Jo(e,!0)},title:"详情"},{onClick:async e=>{await o({title:"取消分享",content:"是否取消分享该文件【".concat(e.ps,"】，是否继续？")}),m({loading:"正在取消文件分享，请稍后...",request:Bl({id:e.id}),message:!0,success:e=>{e.status&&(n(),t())}})},title:"关闭"}])]);return{compData:e,isLoading:l,tableData:s,shareTableData:i,tableColumn:r,getShareData:n,searchSubmit:e=>{i.file_name=e,n()},$reset:()=>{l.value=!1,s.value=[],Object.assign(i,{total:0,p:1,limit:12,file_name:""})}}}),to=We("FILES-SHARE-STORE",()=>{const{refreshFilesList:e}=gc(),t=Ne(),l=Ke({ps:"",expire:24,password:""}),s=Ne(!1),i=Ne(),n=Ke({ps:[{validator:(e,t,a)=>{""===t?a(new Error("请输入分享名称")):a()},trigger:["blur"]}]}),c=Ne(),u=Ke({name:"",link:"",code:"",time:""}),p=Ne({}),d=Ne(!1),h=Ne(!1),f=Ne(),v=Ke({});return{fileItem:t,quickFormRef:i,quickForm:l,quickRules:n,disable:s,help:[{isHtml:!0,content:'<span class="text-[#ef0808]">注意：生成的外链分享链接具有一定的风险，请仅与可信任的人分享链接，避免敏感信息泄露</span>'}],compData:c,detail:p,detailFormRef:f,detailForm:u,detailRules:v,isDisabled:h,helpList:[{content:'<span class="text-[#ef0808]">注意：生成的外链分享链接具有一定的风险，请仅与可信任的人分享链接，避免敏感信息泄露</span>',isHtml:!0}],showQrcode:d,copyAll:e=>{L({value:"链接：".concat(u.link," 提取码：").concat(u.code)})},copyLink:e=>{L({value:u.link})},onConfirm:async n=>{const o={filename:br(t.value.fileName),ps:l.ps,password:l.password,expire:l.expire};var c;await i.value.validate(),await m({loading:s,request:(c=o,a.post("files/create_download_url",{data:c,check:"msg"})),success:t=>(t.status?(r.success("分享成功"),n.unmount()):r.error(t.message),e(),Jo(t.data))})},onConfirmDetail:async()=>{try{await f.value.validate(),await o({title:"取消分享【".concat(p.value.ps,"】"),content:"您真的要取消分享【".concat(p.value.ps,"】吗？")});const t={id:p.value.id};return(await m({loading:"正在取消文件分享，请稍后...",request:Bl(t),message:!0,success:t=>{if(t.status){const{getShareData:t}=eo();t(),e()}}})).status}catch(t){}},initDetail:()=>{d.value=!1,Object.assign(u,{name:"",link:location.origin+"/down/"+c.value.token,code:"",time:c.value.expire}),(async()=>{if(c.value.isShareList)return p.value=c.value,u.name=c.value.ps,u.link=location.origin+"/down/"+c.value.token,u.code=c.value.password||"",u.time=c.value.expire,void(u.qrcode=location.origin+"/down/"+c.value.token+"?fname="+c.value.ps+"&down=true");var e;await m({loading:"正在获取分享详情，请稍后...",request:(e={id:Number(c.value.isShare|c.value.id)},a.post("files/get_download_url_find",{data:e})),success:e=>{p.value=e.data,u.name=e.data.ps,u.link=location.origin+"/down/"+e.data.token,u.code=e.data.password||"",u.time=e.data.expire,u.qrcode=location.origin+"/down/"+e.data.token+"?fname="+e.data.ps+"&down=true"}})})()},init:()=>{s.value=!1,Object.assign(l,{ps:t.value.fileName,expire:24,password:""})}}}),ao=We("FILES-SEND-EMAIL-STORE",()=>{const e=Ne(),t=Ke({email:"",msg:""}),l=Ne(!1),s=Ne(),i=Ke({email:[{validator:(e,t,a)=>{if(""===t)a(new Error("请输入接受者邮箱"));else{const e=t.trim().split(",").filter(e=>""!==e);let l=!1;e.forEach(e=>{E(e)||(l=!0)}),l?a(new Error("请输入正确的邮箱")):a()}},trigger:["blur"]}],fileName:[{validator:(t,a,l)=>{e.value.size>52428800?l(new Error("请选择小于50M的附件")):l()}}]}),n=e=>0===Object.keys(e).length;return{fileItem:e,quickFormRef:s,quickForm:t,quickRules:i,disable:l,getDetail:async()=>{const{data:e}=await a.post("/files/upload/check_email_config",{check:"object",customType:"model"});n(e)&&Wu({title:"发送者配置",type:"mail",callback:()=>{}})},onConfirm:async()=>{const i={to_email:t.email,msg:t.msg,flist:[br(e.value.fileName)]};await s.value.validate();var o;return(await m({loading:l,request:(o={data:JSON.stringify(i)},a.post("/files/upload/send_to_email",{data:o,check:"object",customType:"model"})),success:e=>{const{data:t}=e;if(t.msg&&""!=t.msg)return r.error(t.msg),null;let a=[];Object.keys(t.list).forEach(e=>{const l=n(t.list[e].error);let s=[];l||Object.keys(t.list[e].error).forEach(a=>{s.push(a+"："+t.list[e].error[a])}),a.push({name:e,msg:l?"发送成功":s.join("<br>"),status:!!l})}),v({title:"发送至邮箱-结果",area:50,component:()=>f(()=>import("./index125.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),compData:{resultData:a,resultTitle:"发送至邮箱",resultColumn:[{label:"邮箱",prop:"name"},{label:"结果",width:80,render:e=>tt("span",{class:e.status?"text-primary":"text-danger"},e.status?"操作成功":"操作失败")},{label:"信息",render:e=>tt("span",{class:e.status?"":"text-danger"},e.msg)}]}})}})).data.status},$reset:()=>{l.value=!1,Object.assign(t,{email:"",msg:""})}}}),lo=We("FILES-SPLIT-STORE",()=>{var e;const t=gc(),{fileTabActiveData:l}=et(t),{refreshFilesList:s}=t,i=Ne(),n=Ke({type:"size",size:1024,num:5,path:(null==(e=l.value)?void 0:e.param.path)||""}),o=Ne(!1),c=Ne(),u=Ke({size:[{validator:(e,t,a)=>{"size"===n.type?""===t?a(new Error("请输入拆分大小")):1024*Number(t)*1024>=i.value.size/2?a(new Error("拆分大小不能大于文件大小一半")):a():a()},trigger:["blur"]}],num:[{validator:(e,t,a)=>{"num"===n.type&&(""===t||Number(t)<2)?a(new Error("拆分数量不能小于2个")):a()},trigger:["blur"]}],path:[{validator:(e,t,a)=>{""===t?a(new Error("请选择存放目录")):a()},trigger:["blur"]}]});return{fileItem:i,quickFormRef:c,quickForm:n,quickRules:u,disable:o,help:[{content:"拆分后会在存放目录(默认当前目录)下创建一个xxx_split文件夹,存放配置文件以及拆分文件"}],openFile:()=>{qu({type:"dir",change:e=>{n.path=e}})},onConfirm:async e=>{const t={file_path:br(i.value.fileName),save_path:n.path};"size"===n.type?t.split_size=Number(n.size):t.split_num=Number(n.num),await c.value.validate();var l;return(await m({loading:"正在拆分文件，请稍后...",request:(l=t,a.post("files/SplitFile",{data:l,check:"object"})),message:!0,success:e=>{r.request({status:e.status,msg:e.status?"拆分成功":"拆分失败"}),s()}})).status},init:()=>{var e;o.value=!1,Object.assign(n,{type:"size",size:1024,num:5,path:(null==(e=l.value)?void 0:e.param.path)||""})}}}),so=We("FILES-TERMINAL-STORE",()=>{const{fileTabActiveData:e}=et(gc()),t=Ne(),a=Ne(),l=()=>a.value,s=async()=>{const e=l(),t=null==e?void 0:e.socketInfo();try{await o({title:"确定要关闭SSH会话吗？",content:"关闭SSH会话后，当前命令行会话正在执行的命令可能被中止，确定关闭吗？"}),i(),t.close()}catch(a){}},i=async()=>{const e=await t.value;null==e||e.unmount()};return{instance:t,filesTerminalRef:a,init:()=>{Oe(()=>{const t=l(),a=null==t?void 0:t.socketInfo(),s=null==t?void 0:t.terminal;a.send("\r\nclear\r"),a.send("cd ".concat(e.value.param.path,"\r")),null==s||s.focus()})},onCancel:()=>(s(),!1)}}),io=We("FILES-MERGE-STORE",()=>{var e;const t=gc(),{fileTabActiveData:l}=et(t),{refreshFilesList:s}=t,i=Ne(),n=Ke({path:(null==(e=l.value)?void 0:e.param.path)||"",disable:!1,file:{}}),o=Ne(!1),r=Ne(),c=Ke({path:[{validator:(e,t,a)=>{""===t?a(new Error("请选择存放目录")):a()},trigger:["blur"]}]});return{fileItem:i,loading:o,quickFormRef:r,quickForm:n,quickRules:c,openFile:()=>{qu({type:"dir",change:e=>{n.path=e}})},getFile:async()=>{var e;await m({loading:o,request:(e={file_path:i.value.path},a.post("files/JoinConfigFile",{data:e,check:"msg"})),success:e=>{var t;Object.assign(n,{path:(null==(t=l.value)?void 0:t.param.path)||"",disable:!1,file:e.data})}})},onConfirm:async e=>{const t={file_path:br(i.value.fileName),save_path:n.path};var l;await r.value.validate(),await m({loading:o,request:(l=t,a.post("files/JoinFile",{data:l,check:"msg"})),message:!0,success:t=>{s(),t.status&&e&&e()}})}}}),no=We("FILES-EDIT-STORE",()=>{const e=Ne(),t=Ne(!1),a=Ke({data:""});return{compData:e,config:{mode:"ace/mode/nginx"},load:t,cmdForm:a,onConfirm:async t=>{const l={sfile:e.value.fileItem.path,filename:(""!=e.value.path?e.value.path+"/":"")+e.value.name,data:a.data},s="zip"===e.value.fileItem.ext?ts:as;await m({loading:"正在保存，请稍后...",request:s({data:JSON.stringify(l)}),message:!0,success:e=>{e.status&&t&&t()}})},init:()=>{a.data=e.value.data.data}}}),oo=We("FILES-DECOMPRESSION-STORE",()=>{const e=gc(),{fileTabActiveData:t}=et(e),{refreshFilesList:a,getRealTask:l}=e,s=Bn(),{instance:i}=et(s),n=Ne(),o=Ke({fileName:"",path:t.value.param.path||"",coding:"UTF-8",password:"",auth:"755"}),r=Ne(!1),c=Ne(),u=Ke({path:[{validator:(e,t,a)=>{""===t?a(new Error("请选择解压路径")):a()},trigger:["blur"]}],auth:[{validator:(e,t,a)=>{""===t||isNaN(Number(t))||t.length>3?a(new Error("请输入正确的权限")):a()},trigger:["blur"]}]});return{fileItem:n,quickFormRef:c,quickForm:o,quickRules:u,codeOptions:[{label:"UTF-8",value:"UTF-8"},{label:"GBK",value:"GBK"}],disable:r,openFile:()=>{qu({type:"dir",change:e=>{o.path=e}})},toggleCode:e=>{o.coding=e},init:()=>{Object.assign(o,{fileName:n.value.fileName,path:t.value.param.path||"",coding:"UTF-8",password:"",auth:"755"})},onConfirm:async()=>{const e={sfile:n.value.path,dfile:o.path,type:"tar.gz"===n.value.ext?"tar":"zip",coding:o.coding,password:o.password,power:o.auth};await c.value.validate(),r.value=!0;const t=await m({loading:"正在解压文件，请稍后...",request:Wl(e),message:!0,success:async e=>{a(),l();const t=await i.value;null==t||t.unmount()}});return r.value=!1,t.status}}}),ro=We("FILES-COMPRESS-STORE",()=>{const e=gc(),{fileTabActiveData:t}=et(e),{refreshFilesList:a,getRealTask:l}=e,s=Ne(),i=Ke({type:"tar.gz",path:"",download:!1}),n=Ne(!1),o=Ne(),c=Ke({path:[{validator:(e,t,a)=>{""===t?a(new Error("请选择压缩路径")):a()},trigger:["blur"]}]}),u=Ne(),d=Ne(),h=Ne([]),f=Ne(null),v=async e=>{try{const t=d.value.params;(await Wl({...t,...e})).status&&f.value.tableSelectList.forEach(e=>{h.value.forEach((t,a)=>{if(e.zip_file_path===t.zip_file_path){const e={...t,status:"执行成功"};h.value.splice(a,1,e)}})}),h.value.find(e=>void 0===e.status)||(b(),r.success("解压成功"),a())}catch(t){}},g=async e=>{try{const t=d.value.params;(await d.value.callback({...t,...e})).status&&f.value.tableSelectList.forEach(e=>{h.value.forEach((t,a)=>{if(e.zip_file_path===t.zip_file_path){const e={...t,status:"执行成功"};h.value.splice(a,1,e)}})}),h.value.find(e=>void 0===e.status)||(b(),r.success("解压成功"),a())}catch(t){p(t)}},y=Qe([zt({key:"file_path"}),{label:"文件名",prop:"name",minWidth:150},{label:"大小",prop:"size",width:150,render:e=>e.file_size===e.zip_file_size?De("span",{class:"text-primary"},[Ie("无变化")]):De("div",null,[De("div",{class:"text-blue-500"},[Ie("解压文件： "),De("span",{class:"text-danger"},[_(e.zip_file_size)])]),De("div",{class:"text-blue-500"},[Ie("目标文件： "),De("span",{class:"text-danger"},[_(e.file_size)])])])},{label:"修改时间",prop:"time",width:200,render:e=>e.file_mtime===e.zip_file_mtime?De("span",{class:"text-primary"},[Ie("无变化")]):De("div",null,[De("div",{class:"text-blue-500"},[Ie("解压文件： "),De("span",{class:"text-danger"},[e.zip_file_mtime])]),De("div",{class:"text-blue-500"},[Ie("目标文件： "),De("span",{class:"text-danger"},[e.file_mtime])])])},{label:"执行结果",prop:"action",fixed:"right",render:e=>e.status?De("span",{class:"text-primary"},[e.status]):De("span",{class:"text-blue-500"},[Ie("-")])}]),b=async()=>{const e=await u.value;null==e||e.unmount()};return{fileItem:s,quickFormRef:o,quickForm:i,quickRules:c,disable:n,compressOptions:[{label:"tar.gz (推荐)",value:"tar.gz"},{label:"zip (通用格式)",value:"zip"},{label:"rar (WinRAR对中文兼容较好)",value:"rar"},{label:"7z (压缩率极高的压缩格式)",value:"7z"}],openFile:()=>{qu({type:"dir",change:e=>{i.path=e+"/"+s.value.fileName+"_"+x(5)+"."+i.type}})},toggleType:e=>{i.type=e,i.path=t.value.param.path+"/"+(Array.isArray(s.value)?t.value.label:s.value.fileName)+"_"+x(5)+"."+i.type},onConfirm:async()=>{const e={sfile:Array.isArray(s.value)?s.value.map(e=>e.fileName):s.value.fileName,dfile:i.path,z_type:i.type,path:t.value.param.path+"/"};await o.value.validate();const n=i.download?Jl:Gl;await m({loading:"正在压缩文件，请稍后...",request:n(e),success:e=>{e.status?(i.download?e.data.task_id?setTimeout(()=>{r.error("无法下载，".concat(e.data.msg))},1e3):window.open(e.data.msg):r.success("压缩成功"),l(),setTimeout(()=>{a()},1e3)):r.error(e.msg)}})},init:()=>{Object.assign(i,{type:"tar.gz",path:("/"==t.value.param.path?"":t.value.param.path)+"/"+(Array.isArray(s.value)?t.value.label:s.value.fileName)+"_"+x(5)+".tar.gz"||"",download:!1})},instance:u,compData:d,tableColumn:y,tableList:h,jump:()=>{if(0===f.value.tableSelectList.length)return void r.error("请选择文件");const e=f.value.tableSelectList.map(e=>({zip_file_path:e.zip_file_path,file_path:e.file_path}));if(d.value.callback){const t=d.value.params,a=JSON.parse(t.data).extract_path.split("/");return a.pop(),void g({data:JSON.stringify({...JSON.parse(t.data),extract_path:a.join("/"),filenames:e,type:0})})}v({filenames:JSON.stringify(e),type1:0})},cover:()=>{if(0===f.value.tableSelectList.length)return void r.error("请选择文件");const e=f.value.tableSelectList.map(e=>({zip_file_path:e.zip_file_path,file_path:e.file_path}));if(d.value.callback){const t=d.value.params,a=JSON.parse(t.data).extract_path.split("/");return a.pop(),void g({data:JSON.stringify({...JSON.parse(t.data),extract_path:a.join("/"),filenames:e,type:1})})}v({filenames:JSON.stringify(e),type1:1})},rename:()=>{if(0===f.value.tableSelectList.length)return void r.error("请选择文件");const e=f.value.tableSelectList.map(e=>({zip_file_path:e.zip_file_path,file_path:e.file_path}));if(d.value.callback){const t=d.value.params,a=JSON.parse(t.data).extract_path.split("/");return a.pop(),void g({data:JSON.stringify({...JSON.parse(t.data),extract_path:a.join("/"),filenames:e,type:2})})}v({filenames:JSON.stringify(e),type1:2})},initCover:()=>{h.value=d.value.data.data},$reset:()=>{h.value=[]},TableRef:f}}),co={class:"p-20px"},uo=je({__name:"receive",setup(e){const t=_o(),{formDisabled:a,rules:l,isSuccess:s,receiveForm:i,receiveFormRef:n}=et(t);return(e,t)=>{const o=h,r=ct,c=Bt,u=ut,p=C;return He(),Be("div",co,[De(u,{ref_key:"receiveFormRef",ref:n,disabled:nt(a),rules:nt(l),model:nt(i)},{default:it(()=>[De(r,{label:"用户名",prop:"mName"},{default:it(()=>[De(o,{class:"!w-[24rem]",modelValue:nt(i).mName,"onUpdate:modelValue":t[0]||(t[0]=e=>nt(i).mName=e),disabled:nt(s),placeholder:"请填写用户名，不能有中文或特殊符号"},null,8,["modelValue","disabled"])]),_:1}),De(r,{label:"密码",prop:"password"},{default:it(()=>[nt(s)?(He(),ot(o,{key:1,class:"!w-[24rem]",modelValue:nt(i).password,"onUpdate:modelValue":t[3]||(t[3]=e=>nt(i).password=e),disabled:""},null,8,["modelValue"])):(He(),ot(c,{key:0,class:"!w-[24rem]",icon:"el-refresh",modelValue:nt(i).password,"onUpdate:modelValue":t[1]||(t[1]=e=>nt(i).password=e),isActive:!0,onIconClick:t[2]||(t[2]=()=>nt(i).password=nt(g)(16))},null,8,["modelValue"]))]),_:1}),nt(s)?rt("",!0):(He(),ot(r,{key:0,label:"同步到",prop:"path"},{default:it(()=>[De(o,{class:"!w-[24rem]",modelValue:nt(i).path,"onUpdate:modelValue":t[4]||(t[4]=e=>nt(i).path=e),disabled:""},null,8,["modelValue"])]),_:1}))]),_:1},8,["disabled","rules","model"]),nt(s)?(He(),ot(p,{key:0,class:"pl-2rem",options:[{content:"使用上面的用户信息，前往发送数据的服务器创建发送端"}]})):rt("",!0)])}}}),po={class:"p-20px"},mo={class:"flex items-center time-unit"},ho={key:1,class:"mt-20px"},fo={class:"pt-2rem flex flex-col"},vo={class:"text-danger p-2rem text-base leading-10 ml-36px"},go={class:"flex items-center mt-12px ml-4px px-2rem"},yo={class:"bg-[#f6f8f8] footer-btn flex items-center justify-end mt-2rem p-12px w-full"},bo=I(je({__name:"send",setup(e){const t=_o(),{formDisabled:a,sendFormRef:l,rulesSend:s,sendForm:i,alertRsync:n,checkOffRsync:o}=et(t),{helpList:r,handleChangeDelete:c,handleConfirm:u}=t;return(e,t)=>{const p=h,d=ct,m=lt,f=at,v=mt,g=ht,y=ut,b=C,_=ft,w=vt,S=D;return He(),Be("div",po,[De(y,{ref_key:"sendFormRef",ref:l,disabled:nt(a),rules:nt(s),model:nt(i)},{default:it(()=>[De(d,{label:"服务器IP",prop:"ip"},{default:it(()=>[De(p,{modelValue:nt(i).ip,"onUpdate:modelValue":t[0]||(t[0]=e=>nt(i).ip=e),placeholder:"请输入接收服务器IP",width:"34.8rem"},null,8,["modelValue"])]),_:1}),De(d,{label:"同步目录",prop:"path"},{default:it(()=>[De(p,{modelValue:nt(i).path,"onUpdate:modelValue":t[1]||(t[1]=e=>nt(i).path=e),disabled:"",width:"34.8rem"},null,8,["modelValue"])]),_:1}),De(d,{label:"同步方式",class:"form-row"},{default:it(()=>[De(v,null,{default:it(()=>[De(f,{modelValue:nt(i).delete,"onUpdate:modelValue":t[2]||(t[2]=e=>nt(i).delete=e),class:"!w-[12rem]",onChange:nt(c)},{default:it(()=>[De(m,{label:"增量",value:!1}),De(m,{label:"完全",value:!0})]),_:1},8,["modelValue","onChange"]),De(d,{label:"同步周期"},{default:it(()=>[De(f,{modelValue:nt(i).realtime,"onUpdate:modelValue":t[3]||(t[3]=e=>nt(i).realtime=e),class:"!w-[12rem]"},{default:it(()=>[De(m,{label:"实时同步",value:!0}),De(m,{label:"定时同步",value:!1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),nt(i).realtime?rt("",!0):(He(),ot(d,{key:0,label:"定时周期",prop:"cron"},{default:it(()=>[De(v,null,{default:it(()=>[De(f,{modelValue:nt(i).cron.type,"onUpdate:modelValue":t[4]||(t[4]=e=>nt(i).cron.type=e),class:"!w-[10rem] mr-8px"},{default:it(()=>[De(m,{label:"每天",value:"day"}),De(m,{label:"N分钟",value:"minute-n"})]),_:1},8,["modelValue"]),Je("div",mo,["minute-n"!==nt(i).cron.type?(He(),ot(p,{key:0,modelValue:nt(i).cron.hour,"onUpdate:modelValue":t[5]||(t[5]=e=>nt(i).cron.hour=e),type:"number",class:"!w-[11.6rem] mr-8px"},{append:it(()=>[...t[21]||(t[21]=[Ie(" 小时 ",-1)])]),_:1},8,["modelValue"])):rt("",!0),De(p,{modelValue:nt(i).cron.minute,"onUpdate:modelValue":t[6]||(t[6]=e=>nt(i).cron.minute=e),type:"number",class:"w-[12rem]"},{append:it(()=>[...t[22]||(t[22]=[Ie(" 分钟 ",-1)])]),_:1},8,["modelValue"])])]),_:1})]),_:1})),De(d,{label:"限速",class:"form-row"},{default:it(()=>[De(v,null,{default:it(()=>[De(g,{span:8},{default:it(()=>[De(p,{modelValue:nt(i).bwlimit,"onUpdate:modelValue":t[7]||(t[7]=e=>nt(i).bwlimit=e),type:"number",class:"!w-[12rem]"},{append:it(()=>[...t[23]||(t[23]=[Ie("KB",-1)])]),_:1},8,["modelValue"])]),_:1}),De(g,{span:14},{default:it(()=>[De(d,{label:"延迟"},{default:it(()=>[De(p,{modelValue:nt(i).delay,"onUpdate:modelValue":t[8]||(t[8]=e=>nt(i).delay=e),type:"number",class:"!w-[12rem]"},{append:it(()=>[...t[24]||(t[24]=[Ie("秒",-1)])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),De(d,{label:"链接方式",class:"form-row"},{default:it(()=>[De(v,null,{default:it(()=>[De(f,{modelValue:nt(i).rsync,"onUpdate:modelValue":t[9]||(t[9]=e=>nt(i).rsync=e),class:"!w-[12rem]"},{default:it(()=>[De(m,{label:"密钥",value:"key"}),De(m,{label:"账号",value:"user"})]),_:1},8,["modelValue"]),De(d,{label:"压缩传输"},{default:it(()=>[De(f,{modelValue:nt(i).compress,"onUpdate:modelValue":t[10]||(t[10]=e=>nt(i).compress=e),class:"!w-[12rem]"},{default:it(()=>[De(m,{label:"开启",value:!0}),De(m,{label:"关闭",value:!1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),"user"===nt(i).rsync?(He(),Be("div",ho,[De(d,{label:"用户名",prop:"sname"},{default:it(()=>[De(p,{modelValue:nt(i).sname,"onUpdate:modelValue":t[11]||(t[11]=e=>nt(i).sname=e),width:"34.8rem",placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),De(d,{label:"密码",prop:"password"},{default:it(()=>[De(p,{modelValue:nt(i).password,"onUpdate:modelValue":t[12]||(t[12]=e=>nt(i).password=e),width:"34.8rem",placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),De(d,{label:"端口",prop:"port"},{default:it(()=>[De(p,{modelValue:nt(i).port,"onUpdate:modelValue":t[13]||(t[13]=e=>nt(i).port=e),width:"34.8rem",type:"number"},null,8,["modelValue"])]),_:1})])):rt("",!0),"key"===nt(i).rsync?(He(),ot(d,{key:2,label:"密钥",prop:"secret_key"},{default:it(()=>[De(p,{modelValue:nt(i).secret_key,"onUpdate:modelValue":t[14]||(t[14]=e=>nt(i).secret_key=e),width:"34.8rem",type:"textarea",placeholder:"请输入密钥"},null,8,["modelValue"])]),_:1})):rt("",!0)]),_:1},8,["disabled","rules","model"]),De(b,{class:"pl-2rem",options:nt(r),"list-style":"disc"},null,8,["options"]),De(S,{title:"数据安全风险警告",area:[40,"auto"],modelValue:nt(n),"onUpdate:modelValue":t[18]||(t[18]=e=>dt(n)?n.value=e:null),onClose:t[19]||(t[19]=e=>nt(u)(!1)),onCancel:t[20]||(t[20]=e=>nt(u)(!1))},{default:it(()=>[Je("div",fo,[t[28]||(t[28]=Je("div",{class:"flex items-center px-2rem"},[Je("i",{class:"el-icon-warning text-[#e6a23c] text-[3rem] pr-4"}),Je("span",{class:"text-base leading-10 text-danger"},"警告：您选择了完全同步，将会使本机同步与目标机器指定目录的文件保持一致， 请确认目录设置是否有误，一但设置错误，可能导致目标机器的目录文件被删除!")],-1)),Je("span",vo,"注意： 同步程序将本机目录：【"+pt(nt(i).path)+"】的所有数据同步到目标服务器，若目标服务器的同步目录存在其它文件将被删除!",1),Je("div",go,[De(_,{modelValue:nt(o),"onUpdate:modelValue":t[15]||(t[15]=e=>dt(o)?o.value=e:null),class:"!mr-4px"},null,8,["modelValue"]),t[25]||(t[25]=Ie(" 我已了解风险，确认关闭 ",-1))]),Je("div",yo,[De(w,{type:"warning",onClick:t[16]||(t[16]=e=>nt(u)(!1))},{default:it(()=>[...t[26]||(t[26]=[Ie("取消",-1)])]),_:1}),De(w,{type:"danger",onClick:t[17]||(t[17]=e=>nt(u)(!0)),disabled:!nt(o)},{default:it(()=>[...t[27]||(t[27]=[Ie("确认选择",-1)])]),_:1},8,["disabled"])])])]),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-7f4396bf"]]),_o=We("FILES-RSYNC-STORE",()=>{const e=Ne(),t=(t,a,l)=>{i.path=e.value.row.path,u.path=e.value.row.path,a&&(s.value=!1,o.value=!1,Object.assign(i,{mName:"",password:"",path:e.value.row.path,comment:""}),d.value=!1,h.value=!1,Object.assign(u,{ip:"",rsync:"user",sname:"",password:"",path:e.value.row.path,port:873,secret_key:"",delete:!1,realtime:!0,bwlimit:1024,delay:3,compress:!0,cron:{type:"day",where1:"",hour:0,minute:1,id:"",port:""}})),v("receive"===t?{title:"创建接收端",area:42,btn:["确认","取消"],showFooter:!o.value,component:uo,onConfirm:c}:{title:"创建发送端",area:58,btn:["确认","取消"],component:bo,onConfirm:y}),l&&l()},l=async()=>{var t;if("site"===(null==(t=e.value.row)?void 0:t.type))e.value.row.refreshEvent();else{const{default:e}=await f(()=>Promise.resolve().then(()=>yc),void 0,import.meta.url),{refreshFilesList:t}=e();t()}};gt("popupSetFooter",e=>{});const s=Ne(!1),i=Ke({mName:"",password:"",path:"",comment:""}),n=Ne(),o=Ne(!1),r=Ke({mName:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"},{validator:(e,t,a)=>{/^[a-zA-Z0-9_]{3,20}$/.test(t)?a():a(new Error("用户名不能有中文或特殊符号"))},trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"长度在 6 到 20 个字符",trigger:"blur"}]}),c=async r=>{var c;await n.value.validate(),await m({loading:s,request:(c={...i,comment:i.mName},a.post("/plugin?action=a&name=rsync&s=add_module",{data:c,check:"msg",customType:"model"})),message:!0,success:async a=>{o.value=a.status,a.status&&(await rs({path:e.value.row.path,s_type:"recv"}),r.unmount(),l(),t("receive"))}})},u=Ke({ip:"",rsync:"user",sname:"",password:"",path:"",port:873,secret_key:"",delete:!1,realtime:!0,bwlimit:1024,delay:3,compress:!0,cron:{type:"day",where1:"",hour:0,minute:1,id:"",port:""}}),p=Ne(),d=Ne(!1),h=Ne(!1),g=Ke({ip:[{required:!0,message:"请输入ip",trigger:"blur"},{validator:(e,t,a)=>{/^(\d+)\.(\d+)\.(\d+)\.(\d+)$/.test(t)?a():a(new Error("请输入正确的ip"))}}],sname:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],secret_key:[{required:!0,message:"请输入密钥",trigger:"blur"}]}),y=async t=>{let i={...u,cron:JSON.stringify({...u.cron,port:String(u.port),hour:String(u.cron.hour),minute:String(u.cron.minute)})};"minute-n"===u.cron.type&&(i.cron=JSON.stringify({...u.cron,hour:String(u.cron.hour),where1:String(u.cron.minute),minute:"",port:String(u.port)})),"key"===u.rsync?(i.sname="",i.password=""):i.secret_key="",delete i.rsync,await p.value.validate();var n;return(await m({loading:s,request:(n=i,a.post("/plugin?action=a&name=rsync&s=add_ormodify_send",{data:n,check:"msg",customType:"model"})),message:!0,success:async t=>{t.status&&(await m({request:rs({path:e.value.row.path,s_type:"send"})}),l())}})).status};return{compData:e,handleClick:t,formDisabled:s,rules:r,isSuccess:o,receiveForm:i,receiveFormRef:n,sendFormRef:p,rulesSend:g,sendForm:u,alertRsync:d,checkOffRsync:h,helpList:[{content:"【同步目录】：若不以/结尾，则表示将数据同步到二级目录，一般情况下目录路径请以/结尾"},{content:"【同步方式】增量： 数据更改/增加时同步，且只追加和替换文件"},{content:"【同步方式】完全： 保持两端的数据与目录结构的一致性，会同步删除、追加和替换文件和目录"},{content:"【限速】：限制数据同步任务的速度，防止因同步数据导致带宽跑高"},{content:"【延迟】：在延迟时间周期内仅记录不同步，到达周期后一次性同步数据，以节省开销"},{content:"【压缩传输】：开启后可减少带宽开销，但会增加CPU开销，如带宽充足，建议关闭此选项"}],handleChangeDelete:async e=>{e?(d.value=!0,u.delete=!e):d.value=!1},handleConfirm:e=>{u.delete=e,d.value=!1,h.value=!1}}}),wo=Object.freeze(Object.defineProperty({__proto__:null,default:_o},Symbol.toStringTag,{value:"Module"})),So=We("FILES-DETAIL-STORE",()=>{const e=gc(),{fileTabActiveData:t}=et(e),{refreshFilesList:l}=e,s=Ne(),i=Ne("routine"),c=Ne(!1),u=Ne([]),p=()=>{u.value=[{title:"文件名",value:s.value.name},{title:"类型",value:s.value.st_type||"未知文件"},{title:"文件路径",value:"".concat(s.value.path,"/").concat(s.value.name)},{title:"文件大小",value:"".concat(s.value.st_size)},{title:"访问时间",value:n(s.value.st_atime)},{title:"修改时间",value:n(s.value.st_mtime)},{title:"元数据修改时间",value:n(s.value.st_ctime)},{title:"文件MD5",value:s.value.md5},{title:"文件sha1",value:s.value.sha1},{title:"所属用户",value:s.value.user},{title:"所属组",value:s.value.group},{title:"文件权限",value:s.value.mode},{title:"特殊权限",value:s.value.lsattr||"无"},{title:"用户id",value:s.value.st_uid},{title:"用户组id",value:s.value.st_gid},{title:"inode的链接数",value:s.value.st_nlink},{title:"inode的节点号",value:s.value.st_ino},{title:"inode保护模式",value:s.value.st_mode},{title:"inode驻留设备",value:s.value.st_dev}]},d=Ke({owner:[],group:[],public:[],auth:0,user:"root",isDir:!0,checkNumber:""}),h=async()=>{const e=await Kl({filename:"".concat(s.value.path+"/"+s.value.fileName)});if(e.status){const t=e.data;d.auth=t.chmod,d.user=t.chown,f(Number(t.chmod))}else r.error(e.msg)},f=e=>{256&(e=parseInt(e.toString(),8))?d.owner.push("r"):d.owner=d.owner.filter(e=>"r"!==e),128&e?d.owner.push("w"):d.owner=d.owner.filter(e=>"w"!==e),64&e?d.owner.push("x"):d.owner=d.owner.filter(e=>"x"!==e),32&e?d.group.push("r"):d.group=d.group.filter(e=>"r"!==e),16&e?d.group.push("w"):d.group=d.group.filter(e=>"w"!==e),8&e?d.group.push("x"):d.group=d.group.filter(e=>"x"!==e),4&e?d.public.push("r"):d.public=d.public.filter(e=>"r"!==e),2&e?d.public.push("w"):d.public=d.public.filter(e=>"w"!==e),1&e?d.public.push("x"):d.public=d.public.filter(e=>"x"!==e),d.owner=Array.from(new Set(d.owner)),d.group=Array.from(new Set(d.group)),d.public=Array.from(new Set(d.public))};return{activeName:i,fileItem:s,load:c,getFileItem:async()=>{c.value=!0;const e=await $l({filename:s.value.path});e.status?(s.value={...s.value,...e.data},c.value=!1):r.error(e.msg);const a=await hs({path:t.value.param.path+"/"+s.value.fileName});s.value.st_size=a.data,p()},$reset:()=>{u.value=[],Object.assign(d,{owner:[],group:[],public:[],auth:0,user:"root",isDir:!0,checkNumber:""})},attrList:u,watchFileItem:p,showHistory:e=>{},recoverHistory:async e=>{await o({title:"恢复历史文件",content:"是否恢复历史文件 ".concat(n(s.value.st_mtime),"?恢复历史文件后，当前文件内容将会被替换！")}),m({loading:"正在恢复历史文件，请稍后...",request:Yl({filename:"".concat(s.value.path,"/").concat(s.value.name),history:e.st_mtime}),success:e=>{e.data.status?(r.success("恢复成功"),l()):r.error("恢复失败")}})},checkList:d,ownerOptions:[{label:"root",value:"root"},{label:"www",value:"www"},{label:"mysql",value:"mysql"}],checkNumber:e=>{d.checkNumber=e;const t=String(e).replace(/[^\d]/g,"").slice(0,3);d.auth=t,f(Number(d.auth))},changeUser:e=>{d.user=e},setFileAuths:async()=>{let e=d.auth.toString();if(e.length>3)return void r.error("请输入正确权限");if(d.checkNumber.match(/\D/g))return void r.error("请输入正确权限");if(e.match(/\D/g))return void r.error("请输入正确权限");for(;e.length<3;)e="0"+e;var t;(await m({loading:"正在设置文件权限，请稍后...",request:(t={filename:"".concat(s.value.path,"/").concat(s.value.name),user:d.user,access:e,all:d.isDir?"True":"False"},a.post("files/SetFileAccess",{data:t,check:"msg"})),message:!0,success:l})).status||setTimeout(()=>{h()},500)},reversePermission:()=>{let e=0;const t=(t,a,l,s)=>{t.includes("r")&&(e|=a),t.includes("w")&&(e|=l),t.includes("x")&&(e|=s)};for(t(d.owner,256,128,64),t(d.group,32,16,8),t(d.public,4,2,1),d.auth=e.toString(8);d.auth.length<3;)d.auth="0"+d.auth},getFileAuths:h}}),ko=We("FILES-RECYCLE-BIN-STORE",()=>{const e=gc(),{recyclingBinStatus:t}=et(e),{getRealTask:l}=e,s=Ne("all"),i=Ne(!1),c=Ne(null),u=Ne(null),p=Ke({data:{},status:!1,statusDB:!1,type:"all",p:1,limit:10,search:"",time:[]}),d=Ne(),h=Ne(!1),g=async(e,t)=>{s.value=e,P.p=1,S.value=[],T.value="",p.type=s.value,p.time=[],p.search="","db"===e?(z.value="all",await F({type:"db"})):(z.value=e,await F({type:e}))},y=()=>{var e,t,a,l,i;const n="db"===s.value;d.value={list:(null==(e=p.data)?void 0:e.list)||[],type:n||"db"!==p.type?p.type||"db":z.value,num:void 0===(null==(t=p.data)?void 0:t.search_num)?null==(a=p.data)?void 0:a[n?s.value:z.value]:null==(l=p.data)?void 0:l.search_num,size:(null==(i=p.data)?void 0:i.all_size)||0},w.value=n?p.statusDB:p.status},b=async(e,a=!0)=>{e&&e.time_search&&(p.time=e.time_search),e&&e.search?p.search=e.search:e&&""===e.search&&(p.search=""),e&&e.type&&(p.type=e.type);const l={type:p.type,p:p.p,limit:p.limit,search:p.search,time_search:p.time,...e};a&&(i.value=!0);const s=await jl(l);i.value=!1,p.data=s.data,p.status=s.data.status,t.value=s.data.status,p.statusDB=s.data.status_db,y()},w=Ne(!1),S=Ne([]),k=Ne(""),T=Ne(""),L=Ne(!1),E=Ke({resultData:[],resultColumn:[{label:"数据库",prop:"file"}],resultTitle:""}),x=Ne(),C=Ke({disabledDate:e=>{const t=new Date;t.setHours(23,59,59,999);const a=t.getTime();return e.getTime()>a}}),D=async()=>{const e=await Al({type:"db",force:1});r.request(e),l(),b(),L.value=!1},I=Ne(),P=Ke({loading:!1,p:1,limit:10}),F=async(e,t=!0)=>{let a="";"db"===s.value?(z.value="all",a="db"):a=z.value,await b({p:P.p,limit:P.limit,type:a,...e},t)},R=async e=>{"db"===d.value.type?(await o({title:"恢复数据库".concat(e.name),content:"您确定要恢复数据库【".concat(e.name,"】，是否继续？")}),await m({loading:"正在恢复数据库，请稍后...",request:Vl({path:e.rname}),message:!0,success:e=>{e.status&&F()}})):(M.value=e,v({title:"恢复文件".concat(e.name),area:41,btn:"确定",component:()=>f(()=>import("./index152.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),onConfirm:G}))},N=async e=>{const t="db"===d.value.type?"数据库":"文件";await o({title:"删除".concat(t).concat(e.name),type:"input",input:{content:"删除".concat(t)},content:"风险操作，删除后，".concat(t,"将彻底消失，无法恢复，是否继续操作？")}),await m({loading:"正在删除，请稍后...",request:zl({path:e.rname}),success:t=>{1===t.tag?(E.resultData=[{file:e.rname}],E.resultTitle=t.msg,h.value=!1,L.value=!0):(r.request(t),F())}})},O=async e=>{const{data:t}=await Ml({name:e.name,rname:e.rname});t.status?window.open("/download?filename=".concat(t.msg.path)):r.error(t.msg)},j=async e=>{const{data:t}=await Ml({name:e.name,rname:e.rname});if("string"==typeof t.msg&&t.msg.includes("找不到文件"))return void r.error("当前文件不可预览");const a=t.msg.file.nm.split(".").pop();if("images"===Ar(a)){const e={path:t.msg.path};or(e)}else Br(t.msg)},A=Ne([zt({key:"rname"}),{label:"文件名",prop:"fileName",minWidth:150,render:e=>De("span",{class:"flex items-center"},[De("span",{class:["icon-bg",e.is_dir?"folder-icon":Object.keys(Vo).includes(jr(e.name,"file"))?Vo[jr(e.name,"file")]+"-icon":"file-icon"]},null),De("span",{class:"truncate w-[26rem]"},[e.name])])},{label:"原位置",prop:"dname",showOverflowTooltip:!0,render:e=>De("span",{class:"truncate"},[e.dname])},{label:"大小",width:90,render:e=>_(e.size)},{label:"删除时间",width:145,render:e=>n(e.time)},Mt([{title:"下载",isHide:e=>e.is_dir,onClick:O},{title:"查看",isHide:e=>e.is_dir,onClick:j},{title:"恢复",onClick:R},{title:"删除",onClick:N}])]),V=[{label:"恢复",value:"recover",event:async(e,t,a,l,s)=>{const i=async e=>await Vl({path:e.rname});await e({title:"批量恢复",content:"批量恢复选中后，被删除将会恢复，是否继续操作？",column:[{prop:"rname",label:"名称"},qt()],onConfirm:async()=>(await t(i),F(),!1)})}},{label:"删除",value:"delete",event:async(e,t,l,s,i)=>{(async(e,t)=>{const l="db"===d.value.type?"数据库":"文件";var s;await o({title:"删除".concat(l),type:"input",input:{content:"删除".concat(l)},isHtml:!0,content:"风险操作，删除后，".concat(l,"将彻底消失，无法恢复，是否继续操作？")}),await m({loading:"正在批量删除，请稍后...",request:(s={path_list:e.map(e=>e.rname)},a.post("files/Batch_Del_Recycle_bin",{data:s,check:"msg"})),success:e=>{let a=[];e.success.forEach(e=>{a.push({name:e,msg:"删除成功",status:!0})}),Object.keys(e.error).forEach(t=>{a.push({name:t,msg:e.error[t],status:!1})}),mc({resultData:a,resultTitle:"删除"}),t(),F()}})})(l.value,i)}}],z=Ne("all"),M=Ne(),q=Ke({type:"before",path:""}),H=Ne(!1),B=Ne(),U=Ke({path:[{validator:(e,t,a)=>{""===t&&"path"===q.type?a(new Error("请选择恢复目录")):a()},trigger:["blur"]}]}),G=async()=>{await B.value.validate();return(await m({loading:H,request:Vl({path:M.value.rname,rpath:"path"===q.type?"".concat(q.path,"/").concat(M.value.name):M.value.dname}),message:!0,success:e=>{e.status&&F()}})).status};return{activeName:s,loading:i,binData:p,compData:d,watchBinData:y,handleTabChange:g,statusSwitch:w,time:S,popupData:E,showPopup:L,searchName:T,pickerOptions:C,formatDate:k,onCancel:()=>{L.value=!1},showPlayer:()=>{x.value.focus()},cleanBin:async()=>{let e=null;try{await o({title:"清空回收站",type:"input",input:{content:"清空回收站"},isHtml:!0,content:'<span class="text-[red]">清空回收站后，回收站'.concat("db"===s.value?"【所有数据库】":"【所有暂存文件】","将彻底消失，无法恢复，是否继续操作？</span>")}),e=r.load("正在清空回收站，请稍候...");const t=await Al({type:"db"===s.value?"db":"files"}),{fail_list:a}=t;if(a&&(null==a?void 0:a.length)>0&&"db"===s.value){const e=a.map(e=>({file:e}));E.resultData=e,E.resultTitle=t.msg,h.value=!0,L.value=!0}else r.request(t);l(F),F()}catch(t){}finally{e&&e.close()}},clearTime:()=>{S.value=[]},setStatus:async e=>{let t={};e&&(t.db=1);const l=await(s=t,a.post("files/Recycle_bin",{data:s,check:"msg"}));var s;r.request(l.data),b()},goSearch:()=>{b({search:T.value})},changeClearCheck:D,watchTime:()=>{var e;const t={time_search:[]};2===(null==(e=S.value)?void 0:e.length)?(S.value[0]=new Date(S.value[0]).setHours(0,0,0,0),S.value[1]=new Date(S.value[1]).setHours(23,59,59,0),t.time_search=JSON.stringify([S.value[0]/1e3,S.value[1]/1e3])):(k.value="",t.time_search=JSON.stringify([])),b(t,!1)},dbTableRef:c,tableRef:I,fileTableRef:u,tableData:P,tableColumn:A,tableBatchOptions:V,deleteClearCheck:async()=>{if(h.value)return void D();const e=await zl({path:E.resultData[0].file,force:1});r.request(e),L.value=!1,F()},refresh:F,tabActive:z,config:[{type:"all",label:"全部",icon:"svgtofont-left-soft"},{type:"dir",label:"文件夹",icon:"svgtofont-left-files"},{type:"file",label:"文件",icon:"svgtofont-file-text"},{type:"image",label:"图片",icon:"svgtofont-icon-term"},{type:"ont_text",label:"文档",icon:"svgtofont-el-document"}],toggleType:e=>{P.p=1,z.value=e,F({type:e},!1)},rowData:M,isCmdLoading:H,cmdForm:q,cmdFormRef:B,cmdRules:U,openFile:()=>{qu({type:"dir",change:e=>{q.path=e}})},clearSpace:e=>{q.path=q.path.replace(/\s+/g,"")},init:()=>{p.type=s.value,g(s.value)},$reset:()=>{s.value="all",i.value=!1,Object.assign(p,{data:{},status:!1,statusDB:!1,type:"all",p:1,limit:10,search:"",time:[]}),w.value=!1,S.value=[],k.value="",T.value="",L.value=!1,Object.assign(E,{resultData:[],resultColumn:[{label:"数据库",prop:"file"}],resultTitle:""}),Object.assign(P,{loading:!1,p:1,limit:10}),z.value="all"},$resetCmdForm:()=>{H.value=!1,Object.assign(q,{type:"before",path:""})}}}),To=We("FILES-LIST-VIEW-STORE",()=>{const e=gc(),{mainHeight:t,authType:l,fileTabActiveData:s,navBtnHeight:i,imageList:n,imgPathItem:c,isNoCreteItem:u,createListType:p,globalTamperStatus:d,dataList:m,fileBatchNum:h,diskAnalysis:f}=et(e),{refreshFilesList:v,watchCreateListType:g,watchDeleteFileData:y}=e,b=window.location.protocol+"//"+window.location.host+"/download?filename=",_=Ne([{label:"文件名称",id:"fileName",width:"42",sort:"",sortable:!0,class:"cursor-pointer"},{label:"企业级防篡改",width:"12"},{label:"权限/所有者",width:"15"},{label:"大小",width:"10",id:"size",sort:"",sortable:!0,class:"cursor-pointer"},{width:"16",label:"修改时间",id:"time",sort:"",sortable:!0,class:"cursor-pointer"},{label:"备注",width:"20"},{label:"操作",type:"operation",width:"30.4",class:"custom-operate custom-operate-head",style:{"justify-content":"flex-end","padding-right":" 2.8rem",display:"flex",position:"sticky",right:0,background:"var(--el-fill-color-light)",flex:1}}]),w=Ne(null),S=Ne(!1),k=Ne(null);Qe([]);const T=Ne([]),L=Ne(!1),E=Ne([]),x=Ne(0),C=Ne(!0),D=Ne(null),I=Ne(0),N=Ne(0),O=e=>{(async e=>{if(yr(e.fileName))return r.error('文件名不能包含以下字符：\\ / : * ? " < > |'),e.isReName=!0,void(u.value=!0);if(u.value=!1,e.isNew){if(p.value="",g(""),""===e.fileName)return void y(e);const t=await Il({path:br(e.fileName),type:e.type});t.status&&(await v(),e.isReName=!1,"file"===e.type&&setTimeout(()=>{const t=m.value.find(t=>t.fileName===e.fileName);t&&Ur(t)},100)),y(e),r.request(t)}else{if(e.fileName===e.oldName)return void(e.isReName=!1);let t=r.load("正在重命名，请稍候...");const a=await Dl({sfile:br(e.oldName),dfile:br(e.fileName),rename:!0});t.close(),a.status?(e.isReName=!1,r.success(a.msg)):r.error(a.msg),v()}})(e)};let j=null;const A=e=>{const t=Array.from(e.target.classList);return!(t.includes("checkbox--icon")||t.includes("size-link")||t.includes("svgtofont-el-loading")||t.includes("el-input__inner"))};let V=null,z={top:0,left:0},M={top:0,left:0},q=0;const H=e=>{if(2===e.button||e.target.closest(".el-input__inner"))return;const t=document.getElementById("drugBox");if(t&&t.remove(),V){const t=V.getBoundingClientRect().top,a=V.getBoundingClientRect().left;z={top:e.clientY-t,left:e.clientX-a}}document.addEventListener("mousemove",B),document.addEventListener("mouseup",U)},B=e=>{const t=document.getElementById("drugBox");if(t&&t.remove(),V){const t=V.getBoundingClientRect().top,a=V.getBoundingClientRect().left;M={top:e.clientY-t>0&&e.clientY-t<V.offsetHeight?e.clientY-t:e.clientY-(t+V.offsetHeight)>1?V.offsetHeight:0,left:e.clientX-a>0&&e.clientX-a<V.offsetWidth?e.clientX-a:e.clientX-(a+V.offsetWidth)>1?V.offsetWidth:0};const l=(null==V?void 0:V.scrollTop)||0,s={top:M.top>z.top?z.top+l:M.top+l,left:M.left>z.left?z.left:M.left};let i=Math.min(Math.abs(M.left-z.left),a+V.offsetWidth-s.left),n=Math.min(Math.abs(M.top-z.top),t+V.offsetHeight-s.top+l);if(e.clientY-t<0){const a=Math.abs(e.clientY-t);V.scrollTop-=a,0!=V.scrollTop&&(q+=a),n+=q}if(e.clientY-(t+V.offsetHeight)>1){const a=e.clientY-(t+V.offsetHeight);V.scrollTop+=a,V.scrollHeight-V.scrollTop!=V.clientHeight&&(q+=a),n+=q,s.top-=q}if(z.top==M.top||z.left==M.left)return!0;const o=document.createElement("div");o.classList.add("absolute","border","top-0","border-[var(--el-base-supplement-dark)]","bg-[var(--el-base-supplement-light-7)]","opacity-[0.15]","overflow-hidden"),o.id="drugBox",V.appendChild(o),o.style.left=s.left+"px",o.style.top=s.top+"px",o.style.width=i+"px",o.style.height=n+"px";const r=document.getElementById("drugBox");if(V&&r){const e=r.offsetTop,t=r.offsetTop+r.offsetHeight;let a=[];J.value.forEach((l,s)=>{const i=l.offsetTop,n=l.offsetTop+l.offsetHeight,o=m.value[s];n>=e&&i<=t&&a.push(o.path)});const l=new Set(a),s=new Set(T.value);l.size===s.size&&[...l].every(e=>s.has(e))||(T.value=[...l],te()),T.value.length>0&&T.value.length===m.value.length?Y.value=!0:Y.value=!1}}},U=e=>{e.preventDefault(),e.stopPropagation(),document.removeEventListener("mousemove",B),document.removeEventListener("mouseup",U);const t=document.getElementById("drugBox");t&&t.remove()},G=e=>{T.value=e.map(e=>e.path),te()},J=Ne([]),W=()=>{J.value=[];for(let e=0;e<m.value.length;e++)J.value.push({offsetTop:36*e,offsetHeight:36});J.value.length&&(N.value=J.value[J.value.length-1].offsetTop,N.value<=t.value-(i.value||64)-266?C.value=!1:C.value=!0)},$=()=>{Oe(()=>{for(let e=0;e<n.value.length;e++){const t=n.value[e];m.value.forEach(e=>{e.fileName===t[0]&&t[1]&&(e.isSmallImage=t[1])})}E.value=m.value.filter(e=>void 0!==e.isSmallImage).map(e=>"".concat(b).concat(e.path))})},Y=Ne(!1),K=e=>{var t;2===e.button&&"INPUT"===e.target.tagName&&e.preventDefault(),e.target.closest(".scrollTable")||e.target.closest(".v-contextmenu")||null==(t=w.value)||t.hide()},Q=Ne(0),X=Ne(null),Z=Ne(null),ee=async()=>{try{const e=await P({sName:"disk_analysis"});(e.data.status||"ltd"===l.value)&&Ju({name:e.data.name,type:"i",pluginInfo:e.data,softData:e.data})}catch(e){}},te=()=>{let e=m.value.filter(e=>T.value.includes(e.path));h.value=e},ae=()=>{Oe(()=>{V=document.querySelector(".scrollTable"),null==V||V.addEventListener("mousedown",H)})};return{mainHeight:t,authType:l,diskAnalysis:f,headData:_,dataList:m,selectList:T,fileBatchNum:h,checkedAll:Y,imgPathItem:c,imgIndex:x,showViewer:L,imgList:E,scrollHeight:I,scrollHeightBottom:N,isShowShadow:C,context:w,contextRow:k,isBatch:S,scrollRef:D,imageList:n,navBtnHeight:i,fileTabActiveData:s,bindMouseDown:ae,buyPlugin:()=>{f.value.isBuy||"ltd"===l.value?ee():Gu({sourceId:140,disablePro:!0})},clickName:e=>{if("dir"===e.type)wr(e.path);else{const t={"查看图片":["jpg","png","gif","jpeg"],"播放视频":["mp4","avi","mov","rmvb","rm","flv","3gp","wmv","mkv","mpeg","mpg","ts","webm","vob","swf"],"解压文件":["zip","rar","gz","war","tgz","7z","tar.gz","tar"],"播放音频":["mp3","wav","wma","ogg","ape","flac","aac","m4a"]},a=e.ext;let l="查看文档";for(const e in t)if(t[e].includes(a)){l=e;break}j&&j.close(),j=r.msg({customClass:"no-icon !z-10",message:"双击".concat(l),type:"info"})}},handleBlurCheck:()=>{const e=m.value.find(e=>e.isReName);O(e)},handleEvent:(e,t)=>{var a;if(null==(a=w.value)||a.hide(),R()&&e instanceof MouseEvent)return;const l=(new Date).getTime(),s=l-Q.value;var i,n;s<300&&s>0&&Z.value===t?(null!==X.value&&clearTimeout(X.value),i=e,n=t,j&&j.close(),A(i)&&(n.isPs||n.isReName||Ur(n))):(Z.value=t,X.value=window.setTimeout(()=>{((e,t)=>{const a=Array.from(e.target.classList);A(e)&&(a.includes("fileName")||(T.value=[t.path],te()))})(e,t)},300)),Q.value=l},handleRightClick:(e,t)=>{var a,l;e.preventDefault(),e.stopPropagation();const s=t?t.path:null;var i;if((t&&(i=s,!T.value.find(e=>e===i))||0===e.button)&&(T.value=[],T.value.push(s),te()),T.value.length>1&&t&&2===e.button){S.value=!0;let t=[];return m.value.forEach(e=>{T.value.includes(e.path)&&t.push(e)}),k.value=t,void(null==(a=w.value)||a.show(e))}S.value=!1,k.value=t||null,t||(T.value=[],te()),null==(l=w.value)||l.show(e)},handleCheckFile:e=>{new Set(T.value).has(e.path)?T.value=T.value.filter(t=>t!==e.path):T.value.push(e.path),Y.value=T.value.length===m.value.length,te()},handleCheckAll:e=>{G(e?m.value:[]),Y.value=e},handleFileLock:async e=>{if("ltd"===l.value)if(d.value.status)cr(e);else{const{data:e}=await P({sName:"tamper_core"});e.setup?F(d.value.tip)?r.error("企业级防篡改未安装或版本较低，请检查插件状态。"):r.error("“".concat(d.value.tip,"”请前往【企业级防篡改】启动服务。")):await Ju({name:e.name,type:"i",pluginInfo:e})}else Gu({sourceId:71})},handleEnPsView:e=>{e.isOsPs||(e.oldPs=e.ps,e.isPsEdit=!0)},handleLvPsView:async(e,t)=>{t.isOsPs||e.target.children[1].contains(document.activeElement)||(t.isPsEdit=!1)},handleSetPs:async e=>{if(e.ps!==e.oldPs){let l=r.load("正在设置备注，请稍候...");const s=await(t={filename:e.path,ps_type:0,ps_body:e.ps},a.post("files/set_file_ps",{data:t,check:"msg"}));s.status?(e.isPsEdit=!1,r.success(s.msg)):r.error(s.msg),l.close()}else e.isPsEdit=!1;var t},handleReName:e=>{e.oldName=e.fileName,e.isReName=!0},openImgView:e=>{x.value=E.value.findIndex(t=>t==="".concat(b).concat(e.path)),L.value=!0},opearationIconClick:async(e,t)=>{const a={top:"置顶",favorite:"收藏",share:"分享"};try{switch("share"!=t&&await o({title:"提示",isHtml:!0,content:"取消【".concat(e.fileName,"】的").concat(a[t],"，是否继续？")}),t){case"top":Pr(e,e.isTop?"unset":"set");break;case"favorite":Ir(e,()=>e.isFav=!1);break;case"share":Jo(e)}}catch(l){}},onReNameKeyup:O,sortTable:e=>{e.sortable&&(_.value.forEach(t=>{t.id!==e.id&&(t.sort="")}),"asc"===e.sort?e.sort="desc":"desc"===e.sort?e.sort="":e.sort="asc",s.value.param.sort=""!=e.sort?e.id:"",s.value.param.reverse="asc"==e.sort?"False":"True",v())},calcFileListHeightFn:W,setSmallImage:$,closeImgPreView:()=>{L.value=!1},findCurrentImgIndex:e=>{x.value=E.value.findIndex(t=>t===e),L.value=!0},watchDataList:e=>{T.value=[],Y.value=!1,e.length&&(W(),$()),te(),Oe(()=>{var e;null==(e=D.value)||e.scrollToPosition(0)})},init:()=>{W(),ae(),D.value.$el.addEventListener("scroll",()=>{I.value=D.value.$el.scrollTop+(t.value-(i.value||64)-266),0===D.value.$el.scrollTop&&(I.value=0)}),(()=>{const e=_.value.find(e=>e.id===s.value.param.sort);e&&(e.sort="False"==s.value.param.reverse?"asc":"desc")})(),document.addEventListener("mousedown",K)},$reset:()=>{null==V||V.removeEventListener("mousemove",B),document.removeEventListener("mousedown",K)},calcFileListHeight:J,watchSelectListLength:te}}),Lo=We("FILES-ACE-MOBILE-STORE",()=>{const{mainHeight:e}=l(),t=Ne(),a=Ne();let s;const i=Ne(null),n=(e,t)=>{if(Tn(e),t){const e=t.currentTarget||t.currentTarget,a=i.value,l=a.offsetWidth,s=e.offsetLeft-l/2+e.offsetWidth/2;a.scroll({left:s,behavior:"smooth"})}},o=e=>{e.preventDefault();const{deltaY:t}=e;i.value.scrollLeft+=t},c=Ne(),u=async e=>{await Qi(),Ni.value=await en(e)},p=Ne(!1),d=Ne(null),m=Ne(!1),h=Ne(null),f=Ne([{title:"保存",icon:"svgtofont-el-select",click:()=>{y()&&In(ji)}},{title:"全部保存",icon:"svgtofont-icon-minmax-black",click:()=>{y()&&Rn()}},{title:"刷新",icon:"svgtofont-el-refresh-right",click:async()=>{y()&&wn(ji,!0)}},{title:"搜索",icon:"svgtofont-el-search",click:()=>{y()&&Ni.value.execCommand("find")}},{title:"替换",icon:"svgtofont-icon-log",click:()=>{y()&&Ni.value.execCommand("replace")}},{title:"文件足迹",icon:"svgtofont-left-crontab",click:()=>{ir()}},{title:"退出",icon:"svgtofont-el-close",click:()=>{g()}}]),v=async()=>{xi(),Yi(),D()},g=async()=>(await Nn()?fr(v):(localStorage.removeItem("aceEditor"),xn(),v()),!1),y=()=>!(!mn()||"custom"===ji.type)||(r.error("当前页面不支持该操作"),!1),b=Ne(null),_=Ne({}),w=e=>{const t=mi.value.getNode(e);t&&e.isNew&&mi.value.remove(t),t&&e.isReName&&(e.isReName=!1),pi.value=!1},S=(e,t)=>{w(_.value),wi(e,t,b)},k=e=>zi.value.some(t=>t.path===e.path)?"text-[#cca700]":"",T=Ne("btn"),L=Ne(!1),E=Ne(""),x=Ne([]),C=Ne(""),D=async()=>{const e=await a.value;null==e||e.unmount()};return{fileItem:t,instance:a,tabsElement:i,changeTab:n,getDataChangeTab:()=>{Oe(()=>{const e=zi.value[zi.value.length-1],t=i.value.children[zi.value.length-1];n(e.id,{currentTarget:t})})},closeTab:async e=>{Sn(e)},initHeader:()=>{Oe(()=>{i.value.addEventListener("wheel",o)})},$resetHeader:()=>{i.value&&i.value.removeEventListener("wheel",o)},editorRef:c,mainHeight:e,createEditorView:u,initContent:async()=>{await u(c.value),t&&await _n({title:t.value.fileName,type:"editor",path:t.value.path,size:t.value.size}),await vs({name:t.value.fileName,path:t.value.path}),await $i()},isShow:p,dropdownMenu:d,handleClickOutside:e=>{d.value&&!d.value.contains(e.target)&&(p.value=!1)},isShowTool:m,dropdownMenuRef:h,column:f,checkOperationAvailable:y,handleClickOutsideEvent:e=>{h.value&&!h.value.contains(e.target)&&(m.value=!1)},openPopup:e=>{mn?(m.value=!1,e.click()):r.error("当前页面不支持该操作")},treeProps:{label:"fileName",key:"path",isLeaf:"isFile"},loadNode:async(e,a,...l)=>{yi(e,a,t.value)},renderTree:(e,{node:t,data:a,store:l})=>{const{mode:s}=un(a.fileName),i=[e("span",{class:(a.isFile?"ace-".concat(s,"-icon ace-text-icon"):"ace-folder-icon")+" icon-editor-left",style:{"font-size":"4rem"}}),a.isReName?e():e("span",{class:"el-tree-node__label "+k(a),attrs:{title:a.fileName}},a.fileName)];return e("span",{class:"flex items-center ".concat(a.isReName?"newFiles":"defaultFiles"),on:{contextmenu:e=>{e.preventDefault(),S(e,a)}}},i)},handleExpandChange:e=>{(null==e?void 0:e.path)&&!ui.value.includes(e.path)&&ui.value.push(e.path)},handleCollapseChange:e=>{const t=ui.value.indexOf(null==e?void 0:e.path);-1!==t&&ui.value.splice(t,1),w(_.value)},initList:async()=>{Oe(()=>{const e=(t.value.path||"/www").split("/");e.pop(),ni.value=e.join("/")})},type:T,isCheck:L,searchValue:E,changeValue:e=>{ui.value.length=0,E.value="","search"===e?(x.value=oi.value,C.value=ni.value,oi.value=[],di.value=!0):(oi.value=x.value,ni.value=C.value)},searchFile:async()=>{const e=await gi(ni.value,E.value,L.value?"True":void 0);di.value=!1,e&&(oi.value=e,vi())},closeSearch:()=>{T.value="btn",vi()},close:D,init:()=>{Oe(()=>{s=setInterval(()=>{const e=document.querySelector(".el-overlay-dialog"),t=null==e?void 0:e.querySelector(".el-dialog__body");t&&(e&&(e.style.alignItems="flex-start",e.style.paddingTop="1vh",e.style.paddingBottom="1vh"),t.style.maxHeight="90vh",t.style.height="auto",t.style.overflowY="auto",t.style.WebkitOverflowScrolling="touch")},1e3)})},$reset:()=>{clearInterval(s)}}}),Eo={class:"dialog-btn-group"},xo=["title","data-state"],Co={class:"bt-dialog-content"},Do={key:1,class:"bt-dialog-footer"},Io=I(je({__name:"index",props:{title:{type:[String,Boolean],default:!1},area:{default:()=>["40%","40%"]},modal:{type:Boolean,default:!1},modelValue:{type:Boolean,default:!1},component:{default:""},compData:{default:()=>({})},fullscreen:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},footer:{type:Boolean,default:!1},zIndex:{default:999},customClass:{default:""},closeBtn:{default:"one"},onClose:{type:Function,default:()=>{}},onCancel:{type:Function,default:()=>{}},onConfirm:{type:Function,default:()=>{}},cancelText:{default:"取消"},confirmText:{default:"确定"}},setup(e){const t=e,a=Ne(),l=Ne(!1),s=Ne(!1),i=Ne(t.fullscreen),n=Ne({x:0,y:0}),o=Ne({x:!1,y:!1}),r=Ne([0,0]),c=Ne({x:0,y:0}),u=Ne(!1),p=Ne(!1),d=Ne([0,0]),m=yt(()=>{const[e,a]=t.area;return u.value?["100%","100%"]:p.value?["300px","44px"]:[e,a].map(e=>"number"==typeof e?"".concat(e,"rem"):e)}),h=yt(()=>u.value?{x:0,y:0}:p.value?l.value?o.value:{x:"190px",y:"90%"}:o.value),f=yt(()=>i.value||s.value?"two":t.closeBtn),v=(e=!1)=>{const{clientWidth:t,clientHeight:l}=a.value,s=(window.innerWidth-t)/2,i=(window.innerHeight-l)/2;o.value={x:"".concat(s,"px"),y:"".concat(i,"px")},e&&(r.value=[t,l],d.value=[r.value[0],r.value[1]])},g=e=>{if(u.value)return;const t=e.clientX,s=e.clientY,i=a.value.getBoundingClientRect();if(!l.value&&p.value){const e=i.left,t=i.top;c.value={x:e,y:t},o.value={x:"".concat(e,"px"),y:"".concat(t,"px")}}l.value||(l.value=!0);const r=t-i.left,d=s-i.top,m=e=>{let t=e.clientX-r,a=e.clientY-d;const l=window.innerWidth-i.width,s=window.innerHeight-i.height;t<0&&(t=0),a<0&&(a=0),t>l&&(t=l),a>s&&(a=s);const u=t-n.value.x,p=a-n.value.y;c.value={x:u,y:p},o.value={x:"".concat(u,"px"),y:"".concat(p,"px")}},h=()=>{document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",h)};document.addEventListener("mousemove",m),document.addEventListener("mouseup",h)},y=e=>{p.value=!0,l.value=!1},b=e=>{u.value=!0},_=e=>{u.value=!1,p.value=!1,Oe(()=>{v()})};return bt("fullData",_t(u)),wt(()=>{v(!0),(()=>{const e=Ze(e=>{if(u.value)return;const{height:t,width:a}=e[0].contentRect;if(s.value=t<=r.value[1],l.value){const e=a-(c.value.x+r.value[0]/2),l=t-(c.value.y+r.value[1]/2);e<0&&(c.value.x+=Number(e.toFixed(0)),o.value.x="".concat(c.value.x,"px")),l<0&&(c.value.y+=Number(l.toFixed(0)),o.value.y="".concat(c.value.y,"px"))}else v()},100);Et(document.body,e)})()}),(l,s)=>{const i=N;return He(),ot(Lt,{name:"dialog-fade"},{default:it(()=>[Je("div",{ref_key:"dialog",ref:a,class:St("bt-dialog-v2 ".concat(e.customClass)),style:kt({zIndex:e.zIndex,width:nt(m)[0],height:nt(m)[1],left:nt(h).x,top:nt(h).y})},[e.title?(He(),Be("header",{key:0,class:"bt-dialog-header",onMousedown:g},[Je("span",null,pt(e.title),1),Je("div",Eo,[nt(p)||nt(u)?rt("",!0):(He(),Be("span",{key:0,class:"icon",title:"最小化",onClick:Ge(y,["stop","prevent"])},[...s[2]||(s[2]=[Je("i",{class:"svgtofont-el-semi-select"},null,-1)])])),nt(u)||nt(p)?rt("",!0):(He(),Be("span",{key:1,class:"icon",title:"全屏",onClick:Ge(b,["stop","prevent"])},[...s[3]||(s[3]=[Je("i",{class:"svgtofont-icon-max-black"},null,-1)])])),nt(u)||nt(p)?(He(),Be("span",{key:2,class:"icon",title:nt(u)?"退出全屏":"恢复视图大小","data-state":nt(u)?"fullscreen":"minimize",onClick:Ge(_,["stop","prevent"])},[...s[4]||(s[4]=[Je("i",{class:"svgtofont-icon-minmax-black"},null,-1)])],8,xo)):rt("",!0),"one"===nt(f)?(He(),Be("span",{key:3,class:"ico-close-one",title:"关闭视图",onClick:s[0]||(s[0]=Ge((...t)=>e.onClose&&e.onClose(...t),["stop","prevent"]))},[...s[5]||(s[5]=[Je("i",{class:"absolute w-3rem h-3rem top-0 left-0 origin-center close-popup-btn"},null,-1)])])):rt("",!0),"two"===nt(f)?(He(),Be("span",{key:4,class:"icon",title:"关闭视图",onClick:s[1]||(s[1]=Ge((...t)=>e.onClose&&e.onClose(...t),["stop","prevent"]))},[...s[6]||(s[6]=[Je("i",{class:"!text-subtitleLarge svgtofont-el-close icon-group"},null,-1)])])):rt("",!0)])],32)):rt("",!0),Me(Je("article",Co,[(He(),ot(Tt(t.component)))],512),[[qe,!nt(p)]]),e.footer?Me((He(),Be("footer",Do,[De(i,{onClick:e.onCancel},{default:it(()=>[Ie(pt(e.cancelText),1)]),_:1},8,["onClick"]),De(i,{type:"primary",onClick:e.onConfirm},{default:it(()=>[Ie(pt(e.confirmText),1)]),_:1},8,["onClick"])],512)),[[qe,!nt(p)]]):rt("",!0)],6)]),_:1})}}}),[["__scopeId","data-v-ab605725"]]),Po=(e,t)=>{e.unmount(),t&&document.body.removeChild(t)},Fo=async e=>{const t=document.createElement("div"),a=(e=>w(e)?e.map(e=>(j(e)&&(e="".concat(e,"rem")),A(e)&&e.match(/[A-z\%]+/)?e:"".concat(e,"rem"))):j(e)?["".concat(e,"rem")]:A(e)&&(e.includes("rem")||e.includes("px")||e.includes("vw"))?[e]:["".concat(e,"rem")])(e.area),{footer:l,cancelText:s,confirmText:i}=(e=>{let{confirmText:t,cancelText:a}=e;return((null==e?void 0:e.footer)||(null==e?void 0:e.confirm))&&(t=t||"确认",a=a||"取消"),{footer:(null==e?void 0:e.footer)||!1,confirmText:t,cancelText:a}})(e);if("function"==typeof e.component){const t=null==e?void 0:e.component();O(t)?e.component=(await e.component()).default:t.default?e.component=t.default:e.component=t}const n=xt(Io,{...e,area:a,footer:l,cancelText:s,confirmText:i,modelValue:!0,onConfirm:async()=>{if(null==e?void 0:e.onConfirm){const a=await(null==e?void 0:e.onConfirm(n));return a&&Po(n,t),a}return Po(n,t),!0},onCancel:()=>{e.onCancel&&e.onCancel(n),e.onClose&&e.onClose(n),e.onCancel||e.onClose||Po(n,t)},onClose:()=>{e.onCancel&&e.onCancel(n),e.onClose&&e.onClose(n),e.onCancel||e.onClose||Po(n,t)}});return(e=>{const{modal:t}=e;if(t){const e=document.createElement("div");e.classList.add("dialog-mask"),e.style.zIndex="999",document.body.appendChild(e)}})(e),((e,t)=>{V(e),z(e),document.body.appendChild(t),e.mount(t),e.directive("loading",Ct.directive)})(n,t),n},Ro=d(),No=new Map([["/etc","PS: 系统主要配置文件目录"],["/home","PS: 用户主目录"],["/tmp","PS: 公共的临时文件存储点"],["/root","PS: 系统管理员的主目录"],["/home","PS: 用户主目录"],["/usr","PS: 系统应用程序目录"],["/boot","PS: 系统启动核心目录"],["/lib","PS: 系统资源文件类库目录"],["/mnt","PS: 存放临时的映射文件系统"],["/www","PS: 宝塔面板程序目录"],["/bin","PS: 存放二进制可执行文件目录"],["/dev","PS: 存放设备文件目录"],["/www/wwwlogs","PS: 默认网站日志目录"],["/www/server","PS: 宝塔软件安装目录"],["/www/wwwlogs","PS: 网站日志目录"],["/www/Recycle_bin","PS: 回收站目录,勿动"],["/www/server/panel","PS: 宝塔主程序目录，勿动"],["/www/server/panel/plugin","PS: 宝塔插件安装目录"],["/www/server/panel/BTPanel","PS: 宝塔面板前端文件"],["/www/server/panel/BTPanel/static","PS: 宝塔面板前端静态文件"],["/www/server/panel/BTPanel/templates","PS: 宝塔面板前端模板文件"],[M("backup_path"),"PS: 默认备份目录"],[M("sites_path"),"PS: 默认建站目录"]]),Oo=Ne([{name:"收藏夹",ename:"favorite",callback:()=>jo("favorite")},{name:"文件分享",ename:"fileShare",callback:()=>jo("fileShare")},{name:"文件同步",ename:"fileSync",callback:()=>jo("fileSync")},{name:"企业级防篡改",ename:"tamperProof",callback:()=>jo("tamperProof")},{name:"文件内容搜索",ename:"fileSearch",callback:()=>jo("fileSearch")}]),jo=e=>{const{openPlugin:t}=gc();switch(e){case"favorite":Bo();break;case"fileShare":Uo();break;case"fileSync":t("rsync",70);break;case"tamperProof":t("tamper_core",75);break;case"fileSearch":qo()}},Ao=["folder","folder-unempty","sql","c","cpp","cs","flv","css","js","htm","html","java","log","mht","php","url","xml","ai","bmp","cdr","gif","ico","jpeg","jpg","JPG","png","psd","webp","ape","avi","mkv","mov","mp3","mp4","mpeg","mpg","rm","rmvb","swf","wav","webm","wma","wmv","rtf","docx","fdf","potm","pptx","txt","xlsb","xlsx","7z","cab","iso","rar","zip","gz","war","bt","tgz","file","apk","bookfolder","folder-empty","fromchromefolder","documentfolder","fromphonefolder","mix","musicfolder","picturefolder","videofolder","sefolder","access","mdb","accdb","fla","doc","docm","dotx","dotm","dot","pdf","ppt","pptm","pot","xls","csv","xlsm","py","sh","json","lua","bt_split","bt_split_json"],Vo={sql:"sql",css:"css",js:"js",html:"html",java:"java",php:"php",xml:"xml",bmp:"bmp",cdr:"cdr",gif:"gif",ico:"ico",jpeg:"jpeg",jpg:"jpg",JPG:"jpg",png:"png",webp:"webp",avi:"avi",mkv:"mkv",mov:"mov",mp3:"mp4",mp4:"mp4",mpeg:"mpeg",mpg:"mpg",rm:"rm",rmvb:"rmvb",swf:"swf",webm:"webm",wma:"wma",wmv:"wmv","7z":"compress",rar:"compress",zip:"compress",gz:"compress",war:"compress",tgz:"compress","tar.gz":"compress",iso:"iso",apk:"apk",access:"access",doc:"doc",pdf:"pdf",ppt:"ppt",xls:"xls",bt_split:"split",bt_split_json:"join",javascript:"js",json:"json",log:"log",lua:"lua",py:"py",python:"py",recycle:"recycle",flac:"flac",sh:"sh"},zo={images:["jpg","jpeg","png","bmp","gif","tiff","ico","JPG","webp"],compress:["zip","rar","gz","war","tgz","7z","tar.gz","tar"],video:["mp4","mp3","mpeg","mpg","mov","avi","webm","mkv","mkv","mp3","rmvb","wma","wmv","flac","mov"],ont_text:["iso","xlsx","xls","doc","docx","tiff","exe","so","bz","dmg","apk","pptx","ppt","xlsb","pdf"]},Mo=e=>{const{instance:t}=et(Kn());return t.value=v({title:"实时任务队列",area:51,component:()=>f(()=>import("./index153.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),compData:{callback:i(e)?e:void 0},modal:!1}),t.value},qo=()=>v({title:"文件内容搜索",area:105,component:()=>f(()=>import("./index154.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)}),Ho=()=>{const e=Un(),{onConfirm:t}=e;return v({title:"创建软链接",area:50,btn:["确认","关闭"],component:()=>f(()=>import("./index155.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),onConfirm:t})},Bo=()=>{const e=Gn(),{instance:t}=et(e);return t.value=v({title:"管理收藏夹",area:85,component:()=>f(()=>import("./index156.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)}),t.value},Uo=()=>v({title:"分享列表",area:85,component:()=>f(()=>import("./index157.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)}),Go=e=>{const t=to(),{fileItem:a}=et(t),{onConfirm:l}=t;return a.value=e,v({title:"设置分享文件[ ".concat(e.fileName," ]"),area:45,btn:"生成外链",component:()=>f(()=>import("./index158.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),onConfirm:l})},Jo=(e,t)=>{const a=to(),{compData:l}=et(a),{onConfirmDetail:s}=a;return l.value={...e,isShareList:t},v({title:"外链分享-[".concat(e.path?e.path:e.filename,"]"),btn:"关闭分享外链",confirmBtnType:"danger",area:55,component:()=>f(()=>import("./detail.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),onConfirm:s})},Wo=e=>{const t=_o(),{compData:a}=et(t);return a.value={row:e},v({title:"【".concat(e.path,"】设置数据同步"),area:56,component:()=>f(()=>import("./index159.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),compData:{row:e}})},$o=()=>v({title:"文件操作记录",area:80,component:()=>f(()=>import("./index160.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),compData:{}}),Yo=(e,t)=>{const{activeName:a,fileItem:l}=et(So());return a.value=t,l.value=e,v({title:"[ ".concat(e.fileName," ] - 文件属性"),area:58,component:()=>f(()=>import("./index161.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)})},Ko=e=>{const t=ro(),{fileItem:a}=et(t),{onConfirm:l}=t;return a.value=e,v({title:"压缩文件",area:48,btn:"压缩",component:()=>f(()=>import("./index162.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),onConfirm:l})},Qo=e=>{const t=oo(),{fileItem:a}=et(t),{onConfirm:l}=t;return a.value=e,v({title:"解压文件[ ".concat(e.fileName," ]"),area:48,btn:"解压",component:()=>f(()=>import("./index163.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),onConfirm:l})},Xo=e=>{const t=lo(),{fileItem:a}=et(t),{onConfirm:l}=t;return a.value=e,v({title:"【".concat(e.fileName,"】文件拆分"),area:55,btn:"确定",component:()=>f(()=>import("./index164.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),onConfirm:l})},Zo=e=>{const t=io(),{fileItem:a}=et(t),{onConfirm:l}=t;return a.value=e,v({title:"合并【".concat(e.fileName,"】文件"),area:44,btn:"确定",component:()=>f(()=>import("./index165.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),onConfirm:l})},er=e=>{const t=ao(),{fileItem:a}=et(t),{onConfirm:l}=t;return a.value=e,v({title:"发送至邮箱",area:50,btn:"发送",component:()=>f(()=>import("./index166.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),onConfirm:l})},tr=e=>{const t=Wn(),{instance:a}=et(t);return a.value=v({title:"文件格式转换",area:78,component:()=>f(()=>import("./index167.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)}),a.value},ar=e=>{const t=Bn(),{fileItem:a,instance:l}=et(t);a.value=e,l.value=v({title:"压缩预览 --【".concat(e.fileName,"】"),area:74,component:()=>f(()=>import("./index168.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)})},lr=()=>{const e=document.getElementById("layout-footer"),t=null==e?void 0:e.getBoundingClientRect(),a=(null==t?void 0:t.width)||0,l=document.getElementById("layout-main"),s=null==l?void 0:l.getBoundingClientRect(),i=(null==s?void 0:s.width)||0;return(a||i)-32},sr=async(e,t)=>{const{fileItem:a,instance:l}=et(Di()),{onCancel:s}=Di(),{fileItem:i,instance:n}=et(Lo()),o=lr();a.value=e,i.value=e;const r=document.querySelectorAll(".el-overlay"),c=r[r.length-1],u=c?window.getComputedStyle(c).zIndex:null,p=Fo({title:"在线文本编辑器",area:o<1280?"100vw":143,customClass:"dialog-editor",zIndex:u?parseInt(u)+1:2012,component:()=>f(()=>import("./index169.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),fullscreen:!0,compData:{data:e,callback:t},onCancel:s});l.value=p,n.value=p},ir=()=>v({title:"文件历史版本",area:75,component:()=>f(()=>import("./index170.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)}),nr=e=>{const t=Xn(),{fileItem:a}=et(t),{onConfirm:l}=t;return a.value=e,v({title:"导入数据库",area:40,btn:"确定",component:()=>f(()=>import("./index171.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),onConfirm:l})},or=e=>{const{fileItem:t}=et(Qn());return t.value=e,v({area:75,component:()=>f(()=>import("./index172.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)})},rr=(e,t,a,l)=>{const s=no(),{compData:i}=et(s),{onConfirm:n}=s;return i.value={data:e,fileItem:t,name:a,path:l},v({title:"在线编辑",area:65,btn:"保存",component:()=>f(()=>import("./index173.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),onConfirm:n})},cr=(e,t)=>{const a=Yn(),{compData:l}=et(a),{onConfirm:s}=a;return l.value={data:e,temp_data:t},v({title:"【".concat(e.path,"】配置"),area:40,btn:!0,component:()=>f(()=>import("./index174.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),onConfirm:s})},ur=e=>{const{videoUrl:t}=et(Zn());return t.value=e.path,v({title:"视频播放",area:89,component:()=>f(()=>import("./index175.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)})},pr=()=>{const{instance:e}=et(so());return e.value=v({title:"宝塔终端",area:[80,50],component:()=>f(()=>import("./index176.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)}),e.value},dr=(e,t,a)=>{const l=ro(),{compData:s,instance:i}=et(l);return s.value={data:e,params:t,callback:a},i.value=v({title:!1,area:70,component:()=>f(()=>import("./index177.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)}),i.value},mr=e=>{const t=Hn(),{compData:a,instance:l}=et(t),{onConfirm:s}=t;return a.value=e,l.value=v({title:"".concat("upload"===e.type?"上传到"+e.zName:"从"+e.zName+"下载【勾选需要下载的文件】"),area:70,btn:["upload"===e.type?"上传":"下载","取消"],component:()=>f(()=>import("./index178.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),onConfirm:s}),l.value},hr=e=>{const t=qn(),{fileList:a}=et(t),{setFileAuths:l}=t;return a.value=e.map(e=>e.fileName),v({title:"设置权限【批量】",area:45,component:()=>f(()=>import("./index179.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),btn:!0,onConfirm:l})},fr=e=>{const{onConfirmCheckFile:t,onCancelCheckFile:a}=Di();return v({title:"温馨提示",area:[35,9],btn:["保存","不保存"],component:()=>f(()=>import("./index180.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),separationCancelClose:!0,onConfirm:a=>{t(),e()},onCancel:t=>{a(t),e()}})},vr=(e,t)=>{const a=Di(),{compDataClose:l}=et(a),{onConfirmClose:s,onCancelClose:i}=a;return l.value={type:e,item:t},v({title:"温馨提示",area:[35,9],btn:["保存","不保存"],component:()=>f(()=>import("./index181.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),separationCancelClose:!0,onConfirm:s,onCancel:i})},gr=({path:e,name:t},a)=>{const l=gc(),{fileTabList:s,fileTabActive:i,disabledCutTab:n,fileTabActiveData:o}=et(l);if(!e)return;if(n.value)return;let r=e,c=e;"/"===r?r="根目录":("/"===c[c.length-1]&&(c=c.slice(0,c.length-1)),r=e.split("/").pop()),t&&(r=t);const u={id:x(),label:r,type:o.value.type,loading:!1,total:0,list:[],param:{p:1,showRow:500,path:c}};n.value=!0,s.value.push(u),i.value=s.value.length-1,Oe(()=>{l.updateTabActiveData(),l.refreshFilesList(),a&&a(u)})},yr=e=>RegExp(/[\*\|\:\\\"\/\<\>\?]+/).test(e),br=e=>{const{fileTabActiveData:t}=et(gc());return _r(t.value.param.path+"/"+e)},_r=e=>e.replace("//","/"),wr=async e=>{const t=e.replace(/\/+$/,"")||"/",a=Sr(t);if("/.Recycle_bin"===e||"/www/.Recycle_bin"===e)return Ro.error("此为回收站目录，请在右上角按【回收站】按钮打开"),!1;const l=gc(),{fileTabActiveData:s,searchVal:i}=et(l);return s.value.param.p=1,l.updateTabActiveData({param:{path:a,search:""}}),l.refreshFilesList(),a},Sr=e=>"/"===(e=(e=e.replace(/\\/g,"/")).replace("//","/"))?e:e=e.replace(/\/+$/g,""),kr=e=>"dir"===e?"文件夹":"文件",Tr=(e,t)=>{e.isReName=!0,t&&t(e)},Lr=e=>{const t=document.createElement("div");return t.textContent=e,t.innerHTML},Er=async(e,t)=>{const a=gc(),{recyclingBinStatus:l}=et(a),{watchDeleteFileData:s}=a;if(null===l.value){const{data:e}=await jl({type:"all",search:"",time_search:JSON.stringify([])});l.value=e.status}const i=l.value?"删除【".concat(Lr(e.fileName),"】").concat("file"===e.type?"文件":"文件夹","后，该文件将迁移至文件回收站，如需彻底删除请前往文件回收站，是否继续操作？"):"风险操作，当前未开启文件回收站，删除的【".concat(Lr(e.fileName),"】").concat("file"===e.type?"文件":"文件夹","将彻底删除，无法恢复，是否继续操作？");await o({title:"删除".concat(kr(e.type),"【").concat(Lr(e.fileName),"】"),isHtml:!0,type:l.value?"default":"calc",content:'<div class="break-all">'+i+"<div>"+(e.isShare?'<span class="text-danger">当前文件已开启【外链分享】，请谨慎操作！</span>':"")}),await m({loading:"正在删除，请稍后...",request:Pl({path:br(e.fileName),type:e.type}),message:!0,success:a=>{a.status&&s(e),t&&t()}})},xr=async(e,t)=>{const l=await(s={path:br(e.fileName)},a.post("files/add_files_store",{data:{path:s.path},check:"msg"}));var s;l.status?(Ro.success(l.msg),t&&t()):Ro.error(l.msg),nc()},Cr=Ne(null),Dr=()=>{const{fileTabActiveData:e}=et(gc());"/"!==e.value.param.path?Cr.value=v({title:"上传文件到【".concat(e.value.param.path,"】 --支持断点续传"),area:"72",component:()=>f(()=>import("./index122.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),compData:{path:e.value.param.path},onCancel:()=>{Cr.value=null}}):Ro.error("不能直接上传文件到系统根目录!")},Ir=async(e,t)=>{const a=await Fl({path:br(e.fileName)});a.status?(Ro.success(a.msg),t&&t()):Ro.error(a.msg),nc()},Pr=async(e,t)=>{const l=gc(),s=await(i={path:br(e.fileName),type:t},a.post("/files/logs/set_topping_status",{customType:"model",data:{sfile:i.path,status:"set"===i.type?1:0},check:"msg"}));var i;s.status?Ro.success(s.msg):Ro.error(s.msg),l.refreshFilesList()},Fr=async e=>{const t=gc(),l=await(s={path:br(e.fileName)},a.post("/files/logs/copy_file_to",{customType:"model",data:{sfile:s.path},check:"msg"}));var s;l.status?Ro.success(l.msg):Ro.error(l.msg),t.refreshFilesList()},Rr=()=>{const{copyFilesData:e}=et(gc());e.value={files:[],type:""}},Nr=(e,t)=>{const a=$n(),{compData:l}=et(a);l.value={fileData:e,type:t},v({title:"重复文件提示",area:40,btn:["确认","取消"],component:()=>f(()=>import("./index182.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)})},Or=e=>{const{activeName:t,compData:a}=et(ko());return t.value="database"===e?"db":"all",a.value={type:e},v({title:"回收站",area:110,component:()=>f(()=>import("./index183.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)})},jr=(e,t)=>{if("dir"===t)return"folder";const a=e.split("."),l=a[a.length-1];for(let s=0;s<Ao.length;s++)if(Ao[s]==l)return Ao[s];return"file"},Ar=e=>{let t="text";return e&&(e=e.toLowerCase()),Object.entries(zo).forEach(([a,l])=>{l.forEach(l=>{l==e&&(t=a)})}),t},Vr=async()=>{const e=gc(),{fileTabActiveData:t,copyFilesData:a}=et(e);let l=null;const s=a.value.files[0],i=br(s.fileName);if("dir"===s.type&&t.value.param.path.indexOf(i+"/")>-1)return Ro.error("错误的复制逻辑，从".concat(i,"粘贴到").concat(t.value.param.path,"有包含关系，存在无限循环复制风险!")),!1;const n={path:t.value.param.path};1===a.value.files.length&&(n.name=s.fileName);const{data:o}=await Rl(n);if(o.length>0)return Nr(o,a.value.files.length>1?"batch":"single"),!1;Mr();try{if(l=Ro.load("正在粘贴，请稍候..."),a.value.files.length>1){const e=await ms({type:"copy"===a.value.type?1:2,path:t.value.param.path});Ro.request(e),a.value.files=[],Rr()}else{const e={sfile:s.path,dfile:i},t="copy"===a.value.type?await Nl(e):await Ol(e);t.status?("copy"===a.value.type?Ro.success(t.msg):Ro.success("剪切成功"),a.value.files=[],Rr()):Ro.error(t.msg)}}finally{l&&l.close(),clearTimeout(zr),e.refreshFilesList()}};let zr=null;const Mr=()=>{const{getRealTask:e}=gc();zr=setTimeout(()=>{e()},1500)},qr=async e=>{await Wi(),await Br(e),await vs({name:e.fileName,path:e.path}),await $i()},Hr=(e,t)=>{const{copyFilesData:a}=et(gc());e.path=br(e.fileName),a.value.files=[e],a.value.type=t,Ro.success("".concat("copy"===t?"复制":"剪切","成功，请在目标目录点击右上角【粘贴】按钮!"))},Br=async(e,t)=>{var a,l,s;const{unbindKeydown:i}=gc();i();const n={path:e.path,title:e.path.split("/").pop(),size:e.size,type:"editor"};if(null==(a=null==e?void 0:e.path)?void 0:a.includes("/dev/pts"))return void Ro.error("系统目录文件不支持编辑");if("text"!==Ar(null==(l=n.fileName)?void 0:l.split(".").pop()))return void Ro.error("暂不支持该类型文件编辑");const o=document.querySelector(".bt-dialog-header .svgtofont-icon-minmax-black");"minimize"!==(null==(s=null==o?void 0:o.closest(".icon"))?void 0:s.dataset.state)?Ni.value?_n(n):(await Wi(),sr(n,t)):Ji(n)},Ur=e=>{const{createItem:t}=et(gc()),{findCurrentImgIndex:a}=To();if(t.value=[],e.isNew||e.isReName)return!1;if("dir"===e.type)wr(e.path);else switch(Ar(e.ext)){case"images":a(window.location.protocol+"//"+window.location.host+"/download?filename="+e.path);break;case"video":ur(e);break;case"compress":Xr(e);break;default:Br(e)}},Gr=(e,t)=>{window.open("/download?filename="+encodeURIComponent(e.path),"_self","noopener,noreferrer"),t&&t()},Jr=e=>{Xo(e)},Wr=e=>{Zo(e)},$r=e=>{Go(e)},Yr=e=>{Jo(e)},Kr=async e=>{const{authType:t}=et(gc());"ltd"!==t.value?Gu({disablePro:!0,sourceId:70,plugin:!1}):Wo(e)},Qr=e=>{Ko(e)},Xr=e=>{Qo(e)},Zr=e=>{const t=Wn(),{fileItem:a}=et(t);a.value=e,tr()},ec=e=>{er(e)},tc=(e,t)=>{t||(t="routine"),Yo(e,t)},ac=()=>{Dr()},lc=async(e,t)=>{const{fileTabActiveData:a,copyFilesData:l}=et(gc()),s={data:JSON.stringify(e.map(e=>e.fileName)),type:0,path:a.value.param.path};switch(t){case"copy":s.type=1;break;case"cut":s.type=2}const i=await ds(s);i.status?(Ro.success("".concat("copy"===t?"复制":"剪切","成功，请在目标目录点击右上角【粘贴】按钮!")),l.value.files=e,l.value.type=t):Ro.error(i.msg)},sc=async e=>{const t=gc(),{fileTabActiveData:a,recyclingBinStatus:l}=et(gc()),s=l.value?"删除后，文件将迁移至文件回收站，如需彻底删除请前往文件回收站，是否继续操作？":"风险操作，当前未开启文件回收站，删除后将彻底删除，无法恢复，是否继续操作？";await o({title:"批量删除文件",type:l.value?"default":"calc",content:s}),await m({loading:"正在删除，请稍后...",request:ds({data:JSON.stringify(e.map(e=>e.fileName)),type:4,path:a.value.param.path}),message:!0,success:e=>{e.status&&t.refreshFilesList()}})},ic=({path:e,name:t},a)=>{const l=gc(),{fileTabList:s,disabledCutTab:i,fileTabActive:n}=et(l);if(!e)return;if(i.value)return;let o=e,r=e;"/"===o?o="根目录":("/"===r[r.length-1]&&(r=r.slice(0,r.length-1)),o=e.split("/").pop()),t&&(o=t);const c={id:x(),label:o,type:"list",loading:!1,total:0,list:[],param:{p:1,showRow:500,path:r}};i.value=!0,s.value.push(c),n.value=s.value.length-1,Oe(()=>{l.updateTabActiveData(),l.refreshFilesList(),a&&a(c)})},nc=async()=>{const{favoriteList:e}=et(gc());await m({request:a.post("files/get_files_store",{check:"array"}),data:[Array,e]})},oc=async()=>{const{diskList:e}=et(gc()),{data:t}=await a.post("system/GetDiskInfo",{check:"array"});e.value=t},rc=e=>{const t=gc(),{fileTabList:a,fileTabActive:l}=et(t);let s=e;"/"===s[s.length-1]&&"/"!==s&&(s=s.slice(0,s.length-1));const i=a.value.findIndex(e=>e.param.path===s);-1!==i?(l.value=i,t.updateTabActiveData(),t.refreshFilesList()):ic({path:e})},cc=e=>({icon:"icon-".concat(e),ext:"dir"==e?" folder":"",fileName:"新建".concat("dir"==e?"文件夹":"文本"),time:"",ps:"",size:0,type:e,user:"root",rootLevel:"0",isLink:"",isShare:!1,isTop:!1,isFav:!1,isOsPs:!1,isPsEdit:!1,isSearch:!1,isReName:!0,isNew:!0,isSync:"",isLock:!1,path:"",tamperProofId:0,isFile:"dir"!==e}),uc=(e,t,a="0;0",l,s=[])=>{const i=((e,t)=>{let a="",l=No.get("".concat("/"===t?"/":"".concat(t,"/")).concat(e));switch(e){case".htaccess":a="PS: Apache用户配置文件(伪静态)";break;case"swap":a="PS: 宝塔默认设置的SWAP交换分区文件"}return e.includes(".upload.tmp")&&(a="PS: 宝塔文件上传临时文件,重新上传从断点续传,可删除"),e.includes(".user.ini")&&(a="PS: PHP用户配置文件(防跨站)!"),l&&(a=l),l||a})(t.nm,l),o="1"===a.split(";")[0],r=a.split(";")[1],c=jr(t.nm,e),u=((e,t)=>"".concat(e,"/").concat(t).replace("//","/"))(l,t.nm);return{icon:Ar(c),ext:c,fileName:t.nm,time:n(t.mt),ps:i||t.rmk||"",size:t.sz,type:e,user:t.user,rootLevel:t.acc,isLink:t.lnk,isShare:0!=Number(t.durl)?t.durl:0,isTop:!!t.top,isFav:!!Number(t.fav),isOsPs:!F(i)&&""!==i,isPsEdit:!1,isSearch:!0,isReName:!1,isNew:!1,isSync:pc(s,u),isLock:o,path:u,tamperProofId:Number(r),isFile:"dir"!==e}},pc=(e,t)=>{if(F(e)||0==e.length)return"";const a=e.find(e=>e.path===t);return a?a.type:""},dc=e=>e.map(e=>({val:e.val,label:e.val})),mc=(e,t)=>{v({title:(null==e?void 0:e.title)||"批量操作结果",area:t||42,component:()=>f(()=>import("./index125.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),compData:e})},hc=(e,t)=>{const a=window.innerWidth,l=window.innerHeight,s=t.offsetWidth,i=t.offsetHeight,n=e.clientX,o=e.clientY;let r=n;n+s>a&&(r=n-s);let c=o-(l-o<i?i:0);c<0&&(c=(l-i)/2),t.style.top=c+"px",t.style.left=r+"px"},fc=Object.freeze(Object.defineProperty({__proto__:null,BatchSetAuth:hr,CreateTerminalDialog:pr,FileCompressPreview:ar,FileCompressView:Ko,FileDecompressionView:Qo,FileFormatConversionView:tr,FileImageView:or,FileInputDatabaseView:nr,FileMergeView:Zo,FileOperationRecordView:$o,FileRecyclingBinView:Or,FileSearchView:qo,FileSetShareView:Go,FileSplitView:Xo,FileStatusDetailView:Yo,FilesAceEditor:sr,FilesCompressCoverView:dr,FilesHistoryRecordView:ir,ManageFavoritesView:Bo,SendEmailView:er,ShareDetailView:Jo,ShareListView:Uo,addFavorites:xr,addTab:ic,addTabEvent:gr,batchDelFile:sc,calculateContextMenuPosition:hc,calculatePopoverPosition:(e,t)=>{const a=window.innerWidth,l=window.innerHeight,s=t.offsetWidth,i=t.offsetHeight,n=e.clientX,o=e.clientY;let r=n;n+s>a&&(r=n-s);let c=o;return o+i>l&&(c=o-i),c<0&&(c=0),{top:c,left:r,el:t}},cloudStorageDialog:mr,copyFiles:Hr,createCompress:Qr,createCopy:Fr,createFile:cc,deCompressFile:Xr,defaultPS:No,delFavorites:Ir,delFileEvent:Er,determineFileType:Ar,downFile:Gr,editFilesDialog:rr,editorCloseDialog:vr,editorLeaveDialog:fr,exts:Ao,fileBatchSet:lc,fileMainType:zo,fileReName:Tr,fileRsyncView:Wo,fileTaskDialog:Mo,fileType:Vo,fileUploadDialog:Cr,formatFile:Zr,getDataType:kr,getDiskList:oc,getExtIcon:jr,getFavoriteList:nc,getViewportWidth:lr,getWholePath:br,isSyncType:pc,matchUnqualifiedString:yr,openAceEditor:Br,openDetail:tc,openEditorView:qr,openFile:Ur,openFileAsync:Kr,openFileMerge:Wr,openFileShare:Yr,openFileSplit:Jr,openFilesUpload:Dr,openResultDialog:mc,pasteFiles:Vr,pathJumpEvent:wr,path_check:Sr,recomList:Oo,reconstructionFile:uc,removeCopyOrCutData:Rr,renderHistoryList:dc,repetFileView:Nr,sendEmail:ec,setColumn:(e,t)=>{},setFileListActive:rc,setFileShare:$r,setToping:Pr,symbolicLinkView:Ho,temperDialog:cr,toRepeatPath:_r,uploadFiles:ac,videoPlayDialog:ur},Symbol.toStringTag,{value:"Module"})),vc=We("FILES-URL-DOWN-LOAD-STORE",()=>{const e=gc(),{fileTabActiveData:t}=et(e),{getRealTask:l}=e,s=Ke({url:"",path:t.value.param.path,filename:""}),i=Ne(!1),n=Ne(),o=Ke({url:[{validator:(e,t,a)=>{""===t?a(new Error("请输入正确的URL地址!")):q(t)?a():a(new Error("请输入正确的URL地址!"))},trigger:["blur"]}],filename:[{validator:(e,t,a)=>{""===t?a(new Error("请输入新文件名!")):yr(t)?a(new Error('文件名不能包含 /\\:*?"<>|符号!')):a()},trigger:["blur","change"]}]});return{quickForm:s,formDisabled:i,quickFormRef:n,quickRules:o,onConfirm:()=>{const e={...s};n.value.validate(async t=>{var s;t&&await m({loading:i,request:(s=e,a.post("files/DownloadFile",{data:s,check:"msg"})),message:!0,success:e=>{e.status&&l()}})})},onPathChange:()=>{qu({type:"dir",path:s.path,change:e=>{s.path=e}})},setName:e=>{const t=e.split("/");s.filename=t[t.length-1]},init:()=>{i.value=!1,Object.assign(s,{url:"",path:t.value.param.path,filename:""})}}}),gc=We("FILES-STORE",()=>{const e=l(),{mainHeight:t,mainWidth:s,payment:i}=e,{authType:n}=Ye(i.value),c={id:"label-1",label:"wwwroot",type:"list",loading:!1,total:0,param:{p:1,showRow:500,path:"/www/wwwroot",sort:"",reverse:"True"}},u=Ne(0),d=Ne(0),h=Ne({...c}),g=Ne([{...c}]),y=Ne(0),b=Ne(!0),w=Ne(),k=Ke({index:0,id:""}),T=Ne(0),L=Ne(0),E=Ne(!1),x=Ne(!1),C=Ne([]),D=Ne(0),I=Ne(h.value.param.path),R=Ne(),N=Ne(!0),O=Ne([]),j=Ne(0),A=Ke({showMore:!1,showUl:!1,list:[]}),V=Ne(""),z=Ne(),q=Ne(!1),W=Ne([]),$=Ne([]),Y=Ne({reqEnd:!1,isSetup:!1,isBuy:!1}),K=Ne(!1),Q=Ne(!1),X=Ne({isLock:!0,rootLevel:!0,size:!0,time:!0,ps:!0}),Z=Ne(""),ee=Ne([]),te=Ne(!1),ae=Ne([]),le=yt(()=>ae.value.length||0),se=Ne([]),ie=yt(()=>se.value.length||0),ne=Ne([]),oe=Ne([]),re=Ne([]),ce=Ne({status:!1,tip:""}),ue=Ne({}),pe=Ne({files:[],type:""}),de=Ne({}),me=Ne(""),he=Ne(!1),fe=(e={})=>{const t=g.value[d.value];e.param&&(e.param={...t.param,...e.param});const a={...t,...e};g.value.splice(d.value,1,a),Object.assign(h.value,a),V.value=h.value.param.search||"",q.value="True"===h.value.param.all,Fe.value=!1,I.value!==a.param.path&&(I.value=h.value.param.path,_e(I.value))},ve=()=>{const e=s.value-36;C.value=[],D.value=0,Oe(()=>{document.querySelectorAll(".tab-item").forEach(e=>{const t=e.getBoundingClientRect();C.value.push(t.width),D.value+=t.width});const t=D.value-e;L.value=t>0?t:0,ge(e)})},ge=e=>{const t=C.value.reduce((e,t,a)=>a<=d.value?e+t:e,0);if(t<=e)T.value=-1;else{if(d.value===g.value.length-1)return void(T.value=L.value);let a=t-e+20;x.value=!0,T.value=a}},ye=async e=>{const t=await S({status:-3}),a=document.querySelector(".realTaskDialog");t.data.length>0&&!a&&Mo(e)},be=Dt(()=>{r.error("不能直接上传文件到系统根目录!")},2e3),_e=e=>{if(!e)return;const t=e.split("/");if("/"===e)return O.value=[{name:"根目录",path:"/",show:!0,list:[]}];O.value=t.map((e,a)=>({name:""===e?"根目录":e,path:""===e?"/":t.slice(0,a+1).join("/"),show:!0,showFold:!1,loading:!1,list:[]})),we(),Oe(()=>{A.list=[],A.showMore=!1;const e=document.querySelectorAll(".path-group-item"),t=document.querySelector(".path-list-group"),a=Array.from(e).reduce((e,t)=>e+t.clientWidth+4,0);setTimeout(()=>{if(a>((null==t?void 0:t.clientWidth)||400)){let a=20;for(let l=e.length-1;l>=0;l--)a+=e[l].clientWidth,a>((null==t?void 0:t.clientWidth)||0)&&(O.value[l].show=!1,A.showMore=!0,A.list=O.value.slice(l+1));A.showMore&&(O.value[0].show=!1,A.list=O.value.slice(1))}},100)})},we=()=>{A.showUl=!1,O.value[j.value]&&(O.value=O.value.map(e=>({...e,showFold:!1}))),window.removeEventListener("click",we)},Se=Ne([{name:"文件名",key:"name",show:!0,disable:!0},{name:"防篡改",key:"isLock",show:!0,disable:!1,icon:!0},{name:"权限",key:"rootLevel",show:!0,disable:!1},{name:"大小",key:"size",show:!0,disable:!1},{name:"修改时间",key:"time",show:!0,disable:!1},{name:"备注",key:"ps",show:!0,disable:!1},{name:"操作",key:"action",show:!0,disable:!0}]),ke=[{type:"copy",icon:"copy-file-icon",label:"复制",handler:()=>lc(W.value,"copy")},{type:"cut",icon:"cut-file-icon",label:"剪切",hide:1370,handler:()=>lc(W.value,"cut")},{type:"compress",icon:"compress-file-icon",label:"压缩",hide:1446,handler:()=>Qr(W.value)},{type:"auth",icon:"authority-file-icon",label:"权限",hide:1610,handler:()=>hr(W.value)},{type:"delete",icon:"delete-file-icon",label:"删除",hide:1620,handler:()=>sc(W.value)}],Te=()=>{const{onConfirm:e}=vc();v({title:"URL链接下载",area:50,btn:!0,component:()=>f(()=>import("./index184.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),onConfirm:e})},Le=async(e,t)=>{if("ltd"===n.value)try{const{data:t}=await P({sName:e});if(!t.setup)return void Ju({name:t.name,type:"i",pluginInfo:t});Sp({name:e})}catch(a){}else Gu({sourceId:t})},Ee=()=>{Oe(()=>{ze(),He()})},xe=Ne(null),Ce=Ne(null),De=Ne(null),Ie=Ne(!1),Pe=Ne(""),Fe=Ne(!1),Re=Ne(!1),je=Ne([]),Ae=e=>{if("el-input__inner"===e.target.className||"TEXTAREA"===e.target.tagName)return;const t="list"===h.value.type,a=document.querySelector(".el-dialog__body")||document.querySelector(".el-dialog__container");if(a&&"none"!==a.style.display)return;let l=[];const{selectList:s}=et(To());if(je.value.forEach(e=>{s.value.includes(e.path)&&l.push(e)}),e.ctrlKey&&65===e.keyCode&&(e.preventDefault(),De.value.handleCheckAll(!0)),e.ctrlKey&&88===e.keyCode)switch(l.length){case 0:return;case 1:Hr(l[0],"cut");break;default:lc(l,"cut")}if(e.ctrlKey&&67===e.keyCode)switch(l.length){case 0:return;case 1:Hr(l[0],"copy");break;default:lc(l,"copy")}if(e.ctrlKey&&86===e.keyCode){if(0===pe.value.files.length)return;Vr()}if(113===e.keyCode)switch(l.length){case 0:return;case 1:Tr(l[0],t?xe.value.editRow:Ce.value.editFile)}if(13===e.keyCode)switch(l.length){case 0:return;case 1:if(l[0].isNew||l[0].isReName||l[0].isPs)return;Ur(l[0])}if(46===e.keyCode){if(0===l.length)return;if(l[0].isNew||l[0].isReName)return;sc(l)}},Ve=()=>{document.addEventListener("keydown",Ae)},ze=()=>{document.removeEventListener("keydown",Ae)},Me=e=>{""!==e&&1!=te.value&&(ee.value=[cc(e)],qe())},qe=()=>{je.value=[...ee.value,...ae.value,...se.value].map((e,t)=>(e.vid=t,e)),To().watchDataList(je.value)},He=()=>{Re.value=!1,fe({param:{search:""}}),Ve();const e=localStorage.getItem("copyOrCutData");e&&(pe.value=JSON.parse(e))},Be=async()=>{try{const t=h.value.param.path,{data:l}=await(e=t,a.post("/files/size/get_dir_path_size",{data:{path:e,is_refresh:!0},check:"msg",customType:"model"}));F(l.msg)||-1!=l.msg.indexOf("企业版")||r.error(l.msg);let s=l.list;for(let e in s)s["".concat(t,"/").concat(e)]=s[e];Pe.value=_(l.total_asize),setTimeout(function(){ae.value=ae.value.map(e=>(e.diskInfo=s[e.path],e.isDirComputed=!1,e)),qe()},300)}finally{Re.value=!1,Fe.value=!0}var e},Ue=()=>{Ge(),B("Path",h.value.param.path)},Ge=async()=>{ae.value=[],se.value=[],je.value=[];try{h.value.loading=!0;const e=(()=>{const e=JSON.parse(JSON.stringify(h.value.param));return"time"==e.sort&&(e.sort="mtime"),"fileName"==e.sort&&(e.sort="name"),void 0!==e.search&&""===e.search&&delete e.search,void 0!==e.all&&"True"!==e.all&&delete e.all,e})(),{status:t,msg:l,data:s}=await xl(e);if("True"==e.all&&s.is_max&&r.error("当前搜索结果已超出最大值3000条！"),!t&&void 0!==l){r.error(l);const e=h.value.param.path.split("/");e.pop();const t=e.join("/").replace(/\/+$/,"")||"/";if("/"===t)return;return fe({param:{path:t}}),void Ge()}const{path:i,dir:n,files:o,store:c,bt_sync:u,page:p,tamper_data:d,search_history:m,file_recycle:f}=s;let{dirs:v,files:g,msg:y,tip:b,rules:_}=d;const w=[],S="ok"===b;if(ce.value.status=S,ce.value.tip=S?"":b,re.value=dc(m),ae.value=[],n.forEach((e,t)=>{ae.value.push(uc("dir",e,y?"":v[t],i,u))}),se.value=[],o.forEach((e,t)=>{const a=uc("file",e,y?"":g[t],i);0===t&&S&&(ue.value=_.length>0?_.find(e=>e.pid===a.tamperProofId):void 0),"images"===a.icon&&w.push(a.fileName),se.value.push(a)}),w.length>0){const{data:e}=await(e=>a.post("files/get_images_resize",{data:e,check:"object"}))({return_type:"base64",height:45,width:45,files:w,path:i});ne.value=e?Object.entries(e.data):[],To().setSmallImage()}else ne.value=[];oe.value=c,Q.value=f;let k=i;k="/"===k?"根目录":i.split("/").pop(),fe({label:k,total:U(s.page),type:h.value.type||"list",param:{path:s.path}}),K.value=!1,await qe(),Je()}catch(e){p(e)}finally{h.value.loading=!1}},Je=()=>{Oe(()=>{const e=document.querySelector(".custom-tbody");e&&(he.value=36*je.value.length>e.clientHeight)})};return{isHaveScoller:he,authType:n,mainHeight:t,mainWidth:s,fileTabActive:d,fileTabActiveData:h,fileTabList:g,isAddTabs:b,closeTabs:k,favoriteList:oe,diskList:$,dataList:je,deleteFileData:de,imgPathItem:me,recyclingBinStatus:Q,copyFilesData:pe,navBtnHeight:u,imageList:ne,disabledCutTab:K,dirPath:I,pathInputRef:R,pathInputMode:N,pathListGroup:O,more:A,searchVal:V,searchRef:z,isChildren:q,contextRef:w,scrollWidth:T,showLeftArrow:E,showRightArrow:x,searchHistory:re,updateTabActiveData:fe,getFilesList:Ge,triggerEvent:e=>{e?nt(z).showPopover():nt(z).hidePopover()},searchEvent:async e=>{V.value=e,fe({param:{search:V.value,all:q.value?"True":"False"}}),await Ge()},getRealTask:ye,handleDragOff:e=>{var t,a;if(e.preventDefault(),"/"!==h.value.param.path){if(null==(t=null==e?void 0:e.dataTransfer)?void 0:t.items){Array.from(null==(a=null==e?void 0:e.dataTransfer)?void 0:a.items).some(e=>"file"===e.kind)&&(Cr.value||Dr())}}else be()},cutPathInputMode:async e=>{if(N.value=e,e){if(h.value.param.path===I.value)return;const e=I.value;if(e.length>0&&!e.includes("/"))return r.error("路径输入不符合规则"),void(I.value=h.value.param.path);if(0===e.length)return void(I.value=h.value.param.path);if((await(t={path:I.value},a.post("files/test_path",{data:t}))).data.exists){const t=await wr(e);I.value=t||e}else{try{await o({width:50,title:"路径不存在",content:"【".concat(e,"】路径不存在,是否创建并跳转?")})}catch(l){if("cancel"===l)return void(I.value=h.value.param.path)}await m({loading:"正在新建文件，请稍后...",request:Il({path:e,type:"dir"}),message:!0,success:t=>{t.status&&wr(e)}})}}else H(R.value);var t},cutDirPath:(e,t)=>{""===e&&(I.value="/"),R.value.blur(),ee.value=[],qe(),fe({param:{search:"",p:1,all:"False"}}),t||wr(e)},getPathListGroup:_e,getCurrentFoldDirList:async(e,t)=>{try{we(),O.value[t].showFold=!0,O.value[t].loading=!0;const{data:{dir:a}}=await xl({path:e,p:1,showRow:2e3});O.value[t].loading=!1,O.value[t].list=a.map(t=>({name:t.nm,path:"".concat(e,"/").concat(t.nm).replace(/\/+/g,"/")})),j.value=t,window.addEventListener("click",we)}catch(a){}},goBack:()=>{if(K.value)return;if(K.value=!0,"/"==h.value.param.path){if(""===h.value.param.search)return K.value=!1,r.error("当前目录为根目录");fe({param:{search:"",all:"False"}}),wr("/")}let e=h.value.param.path.split("/");e.pop(),fe({param:{search:"",all:"False"}});let t=e.join("/");wr(t)},closeOther:()=>{g.value=g.value.filter((e,t)=>t===k.index),k.index!==d.value&&Ue(),d.value=0,fe(),ve()},closeRight:()=>{g.value.splice(k.index+1);let e=g.value[k.index].param.path;d.value=k.index,h.value.param.path!==e&&(fe(),Ue()),fe(),ve()},watchTabsWidth:()=>{Oe(()=>{y.value=(()=>{const e=document.querySelector(".tabs");if(e)return e.getBoundingClientRect().width;return 0})();const e=document.querySelectorAll(".tab-item");let t=0;e.forEach(e=>{const a=e.getBoundingClientRect();t+=a.width}),b.value=y.value-t>160})},handleRightClick:(e,t,a)=>{Object.assign(k,{id:t.id,index:a}),w.value.show(e)},watchWindowResize:ve,watchScrollWidth:e=>{let t=e;E.value=0!=t&&-1!=t,-1===t&&(T.value=0,t=0),x.value=L.value>0&&t!=L.value;const a=document.querySelector(".tabs");a&&a.scrollTo({top:0,left:T.value,behavior:"smooth"})},cutTab:e=>{K.value&&d.value!==e||(d.value=e,K.value=!0,ee.value=[],fe(),Ue(),ve())},scrollLeft:()=>{const e=s.value-36;T.value<=e/2?T.value=0:T.value-=e/2},scrollRight:()=>{const e=s.value-36;if(L.value<=e/2)return void(T.value=L.value);let t=T.value+=e/2;t>L.value&&(t=L.value),T.value=t},closeTab:(e,t)=>{const a=g.value.length;if(1===a)return r.error("至少保留一个标签页");const l=g.value.findIndex(e=>e.id===t);g.value.splice(l,1),d.value>l?(d.value=d.value-1,fe()):d.value===l&&(K.value=!0,d.value=a-l===1?l-1:l,fe(),Ue()),ve()},fileBatchNum:W,createListType:Z,columnShow:X,cloudList:[{name:"百度云存储",icon:"baidu-cloud",command:"bos"},{name:"阿里云存储",icon:"alioss-cloud",command:"alioss"},{name:"腾讯云存储",icon:"tencent-cloud",command:"txcos"},{name:"华为云存储",icon:"huawei-cloud",command:"obs"}],actionsBtn:ke,fileBatchEvent:e=>{switch(e){case"copy":lc(W.value,"copy");break;case"cut":lc(W.value,"cut");break;case"compress":Qr(W.value);break;case"auth":hr(W.value);break;case"del":sc(W.value)}},handleChangeMenu:e=>{h.value.type!==e&&(fe({type:e}),h.value.type=e,Ee()),W.value=[];const{selectList:t}=et(To());t.value=[],De.value&&(De.value.selectList=[])},handleCommand:async e=>{var t;switch(e){case"upload":Dr();break;case"openUrlLinkDown":Te();break;case"bos":case"alioss":case"txcos":case"obs":const{data:l}=await a.post("/files/upload/get_oss_objects",{customType:"model"}),s=null==(t=null==l?void 0:l.down)?void 0:t.find(t=>t.name===e);s&&(null==s?void 0:s.is_conf)?mr({type:"down",zName:s.title,pname:e}):Le(e,73)}},openPlugin:Le,collectCommand:e=>{if("manger"!==e)if(h.value.label=e.name,"dir"===e.type)wr(e.path);else{const t={...e,fileName:e.name,ext:e.ext||e.name.split(".").pop()};Ur(t)}else Bo()},createCommand:e=>{var t;switch(null==(t=document.querySelector(".vue-recycle-scroller"))||t.scroll({top:0}),e){case"file":case"dir":Z.value=e,Me(e);break;case"link":Ho()}},globalTamperStatus:ce,createItem:ee,fileList:se,fileLength:ie,dirList:ae,dirLength:le,size:Pe,sizeShow:Fe,sizeLoad:Re,table:xe,isNoCreteItem:te,iconView:Ce,listView:De,btnPopover:Ie,diskAnalysis:Y,watchDeleteFileData:e=>{if(0===Object.keys(e).length)return;const{type:t,path:a,isNew:l}=e;l&&(ee.value=[]),"dir"===t?ae.value=ae.value.filter(e=>e.path!==a):se.value=se.value.filter(e=>e.path!==a),de.value={},h.value.total=je.value.length,qe()},watchCreateListType:Me,sizeComputed:async()=>{To();let e=h.value.param.path;if("/"!==e)try{if(Re.value=!0,Y.value.reqEnd&&Y.value.isSetup&&"ltd"===n.value)ae.value=ae.value.map(e=>(e.isDirComputed=!0,e)),qe(),Be();else{const{data:t}=await hs({path:e});Pe.value=t,Fe.value=!0,Re.value=!1}}finally{0===Pe.value.length&&Fe.value&&(Re.value=!1)}},checkRoot:async()=>{"/"===h.value.param.path?Ie.value=!0:Ie.value=!1},initMain:He,bindKeydown:Ve,unbindKeydown:ze,initNavBtn:async()=>{"true"===localStorage.getItem("MYSQL-RECYCLE")&&(Or("database"),localStorage.removeItem("MYSQL-RECYCLE")),Se.value.forEach(e=>{e.show=X.value[e.key]}),await oc(),nc()},refreshList:async()=>{K.value||(K.value=!0,await Ge())},refreshFilesList:Ue,init:()=>{e.getGlobalInfo(),ye(),(()=>{try{Oe(async()=>{const{data:e}=await P({sName:"disk_analysis"});Object.assign(Y.value,{reqEnd:!0,isSetup:e.status&&e.setup&&e.endtime>-1,isBuy:e.endtime>-1})})}catch(e){}})();M("searchFile")&&(qo(),G("searchFile")),_e(I.value)},$reset:()=>{ae.value=[],se.value=[],ne.value=[],oe.value=[],re.value=[],E.value=!1,x.value=!1,h.value.param.search="",J(["/files?action=GetDirNew","/system?action=GetDiskInfo","/task?action=get_task_lists","/plugin?action=get_soft_find","/files?action=get_files_store"])},keydown:Ae}},{persist:[{storage:localStorage,paths:["fileTabList"]}]}),yc=Object.freeze(Object.defineProperty({__proto__:null,default:gc},Symbol.toStringTag,{value:"Module"})),bc={class:""},_c=I(je({__name:"file-cover-confirm",props:{compData:{default:()=>{}}},setup(e,{expose:t}){const a=e,l=Ne([{label:"文件名",prop:"name"},{label:"文件差异(本地->线上)",render:e=>"".concat(_(e.locaSize)," -> ").concat(_(e.size))}]);return t({onConfirm:e=>(a.compData.confirm(e,!0),!1),onCancel:e=>(a.compData.cancel(e,!1),!1)}),(e,t)=>{const s=W;return He(),Be("div",{class:St(["confirm-default","text-default relative p-2rem"])},[t[0]||(t[0]=Je("div",{class:"content flex items-center mb-[10px]"},[Je("i",{class:"svgtofont-el-warning text-titleLarge text-warning"}),Je("div",{class:"message flex flex-col flex-1 ml-4 py-[.3rem] leading-[2.4rem] text-base"},[Je("div",{class:"text text-base text-secondary leading-[2.5rem]"},"检测到上传目录包含重复文件，是否覆盖？")])],-1)),Je("div",bc,[De(s,{column:nt(l),data:a.compData.data,"max-height":170},null,8,["column","data"])])])}}}),[["__scopeId","data-v-74ddacde"]]),{refreshFilesList:wc}=gc(),Sc=d();class kc{constructor(e){t(this,"target",""),t(this,"uploadPath",""),t(this,"uploadElement",null),t(this,"loading",{close:()=>{}}),t(this,"isUpload",!0),t(this,"isGetFiles",!1),t(this,"readFileTimeout",0),t(this,"limit",{size:32212254720,number:1e3}),t(this,"uploadStatus","paused"),t(this,"uploadLimitSize",2097152),t(this,"uploadList",[]),t(this,"uploadTime",{endTime:0,startTime:0}),t(this,"uploadInfo",{estimatedTime:0,uploadedSize:0,speedInterval:null,speedAverage:0,uploadTime:0,fileSize:0,startTime:0,endTime:0,success:0,error:0}),t(this,"fileList",[]),t(this,"fileTotalSize",0),t(this,"fileTotalNumber",0),t(this,"uploadInterval",0),t(this,"uploadCycleSize",[]),t(this,"speedLastTime",0),t(this,"timerSpeed",0),t(this,"uploadError",0),t(this,"isOpenCoverLayer",0),t(this,"uploadedFiles",[]),t(this,"initData",(e=!1)=>{this.uploadStatus="paused",this.uploadList=[],this.isUpload=!0,this.uploadTime={endTime:0,startTime:0},this.isGetFiles=!1,this.uploadInfo={estimatedTime:0,uploadedSize:0,speedInterval:null,speedAverage:0,uploadTime:0,fileSize:0,startTime:0,endTime:0,success:0,error:0},this.fileList=[],this.fileTotalSize=0,this.fileTotalNumber=0,this.uploadInterval=0,this.uploadCycleSize=[],this.speedLastTime=0,this.timerSpeed=0,e&&this.watchFileUploadStatus({status:"paused",timeElapsed:0,averageSpeed:0,uploadSize:"0B",successNumber:0,errorNumber:0})}),t(this,"watchFileList",e=>e),t(this,"watchFileUploadSpeed",e=>e),t(this,"watchFileUploadStatus",e=>e),t(this,"fileUploadLimit",(e,t)=>{const a=t;if(!this.isGetFiles)return!1;const l=e.name.split("."),s=(t=t||e.webkitRelativePath).split("/");t="/".concat(s.slice(0,s.length-1).join("/")).replace("//","/");let i=!1;return this.fileList.forEach((t,l)=>{if(t.path+t.name==a&&t.size==_(e.size))return Sc.error("该文件已存在"),i=!0}),!!i||(this.fileList=this.fileList.filter((e,t)=>e.path+e.name!==a),this.fileList.push({vid:g(8),file:e,path:t,name:e.name,size:_(e.size),type:l.length>1?l[l.length-1]:"txt",status:"paused",progress:0}),this.watchFileList(this.fileList),this.fileTotalSize+=e.size,this.fileTotalNumber++,this.fileTotalNumber>=this.limit.number?(Sc.error("当前文件数量已超过文件上传上限".concat(this.limit.number,"个， 请压缩文件夹后重试！")),!1):!(this.fileTotalSize>=this.limit.size)||(Sc.error("当前文件大小已超过文件上传".concat(_(this.limit.size),"限制， 请使用SFTP/FTP等工具上传文件！")),!1))}),t(this,"uploadFile",(e=0,t=0)=>0!==this.fileList.length&&(0==e&&0==this.uploadList.length&&(this.isOpenCoverLayer=0,this.uploadStatus="uploading",this.uploadedFiles=[],this.uploadCycleSize=[],this.uploadTime.startTime=this.getTimeReal()),this.fileList.length===t?(clearTimeout(this.uploadInterval),this.uploadStatus="success",this.uploadTime.endTime=this.getTimeReal(),this.renderUploadSpeed(),this.initData(),wc(),!1):void this.uploadFileItem(e,t))),t(this,"uploadFileItem",async(e,t)=>{let a=this.fileList[t],l=0;if(null==a)return!1;const{uploadedSize:s}=this.uploadInfo;this.uploadInterval=setInterval(()=>{4===this.uploadCycleSize.length&&this.uploadCycleSize.splice(0,1),this.uploadCycleSize.push(Math.abs(this.uploadInfo.uploadedSize-s))},1e3),this.uploadInfo.endTime=this.getTimeReal();const i=(this.uploadInfo.endTime-this.uploadInfo.startTime)/1e3;this.timerSpeed=Number((this.uploadInfo.fileSize/i).toFixed(2)),this.uploadInfo.startTime=this.getTimeReal();const n=this.getUpdateSpeed();let o=this.uploadLimitSize;const r=Math.floor(n/this.uploadLimitSize);r&&t>1&&(o*=r>4?4:r),0==e&&(this.uploadInfo.startTime=this.getTimeReal(),a={...a,progress:0,upload:2,upload_size:"0B"}),l=Math.min(a.file.size,e+o),this.uploadInfo.fileSize=l-e;const c=this.uploadPath+a.path,u=new FormData;$(),u.append("f_path",c),u.append("f_name",a.name),u.append("f_size",a.file.size),u.append("f_start",e.toString()),u.append("blob",a.file.slice(e,l));try{const{data:s}=await Y({method:"post",url:""+this.target,headers:{"x-http-token":window.vite_public_request_token},data:u});await this.watchUploadStatus(s,a,t,{fileStart:e,fileEnd:l})}catch(p){}}),t(this,"fileSelectHandler",(e,t)=>{var a,l;if(this.readFileTimeout=0,this.isGetFiles=!0,this.loading=Sc.load("正在获取上传文件，请稍候..."),null==(a=e.target)?void 0:a.files){const a=null==(l=e.target)?void 0:l.files;[].forEach.call(a,e=>{this.traverseFileTree(e,t)})}else if(e.dataTransfer.items){const{items:a}=e.dataTransfer;[].forEach.call(a,e=>{const a=(e.webkitGetAsEntry||e.getAsEntry).call(e);if(a){if(!this.isUpload)return!1;this.traverseFileTree(a,t)}})}}),t(this,"traverseFileTree",(e,t)=>{const a=e.fullPath||"";if(e.isFile)e.file(e=>{this.isGetFiles=this.fileUploadLimit(e,a),clearTimeout(this.readFileTimeout),this.readFileTimeout=setTimeout(()=>{if(this.loading.close(),!this.isGetFiles)return this.clearUploadFileList(),this.watchFileList(this.fileList),!1;t&&t(this.fileList)},100)});else if(e.isDirectory){const a=e.createReader(),l=e=>{[].forEach.call(e,e=>{if(!this.isUpload)return!1;this.traverseFileTree(e,t)}),e.length>0&&a.readEntries(l)};a.readEntries(l),setTimeout(()=>{if(0===this.fileList.length&&this.isGetFiles)return Sc.error("拖拽上传文件夹内容为空")},500)}}),t(this,"watchUploadStatus",(e,t,a,l)=>{"number"==typeof e?(this.renderUploadSpeed(a,{...t,progress:(e/t.file.size*100).toFixed(2),upload:2,upload_size:_(e)}),l.fileEnd!=e?this.uploadInfo.uploadedSize+=e:this.uploadInfo.uploadedSize+=parseInt((l.fileEnd-l.fileStart).toString()),setTimeout(()=>{this.uploadFile(e,a)},50)):(e.status?(this.uploadInfo.success++,this.uploadInfo.endTime=this.getTimeReal(),this.uploadInfo.uploadedSize+=parseInt((l.fileEnd-l.fileStart).toString()),this.renderUploadSpeed(a,{...t,upload:1,upload_size:t.size})):(this.renderUploadSpeed(a,{...t,progress:100,upload:-1,errorMsg:e.msg}),this.uploadInfo.error++),this.uploadFile(0,++a))}),t(this,"getUpdateSpeed",()=>{let e=0;for(let a=0;a<this.uploadCycleSize.length;a++)e+=this.uploadCycleSize[a];const t=e/this.uploadCycleSize.length;return isNaN(t)?0:t}),t(this,"renderUploadSpeed",(e,t)=>{if(void 0===e){const e=this.getTimeReal();return void this.watchFileUploadStatus({status:"success",timeElapsed:this.diffTime(this.uploadTime.startTime,e),averageSpeed:this.toSize(this.uploadInfo.uploadedSize/((e-this.uploadTime.startTime)/1e3)),uploadSize:_(this.uploadInfo.uploadedSize),successNumber:this.uploadInfo.success,errorNumber:this.uploadInfo.error})}try{const a=this.fileList[e];if(1===t.upload||-1===t.upload){a.is_upload=!0,this.uploadList.push(a);const e=document.querySelector(".file-upload-list");e&&(1===this.uploadList.length&&(e.scrollTop=0),this.uploadList.length>1&&(e.scrollTop+=45.5))}a.progress=t.progress,a.status=this.isUploadStatus(t.upload),a.message=t.errorMsg||"",this.watchFileList(this.fileList),this.watchFileUploadSpeed({totalProgress:(this.uploadInfo.uploadedSize/this.fileTotalSize*100).toFixed(2),currentSpeed:_(isNaN(this.timerSpeed)?0:this.timerSpeed),timeRemaining:this.time(parseInt(((this.fileTotalSize-this.uploadInfo.uploadedSize)/this.timerSpeed*1e3).toString())),uploadList:this.uploadList.length})}catch(a){}}),t(this,"getFileName",e=>"".concat(e.path,"/").concat(e.name).replace(/\/\//,"/")),t(this,"useFileUploadExistsConfirm",async()=>{const e=this.fileList.map(e=>this.uploadPath+this.getFileName(e)),{data:t}=await(e=>a.post("files/upload_files_exists",{data:e,check:"array"}))({files:e.join("\n")});if(!t)return;const l=[];if(this.fileList.forEach((e,a)=>{const s=t[a];s.exists&&l.push({name:this.getFileName(e),size:s.size,locaSize:e.file.size})}),l.length){const e=(e,t)=>{if(!t)for(let a=this.fileList.length-1;a>=0;a--){const e=this.fileList[a];l.findIndex(t=>t.name.indexOf(e.name)>-1)>=0&&this.fileList.splice(a,1)}Oe(()=>{e(),this.fileList.length?this.uploadFile():this.clearUploadFileList()})};await v({title:"文件冲突确认",area:40,component:_c,compData:{data:l,confirm:e,cancel:e},showFooter:!0,cancelText:"跳过",confirmText:"覆盖"})}else this.fileList.length&&this.uploadFile()}),t(this,"cancelFile",e=>{const t=this.fileList.filter((t,a)=>t.vid!==e.vid);this.fileList=t,this.watchFileList(this.fileList),0===this.fileList.length&&this.clearUploadFileList()}),t(this,"toSize",e=>{const t=[" B"," KB"," MB"," GB"," TB"," PB"];for(let a=0;a<t.length;a+=1){if(e<1024){const l=e.toFixed(2)+t[a];return isNaN(e.toFixed(2))||void 0===l?"0B":l}e/=1024}}),t(this,"time",e=>{const t=Math.floor(e/36e5),a=Math.floor(e/6e4),l=e%6e4/1e3;let s="".concat(l,"秒");return a>0&&(s="".concat(a,"分钟").concat(l.toFixed(0),"秒")),t>0&&(s="".concat(t,"小时").concat(Math.floor((e-36e5*t)/6e4),"分钟")),s}),this.target=e.target,this.uploadPath=e.uploadPath,this.watchFileList=e.renewalData,this.watchFileUploadSpeed=e.renewalSpeed,this.watchFileUploadStatus=e.renewalStatus,this.initData()}uploadStatusInfo(e){return{success:"上传成功",error:"上传失败",uploading:"上传中",paused:"等待上传",waiting:"等待上传"}[e]}isUploadStatus(e){return{"-1":"error",0:"paused",1:"success",2:"uploading",3:"waiting"}[e]}getTimeReal(){return(new Date).getTime()}clearUploadFileList(){this.initData(!0),this.watchFileList(this.fileList)}diffTime(e,t){"number"!=typeof e&&(e=e.getTime()),"number"!=typeof t&&(t=t.getTime());const a=t-e,l=Math.floor(a/6e4),s=a%6e4/1e3;let i="".concat(s.toFixed(l>0?0:2),"秒");return l>0&&(i="".concat(l,"分").concat(s.toFixed(0),"秒")),i}}const Tc=e=>{e.preventDefault()},Lc=e=>{const t=document.querySelector("#upload-mask");return window.addEventListener("dragenter",t=>{Tc(t),e.dragenter(t)}),null==t||t.addEventListener("dragenter",t=>{Tc(t),e.dragenter(t)}),null==t||t.addEventListener("dragleave",t=>{Tc(t),e.dragleave(t)}),null==t||t.addEventListener("dragover",t=>{Tc(t),e.dragover(t)}),null==t||t.addEventListener("drop",t=>{Tc(t),e.drop(t)}),e},Ec=e=>{const t=document.querySelector("#upload-mask");window.removeEventListener("dragenter",e.dragenter),null==t||t.removeEventListener("dragenter",e.dragenter),null==t||t.removeEventListener("dragover",e.dragover),null==t||t.removeEventListener("dragleave",e.dragleave),null==t||t.removeEventListener("drop",e.drop)},xc=We("SOFT-OTHER-STORE",()=>{const{payment:e}=l(),{searchVal:t,historyList:s,showNpsCollect:i,isLoading:n,inputZipFlag:o,speedInstallView:c}=et(Ic()),{scoreEvent:u,unInstallPlugin:m}=Ic(),h=Ne(),g=Ne(null),y=Qe([]),b=Ne({total:0,page:1,row:15}),_=Ne([]),w=Ke({totalProgress:0,uploadList:0,sizeUploaded:0,currentSpeed:0,timeRemaining:0,timeElapsed:0,averageSpeed:0,errorNumber:0,successNumber:0,uploadSize:""}),S=Ne("paused"),k=Ne(null),T=new kc({target:"/files?action=upload",uploadPath:"/tmp/plugin_tmp",renewalData:async e=>{_.value=[...e];const t=e.length>0&&e.every(e=>"success"===e.status),l=e.some(e=>"error"===e.status),s=e.some(e=>"uploading"===e.status);if(!s&&(t||l)&&k.value&&(k.value.close(),k.value=null),!t||l||s)l&&r.error("文件上传失败");else{const t=d().load("正在解析插件压缩包，请稍后...");try{const t=await(i={plugin_zip_path:"/tmp/plugin_tmp/".concat(e[0].name)},a.post("plugin?action=update_zip",{data:i,customType:"model",check:"object"}));if(K("status",t.data)&&K("msg",t.data)&&!t.data.status)return r.error(t.data.msg);L(t.data)}catch(n){}finally{t.close()}}var i},renewalSpeed:e=>{var t,a;if(w.totalProgress=e.totalProgress,w.uploadList=e.uploadList,w.sizeUploaded=e.sizeUploaded,w.currentSpeed=e.currentSpeed,w.timeRemaining=e.timeRemaining,k.value&&"uploading"===S.value){const l=Math.round(e.totalProgress||0);null==(a=(t=k.value).setText)||a.call(t,"正在上传插件，请稍后... ".concat(l,"%"))}},renewalStatus:e=>{S.value=e.status,w.timeElapsed=e.timeElapsed,w.averageSpeed=e.averageSpeed,w.uploadSize=e.uploadSize,w.successNumber=e.successNumber,w.errorNumber=e.errorNumber}}),L=e=>{h.value=e,v({title:"安装第三方插件包",area:50,btn:["确定安装","取消"],component:()=>f(()=>import("./index185.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)})},E=async e=>{h.value=e,g.value=v({title:"".concat(e.title,"购买"),area:50,component:()=>f(()=>import("./index186.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)})},x=()=>Qe([ol({type:"app",onClick:e=>Ll(e)}),rl(),cl("app"),pl(),dl({onClick:E}),ml(),ul({onClick:u}),hl({onChange:async(e,t)=>{(await gl(e,t)).status||I("0")}}),fl(t=>{let a=[];const l=!(e=>e.endtime<0)(t);if(a.push({onClick:E,title:-1!==t.endtime?"立即续费":"立即购买",isHide:()=>l}),t.setup&&!l&&a.push({onClick:m,title:"卸载"}),!l)return a;if(t.setup){const e=Pp(t);a.push({onClick:e=>vl(e,"update"),title:"更新",isHide:()=>!e}),a.push({onClick:Ll,title:"设置"}),a.push({onClick:m,title:"卸载"})}else t.price>0&&!e.value.bindUser?a.push({onClick:()=>Hu(),title:"立即购买"}):a.push({onClick:vl,title:"安装"});return a})]),C=async(e={type:10,query:t.value,p:b.value.page,row:b.value.row,force:"0"})=>{try{e.query=t.value||"";const{data:a}=await Ut(e),{softList:l,total:n,historyList:o,isForce:r}=await bl(a);r&&_l(r),i.value=!l.length,y.value=l,s.value=o,b.value.total=n}catch(a){p(a,"getSoftListData")}finally{n.value=!1}};let D=x();const I=(e="0")=>{D=x(),C({type:10,query:t.value,p:b.value.page,row:b.value.row,force:e})},P=Ke({bugTime:"1",qrcode:"https://www.bt.cn",qrcodeSize:160}),F=Ne(0),R=Ne("0"),N=Ne(0),O=async()=>{clearTimeout(N.value),N.value=setTimeout(async()=>{const{data:e}=await(e=>a.post("auth/get_order_stat",{data:e,check:"number"}))({oid:F.value,type:-1===h.value.endtime?0:1});if(0!==e){I("1");return(await g.value).unmount(),r.success(-1!==h.value.endtime?"续费成功":"购买成功")}O()},1e3)},j=Ne(!1);return{searchVal:t,softTableList:y,tablePageConfig:b,TableColumn:D,importOtherEvent:()=>{const e=document.createElement("input");e.type="file",e.style.display="none",e.accept=".zip,.tar.gz",e.id="update_zip",e.multiple=!0,e.addEventListener("change",async()=>{const t=e.files||[];if(0===t.length)return;const a=t[0];T.isGetFiles=!0;const l="/".concat(""===a.webkitRelativePath?a.name:a.webkitRelativePath);if(T.fileUploadLimit(a,l)){S.value="uploading",k.value=d().load("正在上传插件，请稍后...");try{await T.useFileUploadExistsConfirm()}catch(s){k.value&&(k.value.close(),k.value=null)}}}),e.click()},pageChangeEvent:(e,t)=>{b.value.page=e,b.value.row=t,I("0")},getSoftListData:C,refreshList:I,buyThirdPluginView:E,$reset:()=>{t.value="",y.value=[],b.value.page=1},plugin:P,oid:F,price:R,buyPopup:g,getRenewOrder:async()=>{clearTimeout(N.value),R.value=(h.value.price*Number(P.bugTime)).toFixed(2);const{data:e}=await Yt({pid:h.value.pid,cycle:P.bugTime,type:-1===h.value.endtime?0:1});if(!(null==e?void 0:e.msg.code)){r.request(e);return void(await g.value).unmount()}P.qrcode=e.msg.code,F.value=e.msg.oid,O()},getOrderStatus:O,$reset_buy:()=>{clearTimeout(N.value),F.value=0},rowData:h,isShowSpeedVisible:j,installThirdPlugin:async e=>{try{j.value=!0;const{status:t,msg:a}=await Q({plugin_name:h.value.name,tmp_path:h.value.tmp_path});o.value=!1,r.request({status:t,msg:null==a?void 0:a.replace(/<br>/g,"\n")}),c.value=!1,j.value=!1,I("0"),e()}catch(t){}},cancelInstall:()=>{j.value=!1,r.error("已取消安装!")},installOtherEvent:L,$reset_install:()=>{h.value={}}}}),Cc=We("SOFT-PLUGIN-STORE",()=>{const e=Ke({total:0,page:1,row:15}),t=It("softTypeList",[]),a=Ne([]),{isSpecial:s,searchVal:i,isLoading:o,tabTypeActive:c,showNpsCollect:u,historyList:d}=et(Ic()),{unInstallPlugin:m}=Ic(),{payment:h,forceLtd:g,aliyunEcsLtd:y,ltdRemarks:b,proRemarks:_,remarksInfo:w}=l(),{authType:S,authExpirationTime:k}=Ye(h.value),T=Ke({upgrades:[],version:"",options:[],info:{}}),L=Ne(),E=Ne(),x={speed:"free-time-icon",fifteen:"free-refund-icon",plugin_30:"free-plunge-icon",more:"free-function-icon",recom:"free-certificate-icon",message:"free-function-icon",ip:"free-ip-icon",customer:"contact-customer",plugin_15:"free-fifteen-icon",waf:"icon-file-lock"},C=yt(()=>b.value.map(e=>({title:e[1],icon:x[e[0]]}))),D=yt(()=>_.value.map(e=>({title:e[1],icon:x[e[0]]}))),I=yt(()=>k.value>=0&&"free"!==S.value),P=yt(()=>12===c.value),F=yt(()=>8===c.value),R=yt(()=>I.value&&!(P.value&&"pro"===S.value)),N=yt(()=>!!y.value||(!!(P.value||I.value&&"ltd"===S.value)||!(!F.value&&I.value&&"pro"===S.value)&&!F.value)),O=yt(()=>n(k.value,"yyyy-MM-dd")),j=yt(()=>{const e=(new Date).getTime()/1e3,t=k.value-e;return Math.ceil(t/86400)}),V=yt(()=>N.value?"#966000":"#f1ad29"),z=yt(()=>P.value||N.value?C.value:D.value),M=yt(()=>[{title:"全部",id:0},{title:"已安装",id:-1},...t.value].filter(e=>11!=e.id&&10!=e.id)),q=async(l={type:c.value,query:i.value,p:e.page,row:e.row,force:"0"})=>{try{o.value=!0,l.query=i.value||"";const{data:s}=await Ut(l),{softList:n,total:r,historyList:c,typeList:p,isForce:m}=await bl(s);"1"==l.force&&_l(m),u.value=!r,a.value=n,d.value=c,t.value=p,e.total=r,w.value={auth_tips:s.remarks.auth_tips||{},ltd_key:s.remarks.ltd_key||[],pro_key:s.remarks.pro_key||[]}}catch(s){p(s,"getSoftListData")}finally{o.value=!1}},H=()=>Qe([ol({type:"app",onClick:e=>Ll(e)}),rl(),cl("app"),pl(),dl({onClick:e=>{10!=e.type&&kl(e,0,34)}}),ml(),{label:"状态",prop:"gateway",width:50,render:e=>{if(5!==e.type)return De("span",null,[Ie("--")]);const t="phpmyadmin"===e.name||e.status?"svgtofont-icon-start text-primary":"svgtofont-icon-stop text-danger";return e.setup?De("span",{class:"flex"},[De("i",{class:t},null)]):De("span",null,[Ie("--")])}},hl({onChange:async(e,t)=>{(await gl(e,t)).status||U("0")}}),fl(e=>{let t=[];const a=A(Fp(e.task)),l=Ip(e,S.value),s=A(null==e?void 0:e.preview_url)&&""!=e.preview_url&&!l,i=!!e.route,n=(e,a,l=()=>!1)=>t.push({title:e,onClick:a,isHide:l});if(!l)return n("立即跳转",Tl,()=>!i),n(Fp(e.task),Ru,()=>!a),n("预览",wl,()=>!s),n(-1!==e.endtime?"立即续费":"立即购买",e=>kl(e,e.type,-1!==e.endtime?34:31),()=>l),n("卸载",m,()=>!(!l&&e.setup)),t;const o=Pp(e),r=5!==e.type;return e.setup?(n("更新",e=>vl(e,"update"),()=>!o),n("设置",Ll),n("修复",G,()=>!r),n("卸载",m)):e.is_docker?n("立即前往",()=>{Z.push({name:"docker"})}):n("安装",vl),t})]);let B=H();const U=(t="0")=>{B=H(),q({type:c.value,query:i.value,p:e.page,row:e.row,force:t})},G=async e=>{await rp()||(L.value=e,E.value=v({title:"".concat(e.title,"v").concat(e.version,"-修复插件"),area:50,component:()=>f(()=>import("./index187.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)}))};return{TableColumn:B,searchVal:i,tablePage:e,softTableList:a,typeList:M,refreshPluginList:U,getSoftListData:q,openNpsEvent:()=>Vu({type:16,id:993,isNoRate:!0}),toggleClassEvent:t=>{c.value=t,sessionStorage.setItem("SOFT-PLUGIN-TYPE",String(t)),e.page=1,U("0")},isPay:I,isActiveLtd:P,isActivePro:F,isActivePay:R,isShowType:N,isExpTime:O,isDistanceDays:j,isShowColor:V,recomList:z,pluginPayEvent:async e=>{-2===k.value&&(e=32),Gu({sourceId:e,disablePro:N.value,compulsionLtd:N.value})},plugin:T,helpList:[{content:"无法修复？请尝试切换下版本。"}],getPluginInfo:async()=>{var e;const t=await X({plugin_name:L.value.name,show:1});if(t.status){T.upgrades=t.data;const a=T.upgrades.at(-1)||{beta:!1},l=a.beta?a:{},i=T.upgrades.at(0);if(T.info=L.value.is_beta?l:i,!T.info){const e=L.value.version;T.info={beta:2,m_version:e.split[0],update_msg:0,update_time:0,version:e.split[1]}}s&&(T.options=T.upgrades.map(e=>({label:e.m_version+"."+e.version+(e.beta?"bate":"Stable"),value:e.m_version+"."+e.version})),T.version="".concat((null==(e=T.options.at(0))?void 0:e.value)||""))}else r.error(t.msg)},cutVersionEvent:async()=>{vl({...L.value,version:T.version},"repair")},repairPluginEvent:async()=>{(await E.value).unmount(),vl(L.value,"repair")},softData:L,$reset:()=>{i.value="",a.value=[],t.value=[],e.page=1,L.value={},T.options=[],T.version="",T.upgrades=[],B.value=[]}}}),Dc=We("SOFT-DEPLOY-STORE",()=>{const{tabDeployActive:e,isLoading:t,searchVal:l}=et(Ic()),{scoreEvent:s}=Ic(),i=Ne(null),n=Ne(),c=Ne(),u=Ne({total:0,page:1,row:15}),d=It("deployTypeList",[]),m=Qe([]),h=Qe([]),g=Ne("all"),y=yt(()=>[{title:"全部",tid:0},...d.value]),b=e=>{i.value=e||null,v({title:"".concat(e?"更新":"导入","一键部署项目包").concat(e?"【".concat(e.title,"】"):""),area:60,btn:["提交","取消"],component:()=>f(()=>import("./import.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),showClose:!0})},_=()=>{var e;h.value=(e={list:m.value,limit:u.value.row,p:u.value.page},te(e.limit,e.list)[e.p-1]||[])},S=async e=>{try{e.search||delete e.search,t.value=!0;const{data:l,status:s}=await(e=>a.post("deployment/GetList",{data:e,customType:"default",check:"object"}))(e),i=ee(l),{list:n,dep_type:o}=l;1===Number(e.force)&&_l(s);const r="all"===g.value?"":g.value;i("list")&&w(n)&&(m.value=r?n.filter(e=>{switch(r){case"php":return null===e.project_type||e.project_type===r||0===e.project_type&&0===e.install_type;case"php_async":return e.project_type===r||0===e.project_type&&1===e.install_type;case"java":return e.project_type===r||1===e.project_type;default:return e.project_type===r}}):n,u.value.total=m.value.length,_()),i("dep_type")&&w(o)&&(d.value=o,d.value.push({tid:100,title:"其他"}))}catch(l){p(l)}finally{t.value=!1}};let k=Qe([zt({isHide:100!=e.value,type:"page",key:"name"}),ol({type:"deploy",sortable:!0,onClick:e=>T(e)}),{label:"版本",prop:"version"},cl("deploy"),{label:"项目类型",width:90,render:t=>{if(100===e.value){const e={php_async:"异步项目",java:"Java项目",default:"PHP项目"};return e[t.project_type]||e.default}{const e={1:"Java项目",0:"PHP项目"};return e[t.project_type]||e.default}}},{label:"支持版本",render:e=>{const{php:t,java:a,project_type:l}=e,s=1===l||"java"===l?"JDK版本：":"PHP版本：",i=t||a;return De("span",{title:"支持的".concat(s).concat(i)},[s,i])}},{label:"提供者",prop:"author",render:e=>{let t="--";if("宝塔"===e.author)t=e.title;else t=e.author;return De("span",{class:"bt-link",onClick:()=>(async e=>{e.official?window.open(e.official,"_blank","noopener,noreferrer"):location.reload()})(e)},[t])}},ul({onClick:e=>s(e),sortable:!0}),fl(e=>{let t=[{onClick:T,title:"一键部署"}];return 0===e.id&&(t.push({onClick:b,title:"更新"}),t.push({onClick:x,title:"删除"})),t})]);const T=async e=>(i.value=e,n.value=v({title:"【".concat(e.title,"】一键部署"),area:60,btn:["提交","取消"],component:()=>f(()=>import("./index188.js?v=1764728423").then(e=>e.i),__vite__mapDeps([]),import.meta.url),showClose:!0}),n.value),L=[{label:"删除自定义项目",value:"delete",event:async(t,a)=>{const s=async e=>await Gt({dname:e.name});await t({title:"批量删除",content:"即将删除所选中的项目，是否继续操作?",column:[{prop:"name",label:"项目名称"},qt()],onConfirm:async()=>(await a(s),S({type:e.value,search:l.value}),!1)})}}],E=(t="0")=>{S({type:e.value,search:l.value,force:t})},x=async e=>{try{await o({title:"删除自定义项目",type:"calc",icon:"warning-filled",content:"您真的要删除【".concat(e.name,"】吗？")});const t=await Gt({dname:e.name});t.status?(r.success(t.msg),E()):r.error(t.msg)}catch(t){}},C=Ke({name:"",title:"",php:"",enable_functions:"",version:"",ps:"",file:null,project_type:"php",mysql_version:"",java_version:""}),D=Ne("未选择任何文件"),I=Ne();return{searchVal:l,typeList:y,projectType:g,projectTypeOptions:[{label:"全部项目",value:"all"},{label:"PHP项目",value:"php"},{label:"异步项目",value:"php_async"},{label:"Java项目",value:"java"}],TableColumn:k,deployShowTableList:h,deployTableListRef:c,TableBatchOptions:L,tablePageConfig:u,getDeployListData:S,pageChangeEvent:(e,t)=>{u.value.page=e,u.value.row=t,_()},importProjectEvent:b,toggleClassEvent:t=>{e.value=t,sessionStorage.setItem("SOFT-DEPLOY-TYPE",String(t)),u.value.page=1,u.value.total=0,S({type:t,search:l.value}),k.value[0].isHide=100!=e.value},onChangeProjectType:t=>{u.value.page=1,S({type:e.value,search:l.value,force:"0"})},refreshDeployList:E,fileName:D,helpList:[{content:()=>De(Pt,null,[De("span",{class:"text-danger"},[Ie("请上传zip格式的项目包")]),Ie(",里面必需包含auto_install.json配置文件")])}],cmdForm:C,cmdRules:{name:[{required:!0,message:"请输入项目英文名称",trigger:["blur"]}],title:[{required:!0,message:"请输入项目中文名称",trigger:["blur"]}],php:[{required:!0,message:"请输入项目PHP版本",trigger:["blur"]}],version:[{required:!0,message:"请输入项目版本",trigger:["blur"]}],ps:[{required:!0,message:"请输入项目简介",trigger:["blur"]}],java_version:[{required:!0,message:"请输入JDK版本",trigger:["blur"]}],mysql_version:[{required:!0,message:"请输入Mysql版本",trigger:["blur"]}]},cmdFormRef:I,projectTypeRadio:[{label:"PHP",value:"php"},{label:"Java",value:"java"}],changeProjectType:e=>{I.value.resetFields(),C.project_type=e},importPlugin:()=>{const e=document.createElement("input");e.type="file",e.style.display="none",e.accept=".zip",e.id="update_zip",e.multiple=!0,e.addEventListener("change",async()=>{const t=e.files||[];0!==t.length&&(D.value=t[0].name,C.file=t[0])}),e.click()},onConfirm:async t=>{try{if(await I.value.validate(),!C.file)return void r.error("请上传项目包");if(!C.file.name.endsWith(".zip"))return void r.error("请上传zip格式的项目包");const a=new FormData;a.append("name",C.name),a.append("title",C.title),"php"===C.project_type?(a.append("php",C.php),a.append("enable_functions",C.enable_functions)):(a.append("mysql_version",C.mysql_version),a.append("java_version",C.java_version),a.append("project_type",C.project_type)),a.append("version",C.version),a.append("ps",C.ps),a.append("dep_zip",C.file);let l={headers:{"Content-Type":"multipart/form-data","x-http-token":window.vite_public_request_token}};const s=r.load("正在导入项目，请稍后..."),i=await Y.post("/deployment?action=AddPackage",a,l);s.close(),i.data.status?(u.value.page=1,e.value=100,E(),t(),r.success(i.data.msg)):r.error(i.data.msg)}catch(a){}},initImportForm:()=>{if(i.value){const{name:e,title:t,php:a,enable_functions:l,version:s,ps:n,project_type:o,java:r,mysql:c}=i.value;Object.assign(C,{name:e,title:t,php:a||"",enable_functions:l||"",version:s,ps:n,project_type:"java"===o?"java":"php",mysql_version:c||"",java_version:r||""})}},oneDeploy:n,rowData:i,$reset:()=>{l.value="",g.value="all",m.value=[],h.value=[],u.value={total:0,page:1,row:10}},$reset_import_form:()=>{i.value=null,D.value="未选择任何文件",Object.assign(C,{name:"",title:"",php:"",enable_functions:"",version:"",ps:"",file:null,project_type:"php",mysql_version:"",java_version:""})}}}),Ic=We("SOFT-STORE",()=>{const{mainWidth:e}=l(),t=Re(),s=Ft(),i=yt(()=>{var e;return(null==(e=Ft())?void 0:e.name)||"plugin"}),n=sessionStorage.getItem("SOFT-PLUGIN-TYPE"),c=Ne(n?Number(n):0),u=sessionStorage.getItem("SOFT-DEPLOY-TYPE"),p=Ne(u?Number(u):0),d=Ne(!1),m=Ne(!1),h=Ne(!1),g=Ne(!1),y=Ne(!1),b=Ne([]),_=Qe([]),S=Qe([]),k=Ne(),T={name:"get_soft_list",key:"get_soft_list"},L=Ne(),E=yt(()=>"deployment"!==i.value),x=yt(()=>"plugin"===i.value),C=Ne(),D=Ne(),I=Ne(),P=yt(()=>{var e;const t=null==(e=C.value)?void 0:e.name;return"total"===t||"rsync"===t||"syssafe"===t||"tamper_proof"===t}),F=Ne(!1),R=()=>{var e,t;(null==(e=k.value)?void 0:e.blur)&&k.value.blur(),(null==(t=k.value)?void 0:t.hidePopover)&&k.value.hidePopover()},N=()=>{var e;(null==(e=k.value)?void 0:e.showPopover)&&k.value.showPopover()},O=async(e="0",t)=>{if("other"===i.value){const a=xc(),{tablePageConfig:l}=et(a);t&&(l.value.page=1),a.refreshList(e)}else if("plugin"===i.value){const a=Cc(),{tablePage:l}=et(a);t&&(l.value.page=1),a.refreshPluginList(e)}else if("deployment"===i.value){const a=Dc(),{tablePageConfig:l}=et(a);t&&(l.value.page=1),a.refreshDeployList(e)}},j=async()=>{var e,t;const{data:l}=await a.post("plugin/push_plugin",{customType:"default",check:"array"});w(l)&&2===l.length&&(_.value=(null==(e=l[0])?void 0:e.plugin)||[],S.value=(null==(t=l[1])?void 0:t.plugin)||[])},A=It("softList",[]),V=yt(()=>A.value.slice(0,z.value)||[]),z=yt(()=>e.value<=400?1:Math.floor((e.value-200)/120)),M=async()=>{const{data:e}=await a.post("plugin/get_usually_plugin",{customType:"default",check:"array"});A.value=e},q=Ne(!1),H=Ne(5),B=Qe([{score:5,name:"力荐"},{score:4,name:"好"},{score:3,name:"一般"},{score:2,name:"差"},{score:1,name:"非常差"}]),U=Ke({count:0,total:0,avg:0,rate:0,starList:[]}),G=async(e,t)=>{var l,s;const i=await(n={sName:e,version:t},a.post("plugin/uninstall_plugin",{data:n,loading:"正在卸载，请稍候...",customType:"default",check:"msg"}));var n;return i.status?(r.success(i.msg),O()):r.msg({dangerouslyUseHTMLString:!0,message:i.msg,type:"error",duration:0,showClose:!0}),(null==(l=C.value)?void 0:l.callBack)&&(null==(s=C.value)||s.callBack(i.status)),i.status},W=e=>{"refreshSoftTable"===e.data&&O()};return{tabActive:i,historyList:b,tabTypeActive:c,tabDeployActive:p,showNpsCollect:d,isLoading:m,inputZipFlag:h,speedInstallView:g,isResetDeployPage:y,isPluginView:x,redirectRouter:async()=>{s.name!==i.value&&t.push({name:i.value})},cutTabsEvent:e=>{i.value=e,ie("/soft/"+e)},initSoftView:()=>{window.addEventListener("message",W)},$reset:()=>{window.removeEventListener("message",W),J(["/plugin?action=get_soft_list","/plugin?action=push_plugin","/plugin?action=get_usually_plugin"])},refreshRouteData:O,searchRef:k,softSearchList:_,softRecommendList:S,handleOpenPluginEvent:async(e,t=22)=>{R(),Sp({pluginName:e,source:t})},getHotSoft:j,clearSoftHistory:e=>{b.value.splice(e,1),b.value=[...b.value]},clearFindHistoryEvent:async(e,t)=>{await o({icon:"warning-filled",title:"删除搜索历史记录",content:"删除该条搜索历史【"+e+"】，是否继续？"});const a=ae("正在删除指定搜索历史记录，请稍后...");try{const a=await le({val:e,...T});a.status&&b.value.splice(t,1),r.request(a),N()}catch(l){}finally{a.close()}},inputHistoryEvent:e=>{L.value=e,R(),O("0")},clearAllHistoryEvent:async()=>{await o({icon:"warning-filled",title:"清空搜索历史",content:"清空所有搜索历史记录，是否继续？"});const e=ae("正在清空搜索历史记录，请稍后...");try{const e=await se(T);e.status&&(b.value=[]),r.request(e),N()}catch(t){}finally{e.close()}},initHistory:()=>{0===b.value.length&&R(),_p({promises:[j],delay:100})},$reset_history:()=>{L.value="",b.value=[],_.value=[],S.value=[],d.value=!1},showRefresh:E,triggerHideEvent:R,triggerShowEvent:N,openNPS:()=>{Vu({type:16,id:993,isNoRate:!0})},searchVal:L,initRecently:()=>{_p({promises:[M],delay:500})},handleOpenRecentEvent:e=>{Sp({pluginName:e.name,type:"default"})},getHistoryInfo:M,softNum:z,softList:A,softListSliceData:V,$reset_recently:()=>{A.value=[]},scoreEvent:e=>{C.value=e,D.value=v({title:"【".concat(e.title,"】评分"),area:55,component:()=>f(()=>import("./index189.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)})},loading:q,pluginData:C,pluginScore:U,score:H,getComment:e=>B.value.filter(t=>t.score===e)[0].name,getDetail:async()=>{try{q.value=!0;const t=await(e={pid:C.value.id,p:1},a.post("plugin/get_score",{data:e,customType:"default",check:"array"}));if(t.status){const e=t.data.split.reverse(),a=t.data.total;U.avg=Number(((1*e[4]+2*e[3]+3*e[2]+4*e[1]+5*e[0])/a).toFixed(1)),U.count=C.value.count,U.total=a,U.rate=0!==a?Number((100*Number(((e[0]+e[1])/a).toFixed(2))).toFixed(0)):0;for(let t=0;t<5;t++)U.starList.push(Number((100*Number((e[t]/a).toFixed(2))).toFixed(0)));q.value=!1}}catch(t){}var e},onSubmitScore:async()=>{try{const t=await(e={pid:C.value.id,num:H.value,ps:"用户未做任何评价"},a.post("plugin/set_score",{data:e,customType:"default",check:"msg"}));t.status?(O(),(async e=>{const t=await e.value;t&&t.unmount()})(D),r.success(t.msg)):r.error(t.msg)}catch(t){}var e},$reset_score:()=>{C.value={},U.starList=[]},unInstallPlugin:e=>{C.value=e,I.value=v({showFooter:!0,title:"卸载",area:45,component:()=>f(()=>import("./index190.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)})},onUnInstall:async()=>{let e=C.value.version;for(var t=0;t<C.value.versions.length;t++)if(C.value.versions[t].setup&&C.value.version.includes(C.value.versions[t].m_version)){e=C.value.versions[t].m_version,e.indexOf(".")<0&&(e+="."+C.value.versions[t].version);break}const l=C.value.name;if(P){if(F.value){const t=await(s={soft_name:l},a.post("plugin/save_plugin_settings",{data:s,customType:"default",check:"msg"}));return t.status?G(l,e):(r.error(t.msg),t.status)}return G(l,e)}return G(l,e);var s},unInstall:G,isSpecial:P,checked:F}}),Pc=Object.freeze(Object.defineProperty({__proto__:null,SOFT_STORE:Ic,useSoftStore:()=>{const e=Ic();return{...e,...et(e)}}},Symbol.toStringTag,{value:"Module"})),Fc=e=>v({title:"".concat(e.title,"- 更新日志"),area:52,component:()=>f(()=>import("./history-version.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),compData:{name:e.name,title:e.title}}),{isRefreshSoftList:Rc,isUpdatePayment:Nc,updatePluginCheck:Oc}=l(),jc=(e,t,a)=>{var l,s;const{title:i,name:n,ps:o,type:r,dependnet:c,other_php:u,versions:p,version:d}=e,m=n.split("-")[0];var h;a.title=i,a.name=n,a.isBeta=!!e.is_beta,a.ps=o,a.type=r,a.call=t,a.isInstall="i"===t,a.isUpdate="u"===t,a.isRepair="r"===t,a.isPHPInstall="php"===m&&"i"===t,a.isBeta=!!e.is_beta,a.isSystem=5===r,a.isPHPInstall="php"===m,a.isMysqlUpdate="mysql"===m&&("r"===t||"u"===t),a.isSpecialPlugins=["apache","nginx","mysql"].includes(n),a.introduction=(h=e.introduction)?h.split(";").map(e=>e.split("|")):[],a.compile=["nginx","apache","mysql","php"].includes(m),a.currentVersion=d||"",a.otherPHP=u||[],a.versions=p||[],a.dependnet=c,a.isDependnet=!((null==(l=null==c?void 0:c.need)?void 0:l.length)||(null==(s=null==c?void 0:c.selected)?void 0:s.length))},Ac=async(e,t,a)=>{var l,s;const i=F(a);let o=e.versions[a||0];if(i&&e.isSystem){const t=e.versions.findIndex(t=>e.currentVersion.indexOf(t.m_version)>-1);t>=0&&(o=e.versions[t])}if(e.isPHPInstall)if(i&&(a=e.otherPHP.findIndex(t=>t.name===e.name)),o=e.otherPHP[a||0],e.name!==o.name){const e=r.load("正在获取PHP版本信息，请稍候..."),{data:t}=await P({sName:o.name});o=t.versions[0],e.close()}else o=e.versions[0];if(e.isSystem||(t.updateTime=o.update_time?n(o.update_time,"yyyy/MM/dd"):"无",t.isBeta=!!o.beta,t.updateMsg=o.update_msg||"暂无内容"),t.mVersion=o.m_version,e.isSystem&&e.isUpdate&&!e.isPHPInstall){const a=await Gc(e);if(!a.length)return void(t.fullVersion="版本错误");t.version=null==(l=a[0])?void 0:l.version,t.fullVersion="".concat(null==(s=a[0])?void 0:s.m_version,".").concat(a[0].version)}else t.version=o.version,t.fullVersion="".concat(o.m_version).concat(o.version?"."+o.version:"");return t},Vc=(e,t)=>({sName:e.name,version:t.mVersion,min_version:t.version}),zc=async(e,t=1,a)=>{if(await Jc(e))return;if(0===t){if(!(await Mc(e,e.upgrade?"更新":"安装")))return;a()}const l=r.load("正在添加安装任务，请稍候...");try{const{data:a}=await Qt({...e,type:t});if(K("status",a)&&K("msg",a)&&!a.status)return void r.msg({dangerouslyUseHTMLString:!0,message:'<div style="line-height:22px;">'.concat(a.msg,"</div>"),type:"error",duration:2e3});Rc.value=!0,Ru(),setTimeout(()=>{r.request(a)},1e3)}catch(s){}finally{l.close()}},Mc=async(e,t)=>{return e.sName,a=t,new Promise((e,t)=>{v({title:"编译安装",area:45,btn:["提交并".concat(a),"取消"],component:()=>f(()=>import("./compile-install.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),onConfirm:()=>e(!0),onCancel:()=>e(!1)})});var a},qc=async(e,t)=>{try{const a=await Bc({pluginTitle:t.title,pluginName:e.sName,fullVersion:t.fullVersion}),{data:l}=await Qt({...e});return a.unmount(),K("status",l)&&K("msg",l)&&!l.status?(r.msg({message:'<div style="line-height:22px;">'.concat(l.msg,"</div>"),type:"error",duration:2e3,showClose:!0,dangerouslyUseHTMLString:!0}),!1):l}catch(a){}},Hc=async(e,t,a,l="")=>{var s,i;const n=await Uc({title:"正在".concat({i:"安装",r:"修复",u:"更新"}[a],"插件：").concat(l,",请稍候..."),msg:"正在安装插件，请稍候..."}),o=await oe({plugin_name:e,tmp_path:t,install_opt:a});r.request(o);const{inputZipFlag:c}=et(Ic());if(c.value=!0,n.unmount(),Oc.value.status)return Oc.value.status=!1,void(null==(i=(s=Oc.value).callback)||i.call(s));"/soft/plugin"!==location.pathname?window.location.reload():Rc.value=!0},Bc=({pluginTitle:e,pluginName:t,fullVersion:a})=>(({pluginTitle:e,pluginName:t,fullVersion:a})=>{const{downLoadPopup:l}=et(Wc());return l.value=v({area:45,component:()=>f(()=>import("./download-speed.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),compData:{pluginTitle:e,pluginName:t,fullVersion:a}})})({pluginTitle:e,pluginName:t,fullVersion:a}),Uc=e=>(e=>{const{compData:t}=et(Wc());return t.value={speedConfig:e},v({title:e.title||"正在执行安装脚本，请稍候...",area:[50,26.4],component:()=>f(()=>import("./speed-install.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),compData:e})})(e),Gc=async e=>{var t,a,l;let s=[];const i=null==(a=null==(t=e.currentVersion)?void 0:t.match(/(\d+\.\d+)/))?void 0:a.at(1);if(e.isMysqlUpdate){const t=null==(l=e.currentVersion.match(/(greatsql_\d+\.\d+|mariadb_\d+\.\d+|AliSQL)/))?void 0:l.at(1);s=e.versions.filter(e=>e.m_version===t||e.m_version===i)}else s=e.versions.filter(e=>e.m_version===i);return s},Jc=async e=>{const{data:t}=await ne();if(!K("task",t))return!1;const{task:a}=t;if(e.sName.indexOf("php-")>-1){if(a.some(t=>{let a=t.name.match(/-(.*?)\]/)&&t.name.match(/-(.*?)\]/)[1]===e.version,l=t.name.indexOf("php-")>-1;return a&&l}))return r.error("正在安装相同版本的php插件，不可重复安装!"),!0}let l=["nginx","apache","openlitespeed"];if(l.includes(e.sName)){if(a.some(e=>e.name.match(/\[(.*?)-/)&&l.includes(e.name.match(/\[(.*?)-/)[1])))return r.error("正在安装同类型软件nginx,apache或openLiteSpeed，不可重复安装!"),!0}return!1},Wc=We("INSTALL-STORE",()=>{var e,t;const{installInfo:a}=l(),s=Ne(),i=Ne(),n=[[7,"免","border-disabled text-darkTertiary"],[8,"专","border-[var(--bt-pro-light-color)] text-[var(--bt-pro-color)]"],[12,"企","border-[var(--bt-ltd-light-color)] text-[var(--bt-ltd-color)]"]],c=Xe({title:"",name:"",ps:"",type:0,call:"i",isBeta:!1,isSystem:!1,isInstall:!1,isUpdate:!1,isRepair:!1,isSpecialPlugins:!1,isPHPInstall:!1,isMysqlUpdate:!1,otherPHP:[],compile:!1,currentVersion:"",versions:[],label:[],introduction:[],isDependnet:!1,dependnet:{need:[],selected:[]}}),u=Ke({fullVersion:"",mVersion:"",version:"",isBeta:!1,status:!1,updateTime:"",updateMsg:""}),p=Xe({value:0,version:[]}),d=Ne(!1),m=Ne([]),h=Ne(!0),f=Ke({progress:0,done:0,total:0,estimated:0,speed:0}),v=["安装完成","Successify","complete"],g=Ne(null==(t=null==(e=s.value)?void 0:e.speedConfig)?void 0:t.msg),y=Ne(null),b=Ne({args_name:"",ps:"",args:"",init:"#在编译前执行的shell脚本内容，通常为第三方模块的依赖安装和源码下载等前置准备"}),w=Ne(),S=Ne(!1),k={mode:"ace/mode/nginx",theme:re.value?"ace/theme/clouds_midnight":"ace/theme/chrome",wrap:!0,showInvisibles:!1,showFoldWidgets:!1,useSoftTabs:!0,tabSize:2,showPrintMargin:!1,readOnly:!1,fontSize:"12px"},T=yt(()=>c.title.indexOf("PHP-")>-1?"PHP":c.title),L=yt(()=>n.find(e=>e[0]===c.type)||[]),E=yt(()=>{var e;return"soft_ico/ico-".concat((null==(e=c.name)?void 0:e.indexOf("php-"))>-1?"php":c.name,".png")}),x=yt(()=>_(f.done)),C=yt(()=>_(f.total)),D=yt(()=>_(f.speed)),I=Ne([{label:"模块名称",prop:"name"},{label:"模块描述",prop:"ps"},{label:"是否启用",render:e=>De(Fe,{modelValue:e.checked,"onUpdate:modelValue":t=>e.checked=t,onChange:()=>{A()}},null)},{label:"操作",align:"right",render:e=>[De("div",{class:"flex items-center justify-end"},[De("span",{class:"bt-link",onClick:()=>j(e)},[Ie("删除")])])]}]),R=Ne([{name:"模块名称",ps:"模块描述"}]),N=Qe({args_name:[{required:!0,message:"请输入模块名称",trigger:"blur"}],args:[{required:!0,message:"请输入模块参数",trigger:"blur"}]}),O=async()=>{try{const e=await de({name:c.name});R.value=e.data.args;const t=e.data.config.split("\n");R.value.forEach(e=>{t.includes(e.name)?e.checked=!0:e.checked=!1})}catch(e){}},j=async e=>{try{await o({content:"确认删除模块【 ".concat(e.name,"】 吗？"),title:"提示",icon:"warning-filled"});const t=await ce({name:c.name,args_name:e.name});O(),r.request(t)}catch(t){}},A=async()=>{const e=r.load("正在设置模块，请稍后...");try{const t=R.value.filter(e=>e.checked).map(e=>e.name).join("\n"),a=await ue({name:c.name,args_names:t});e.close(),r.request(a),O()}catch(t){}finally{e.close()}},V=Ne(),z=async()=>{var e;const{inputZipFlag:t,speedInstallView:a}=et(Ic());try{const l=await he({num:10,filename:"/tmp/panelShell.pl"}),s=l.msg.trim().split("\n"),i=v.some(e=>s[s.length-1].includes(e));if("Successify"===s[s.length-1]||!0===t.value||i)return t.value=!1,a.value=!1,J(),!1;g.value=l.msg,(null==(e=y.value)?void 0:e.scrollHeight)&&(y.value.scrollTop=y.value.scrollHeight),V.value=setTimeout(()=>{z()},1e3)}catch(l){}},M=async()=>{try{const{data:e}=await me({plugin_name:c.name});e.status&&(f.done=e.down_size,f.total=e.total_size,f.progress=e.down_pre,f.estimated=e.need_time,f.speed=e.sec_speed),h.value&&setTimeout(()=>{h.value&&M()},400)}catch(e){}},q=e=>{p.value=e,Ac(c,u,p.value)},H=async()=>{const e=await a.value;null==e||e.unmount()},B=()=>{s.value.softData&&s.value.softData.callBack&&s.value.softData.callBack()},U=Ne(),G=Ne(),J=()=>{U.value&&clearTimeout(U.value),G.value&&clearTimeout(G.value),V.value&&clearTimeout(V.value)};return{customFormRef:w,compData:s,$reset:()=>{u.fullVersion="",u.mVersion="",u.version="",u.isBeta=!1,u.status=!1,u.updateTime="",u.updateMsg="暂无日志"},init:async()=>{if(!s.value.name)return;const e=K("name",s.value.pluginInfo)?s.value.pluginInfo:s.value.name;await(async(e,t,a)=>{if(Rt(e)&&K("name",e))return void jc(e,t,a);const l=r.load("正在获取插件信息，请稍候..."),{data:s}=await P({sName:e});l.close(),jc(s,t,a)})(e,s.value.type,c),await((e,t)=>{const a=[],{versions:l,isPHPInstall:s,otherPHP:i}=e;s?(i.map((e,t)=>{a.push({title:e.name,key:t,disabled:e.status,data:e})}),t.value=i.findIndex(t=>t.name===e.name),t.version=a):(l.map((t,l)=>{let s=F(t.beta)?" Beta":" Stable",i=e.name+" ";e.isSystem?s="":i="",a.push({title:"".concat(i).concat(t.m_version).concat(""===t.version?"":".".concat(t.version)).concat(s),key:l,data:t})}),t.value=0,t.version=a)})(c,p),await Ac(c,u),s.value.name&&"mysql"===s.value.name&&c.isInstall&&p.version.forEach((e,t)=>{/^5\.7\.\d+/.test(e.title.replace("mysql","").trim())&&(p.value=t,q(t))})},pluginModuleInfo:c,pluginActiveInfo:u,versionModel:p,cutPluginActiveInfo:q,install:async e=>{try{const t=Vc(c,u);if(0!==e&&H(),c.isSystem)return await zc(t,e,()=>H());const a=await(async(e,t)=>{const a=await qc(e,t);if(!a)return!1;a&&Hc(e.sName,a.tmp_path,"i",t.title)})(t,{title:c.title,fullVersion:u.fullVersion});if(!a)return!1;B()}catch(t){}},repair:async()=>{try{const e=Vc(c,u);H(),(async(e,t)=>{const a=await qc(e,t);a&&Hc(e.sName,a.tmp_path,"r",t.title)})(e,{title:c.title,fullVersion:u.fullVersion})}catch(e){}},update:async()=>{try{const e=Vc(c,u);if(e.upgrade=e.version,!c.isSystem&&H(),c.isSystem)return await(async(e,t)=>{e.isMysqlUpdate&&await o({title:"更新[MySQL]",isHtml:!0,width:"40rem",content:'<div class="!text-secondary">更新过程可能会导致服务中断,您真的现在就将[MySQL]更新到['.concat(t,']吗?</div>\n\t\t\t\t<div class="text-danger">更新数据库有风险,建议在更新前,先备份您的数据库</div>\n\t\t\t\t<div class="text-danger">若您的是云服务器,强烈建议您在更新前做一个快照</div>\n\t\t\t\t<div class="text-danger">建议您在服务器负载闲时进行软件更新</div>'),type:"calc"})})(c,u.fullVersion),await zc(e,0,()=>H());(async(e,t)=>{const a=await qc(e,t);a&&Hc(e.sName,a.tmp_path,"u",t.title)})(e,{title:c.title,fullVersion:u.fullVersion})}catch(e){}},clearTimeoutAll:J,pluginImgSrc:E,pluginTitle:T,pluginLabel:L,pluginPictureSrc:e=>{const t=c.name.includes("php-")?"php":c.name,a=c.introduction[e];return"https://www.bt.cn/Public/new/plugin/".concat(t,"/").concat(a[1])},getHistoryVersion:async()=>{try{d.value=!0;const{data:e}=await X({plugin_name:s.value.name});m.value=e,d.value=!1}catch(e){}},historyLoad:d,historyData:m,getSoftDownloadSpeed:M,downloadSpeed:f,doneSize:x,totalSize:C,speedSize:D,closeInstall:B,initDownLoad:()=>{U.value=setTimeout(()=>{M()},100)},downLoadPopup:i,closeDownLoad:async()=>{h.value=!1;(await i.value).unmount()},initSpeed:()=>{const{speedInstallView:e}=et(Ic());G.value=setTimeout(()=>{z(),e.value=!0},100)},speedMsg:g,getCustomModuleData:O,config:k,customForm:b,customVisible:S,clearAddForm:()=>{b.value={args_name:"",ps:"",args:"",init:"#在编译前执行的shell脚本内容，通常为第三方模块的依赖安装和源码下载等前置准备"}},rules:N,setCustomModuleData:A,tableColumn:I,handleAddCustomModule:()=>{S.value=!0},customData:R,submitCustomModule:async()=>{var e;await(null==(e=w.value)?void 0:e.validate());try{S.value=!1;const e=await pe({name:c.name,...b.value});r.request(e),O()}catch(t){}}}}),$c=()=>et(Wc()),Yc=()=>a.post("plugin/get_index_list"),Kc=(e={})=>a.post("plugin/get_soft_list",{data:e,check:"object"}),Qc=e=>a.post("plugin?action=add_index",{data:{sName:e},customType:"model",check:"msg"}),Xc=e=>a.post("plugin?action=remove_index",{data:{sName:e},customType:"model",check:"msg"}),Zc=(e={})=>a.post("warning/get_list",{data:e}),eu=()=>a.post("warning/get_result",{check:"object"}),tu=()=>a.post("project/safecloud/get_safe_overview",{customType:"model"}),au=()=>a.post("project/safecloud/get_pending_alarm_trend",{customType:"model"}),lu=()=>a.post("project/safecloud/get_security_trend",{customType:"model"}),su=()=>a.post("project/safecloud/get_security_dynamic",{customType:"model"}),iu=()=>a.post("/plugin?action=a&name=bt_hids&s=set_process",{customType:"model"}),nu=e=>a.post("plugin/sort_index",{data:e}),ou=()=>a.post("system/ReMemory"),ru=e=>a.post("monitor/process_management/kill_process_all",{data:e,customType:"model",check:"msg"}),cu=()=>a.post("warning/get_scan_bar",{check:"object"}),uu=()=>a.post("safe/security/get_repair_bar",{check:"object",customType:"model"}),pu=()=>a.post("panel/overview/GetOverview",{check:"array",customType:"model"}),du=e=>a.post("panel/overview/AddOverview",{data:e,check:"msg",customType:"model"}),mu=e=>a.post("panel/overview/SetOverview",{data:e,check:"msg",customType:"model"}),hu=e=>a.post("panel/overview/SortOverview",{data:e,check:"msg",customType:"model"}),fu=e=>a.post("panel/overview/DelOverview",{data:e,check:"msg",customType:"model"}),vu=()=>a.post("warning/get_tmp_result"),gu=()=>a.post("warning/kill_get_list"),yu=e=>a.post("system/set_rname",{data:e,check:"msg"}),bu=e=>a.post("/mod/ssh/com/index_ssh_info",{data:e,check:"array",customType:"model"}),_u=()=>a.post("/safe/exportreport/get_pdf",{check:"object",customType:"model"}),wu=()=>a.post("/project/safecloud/get_safecloud_list",{check:"object",customType:"model"}),Su=(e={})=>a.post("/project/safecloud/get_webshell_result",{data:e,customType:"model",check:"object"}),ku=()=>a.post("/project/scanning/get_vuln_info",{check:"object",customType:"model"}),Tu=()=>a.post("/project/safecloud/get_config",{customType:"model",check:"object"}),Lu=e=>a.post("/project/safecloud/set_config",{data:e,customType:"model",check:"object"}),Eu=e=>a.post("/project/safecloud/ignore_file",{data:e,customType:"model",check:"object"}),xu=e=>a.post("/project/safecloud/deal_webshell_file",{data:e,customType:"model",check:"object"}),Cu=e=>a.post("/project/safecloud/set_alarm_config",{data:e,customType:"model",check:"object"});$c();const{forceLtd:Du,aliyunEcsLtd:Iu,payment:Pu,panel:Fu}=l(),Ru=()=>v({title:"消息盒子",area:[72,56],component:()=>f(()=>import("./index191.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)}),Nu=async()=>v({title:"重启服务器或者面板",area:[33,11],component:()=>f(()=>import("./index192.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)}),Ou=()=>v({title:"设置菜单显示隐藏",area:[35,40],component:()=>f(()=>import("./index193.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)}),ju=()=>v({title:!1,area:20,component:()=>f(()=>import("./index194.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)}),Au=()=>v({area:60,component:()=>f(()=>import("./index195.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)}),Vu=e=>v({area:52,compData:e,component:()=>f(()=>import("./index196.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)}),zu=()=>v({area:60,component:()=>f(()=>import("./index197.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),async cancel(){await be({questions:JSON.stringify({25:"用户未填写任何信息"}),product_type:19,software_name:"Enterprise-Edition-Survey",rate:0})}}),Mu=e=>v({title:"".concat(e.title,"配置"),area:54,compData:e,component:()=>f(()=>import("./index198.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)}),qu=e=>v({area:[75,68.6],compData:e,component:()=>f(()=>import("./index199.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)}),Hu=async(e="绑定宝塔账号，享受更多服务",t="")=>{var a,l;if(Iu.value)return d().error("当前为企业版，无法切换账号。");let s=()=>f(()=>import("./index112.js?v=1764728423"),__vite__mapDeps([]),import.meta.url);try{const i=Ne({client:0,login:0}),n=await ve();if(n.status&&0!==(null==(a=n.data)?void 0:a.login))switch(i.value.client=n.data.client,i.value.login=n.data.login,null==(l=n.data)?void 0:l.client){case 1:s=()=>f(()=>import("./tencent-bind-user.js?v=1764728423"),__vite__mapDeps([]),import.meta.url);break;case 2:s=()=>f(()=>import("./ali-bind-user.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)}return v({area:40,component:s,compData:{authData:i.value,title:e,isDialog:!0,redirect:t}})}catch(i){return v({area:40,component:()=>f(()=>import("./index112.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)})}},Bu=()=>v({area:20,component:()=>f(()=>import("./index200.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)}),Uu=()=>v({area:20,component:()=>f(()=>import("./index201.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)}),Gu=Dt(e=>{const t=Iu.value?[82,60]:[100,72],a=(!Iu.value||"ltd"===Pu.value.authType)&&(!fe(e.showClose)||e.showClose);return v({area:t,showClose:a,compData:{...e,disablePro:!!F(e.disablePro)||e.disablePro},component:()=>f(()=>import("./index202.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)})},1e3),Ju=async e=>{const{installInfo:t}=l();return t.value=v({area:63,compData:e,component:()=>f(()=>import("./index203.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)}),t.value},Wu=e=>{const{title:t,type:a,callback:l}=e;return v({title:t,area:50,compData:{type:a,callback:l},component:()=>f(()=>import("./index204.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)})},$u=async({id:e=999,type:t,name:a,softName:l="panel",description:s,isNoRate:i=!1,title:n,isCard:o=!0,isShowPhone:r=!0})=>Vu({id:e,type:t,name:a,softName:l,description:s,isNoRate:i,title:n,isCard:o,isShowPhone:r}),Yu=async e=>{var t;const a=e.pluginInfo;if(!a){const{data:t}=await P({sName:e.name});e.pluginInfo=t}const l={phpmyadmin:()=>Ku(),tomcat:()=>Zu(a),pureftpd:()=>Qu(a),memcached:()=>ep(a),nginx:()=>tp(a),mysql:()=>Xu(a),openlitespeed:()=>ap(a),php:()=>lp(a),apache:()=>sp(a)};if((null==(t=a.name)?void 0:t.includes("php-"))||l[a.name]){if(a.name.includes("php-"))return l.php();if(l[a.name])return l[a.name]()}},Ku=()=>v({isAsync:!0,title:"PHPMyAdmin",area:[74,56],component:()=>f(()=>import("./index205.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)}),Qu=e=>v({isAsync:!0,title:"Ftp管理",area:[100,56],component:()=>f(()=>import("./index206.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),compData:e,showClose:!0}),Xu=e=>v({isAsync:!0,title:"Mysql",area:[80,65],component:()=>f(()=>import("./index207.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),compData:e,showClose:!0}),Zu=e=>v({isAsync:!0,title:"Tomcat管理",area:[64,54],component:()=>f(()=>import("./index208.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),compData:e,showClose:!0}),ep=e=>v({isAsync:!0,title:"Memcached管理",area:[64,54],component:()=>f(()=>import("./index209.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),compData:e,showClose:!0}),tp=e=>v({isAsync:!0,title:"Nginx",area:[68,58],component:()=>f(()=>import("./index210.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),compData:e,showClose:!0}),ap=e=>v({isAsync:!0,title:"OpenLiteSpeed",area:[64,54],component:()=>f(()=>import("./index211.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),compData:e,showClose:!0}),lp=e=>v({isAsync:!0,title:"PHP-".concat(e.version,"管理"),area:[80,64],component:()=>f(()=>import("./index212.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),compData:e,showClose:!0}),sp=e=>v({isAsync:!0,title:"Apache",area:[68,58],component:()=>f(()=>import("./index213.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),compData:e,showClose:!0}),ip=async({name:e,options:t,request:a,selectList:l})=>{await v({title:"批量设置".concat(e),area:"40",compData:{name:e,options:t,selectList:l,request:a},showFooter:!0,component:()=>f(()=>import("./index214.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)})},np=async(e,t="editor",a="")=>{const l=await f(()=>Promise.resolve().then(()=>fc),void 0,import.meta.url),{useCreateEditorTabs:s,editorExample:i}=await f(()=>Promise.resolve().then(()=>Mn),void 0,import.meta.url),{FilesAceEditor:n}=l,o={path:e,title:e.split("/").pop(),type:t,mode:a};i.value?s(o):n(o)},op=(e,t)=>{if(!e.length)return d().error("操作失败，请重试");v({title:"批量".concat(t.title||"操作","结果"),area:42,component:()=>f(()=>import("./index125.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),compData:{resultData:e,resultTitle:t.title||"操作"}})},rp=async()=>{if(sessionStorage.getItem("diskWarn"))return!1;const e=localStorage.getItem("checkWarnInfo");if(e)try{const t=JSON.parse(e),{byte_size:a}=t;return Number(a[0])-Number(a[1])<=524288e3?(await v({title:!1,showClose:!1,area:[40,36],component:()=>f(()=>import("./index215.js?v=1764728423"),__vite__mapDeps([]),import.meta.url)}),!0):(sessionStorage.removeItem("diskWarn"),!1)}catch(t){return!1}return!1},cp=async()=>{var e,t;const l=It("newsslDiscountStatus",!1);if(l.value&&["ssl251104"].includes(Fu.value.oem)){const s=ae("正在获取商业SSL优惠信息，请稍后..."),{data:i}=await a.post("/ssl/cert/get_newssl_discount",{customType:"model",check:"object"});if(l.value=!1,s.close(),!i.status)return!1;v({title:!1,area:42,component:()=>f(()=>import("./index216.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),compData:{title:(null==(e=null==i?void 0:i.data)?void 0:e.message)||"恭喜您获得：".concat((null==(t=null==i?void 0:i.data)?void 0:t.discount_info)||"","优惠"),instructions:["请先安装Nginx环境，创建网站后使用","创建网站后，设置-SSL-宝塔证书，进行证书申请","优惠券请在7天内使用，过期优惠券将作废",'<a class="bt-link" href="https://www.bt.cn/new/ssl-promo.html" target="_blank">点击查看教程</a>'],confirmText:"立即安装套件"}})}return!1},up=async()=>{const{success:e,error:t}=d(),{data:{detail:a,status:l}}=await ge({activity_id:47}),s=a[0];if((null==s?void 0:s.id)&&1===(null==s?void 0:s.buy_status)&&1===l)return v({title:!1,area:42,component:()=>f(()=>import("./index216.js?v=1764728423"),__vite__mapDeps([]),import.meta.url),compData:{title:s.product_name,instructions:["请先安装Nginx环境，创建网站后使用","创建网站后，设置-SSL-宝塔证书，进行证书申请","优惠券请在"+n((new Date).getTime()+1e3*s.timeout,"yyyy-MM-dd")+"前使用，过期优惠券将作废",'<a class="bt-link" href="https://www.bt.cn/new/ssl-promo.html" target="_blank">点击查看教程</a>'],confirmText:"点击领取",confirmEvent:async()=>{const a=ae("正在领取优惠券，请稍后...");try{const l=await ye({detail_id:s.id});a.close(),l.status?e(l.data):t(l.msg)}catch(l){t(l.message)}finally{a.close()}}}})},pp=je({__name:"index",props:Nt({version:{},allAlarm:{type:Boolean,default:!1},multiple:{type:Boolean,default:()=>!0},limit:{default:()=>[]},options:{},isDefault:{type:Boolean,default:!1},isShowApi:{type:Boolean,default:!0}},{modelValue:{},modelModifiers:{}}),emits:Nt(["change"],["update:modelValue"]),setup(e,{expose:t,emit:a}){const{getOldSenderAlarmListInfo:s,push:i}=l(),n=e,{load:o,error:r}=d(),c=Ne(!1),u=Ot(e,"modelValue"),p=["dingding","feishu","mail","weixin","wx_account","sms"],m=a,h=Qe([]),f=e=>{m("change",e)},v=async()=>{try{c.value=!0,await s();const e=[];for(const t in i.value.old)if(Object.prototype.hasOwnProperty.call(i.value.old,t)){const a=i.value.old[t];if(a.setup&&!n.limit.includes(a.name)){const t=!("{}"===JSON.stringify(a.data));a.isSetAlarm=t,e.push({label:a.title,value:a.name,disabled:!a.setup||!t,isSetAlarm:!t,render:()=>{const e=!a.setup||!t;return De("div",{class:"flex justify-between"},[De("span",null,[a.title]),De("span",{class:"".concat(e?"text-danger":"hover:text-primary"," cursor-pointer mr-[4px]")},[De("span",{onClick:e=>{e.stopPropagation(),g(a)}},[e?"[未配置]":"[已配置]"])])])}})}}if(h.value=e,n.options&&(h.value=[...n.options,...e]),n.isShowApi||(h.value=h.value.filter(e=>p.includes(e.value))),n.allAlarm&&h.value.unshift({label:"全部",value:"all",disabled:!1,isSetAlarm:!1,render:()=>De("div",{class:"flex justify-between"},[Ie("全部"),De("span",null,null)])}),Array.isArray(u.value)&&u.value.length?u.value.forEach(e=>{h.value.find(t=>t.value===e)||(u.value=u.value.filter(t=>t!==e))}):A(u.value)&&u.value&&(h.value.find(e=>e.value===u.value)||(u.value="")),n.isDefault&&!u.value){const t=e.filter(e=>!e.disabled);t.length&&(u.value=n.multiple?[t[0].value]:t[0].value)}}catch(e){}finally{c.value=!1}},g=async e=>{const t=[{title:"钉钉机器人",type:"dingding"},{title:"飞书机器人",type:"feishu"},{title:"邮箱",type:"mail"},{title:"企业微信机器人",type:"weixin"},{title:"微信公众号",type:"wx_account"}].find(t=>t.type===e.name)||{title:"",type:"",data:{}};"wx_account"!==e.name||e.setup||await y(e.name),Mu({...t,callback:v})},y=async e=>{const t=o("正在安装模块，请稍后...");try{await _e({name:e})}catch(a){}finally{t.close()}};return wt(v),t({refresh:v}),(t,a)=>{const l=we,s=ze("bt-loading");return Me((He(),ot(l,{modelValue:u.value,"onUpdate:modelValue":a[0]||(a[0]=e=>u.value=e),multiple:e.multiple,options:nt(h),placeholder:"请选择告警方式",onChange:f},null,8,["modelValue","multiple","options"])),[[s,nt(c)]])}}}),dp=je({__name:"index",props:Nt({multiple:{type:Boolean,default:()=>!0},limit:{default:()=>[]}},{modelValue:{},modelModifiers:{}}),emits:Nt(["change"],["update:modelValue"]),setup(e,{expose:t,emit:a}){const{getSenderAlarmListInfo:s,push:i}=l(),n=e,o=Ne(!1),r=Ot(e,"modelValue"),c=a,u=Qe([]),p=e=>{c("change",e)},d=[{title:"钉钉",type:"dingding"},{title:"飞书",type:"feishu"},{title:"邮箱",type:"mail"},{title:"企业微信",type:"weixin"},{title:"微信公众号",type:"wx_account"},{title:"短信通知",type:"sms"},{title:"自定义消息通道",type:"webhook"}],m=async()=>{try{const e=[...d];o.value=!0,await s(!1),u.value=[];const t=i.value.config.filter(e=>e.used&&!n.limit.includes(e.sender_type)),a=e.filter(e=>!t.some(t=>t.sender_type===e.type)&&!n.limit.includes(e.type));t.forEach(e=>{var t;const a=d.find(t=>t.type===e.sender_type);let l=(null==(t=e.data)?void 0:t.title)?e.data.title+(e.data.title?" (".concat((null==a?void 0:a.title)||"",")"):""):a.title;if("sms"===e.sender_type){if(!e.data.total)return!1;l="短信通知 (".concat(e.data.count,"条)")}u.value.push({label:l||a.title,value:e.id,disabled:!1,render:()=>De("div",{class:"flex justify-between"},[De("span",{class:"mr-[10px]"},[l]),De("span",{class:"hover:text-primary cursor-pointer mr-[4px]"},[De("span",{onClick:t=>{t.stopPropagation(),h({...a,data:e,name:e.sender_type,setup:!0,isSetAlarm:!0})}},["sms"!==e.sender_type?"[已配置]":""])])])})}),a.forEach(e=>{u.value.push({label:e.title,value:"",disabled:!0,render:()=>De("div",{class:"flex justify-between"},[De("span",null,[e.title]),De("span",{class:"text-danger cursor-pointer mr-[4px]",onClick:t=>{t.stopPropagation(),h({...e,setup:!1,name:e.type,data:{},isSetAlarm:!1})}},["sms"!==e.type?"[未配置]":""])])})})}catch(e){}finally{o.value=!1}},h=async e=>{const t=[{title:"钉钉机器人",type:"dingding"},{title:"飞书机器人",type:"feishu"},{title:"邮箱",type:"mail"},{title:"企业微信机器人",type:"weixin"},{title:"微信公众号",type:"wx_account"},{title:"自定义消息通道",type:"webhook"},{title:"短信通知",type:"sms"}].find(t=>t.type===e.name)||{title:"",type:"",data:{}};Mu({...t,data:e})};t({refresh:m}),wt(m);const f=yt(()=>{var e;return(null==(e=n.limit)?void 0:e.length)?u.value.filter(e=>{var t;const a=null==(t=d.find(t=>{var a;return(null==(a=e.label)?void 0:a.includes(t.title))||"function"==typeof e.render&&e.render().toString().includes(t.title)}))?void 0:t.type;return!n.limit.includes(a)}):u.value});return Ae([()=>n.limit,()=>u.value],([e,t])=>{if((null==e?void 0:e.length)&&r.value&&(null==t?void 0:t.length))if(Array.isArray(r.value)){const e=f.value.map(e=>e.value);e.length>0&&(r.value=r.value.filter(t=>e.includes(t)))}else f.value.some(e=>e.value===r.value)||(r.value=void 0)},{deep:!0,immediate:!0}),Ae(()=>u.value,e=>{(null==e?void 0:e.length)&&r.value&&Oe(()=>{const e=f.value.map(e=>e.value);Array.isArray(r.value)?r.value=r.value.filter(t=>e.includes(t)):e.includes(r.value)||(r.value=void 0)})},{immediate:!0}),(t,a)=>{const l=we,s=ze("bt-loading");return Me((He(),ot(l,{modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=e=>r.value=e),multiple:e.multiple,options:nt(f),onChange:p,placeholder:"请选择告警方式"},null,8,["modelValue","multiple","options"])),[[s,nt(o)]])}}}),{payment:mp,pluginInfo:hp,forceLtd:fp,aliyunEcsLtd:vp,resetAuthState:gp}=l(),yp=d(),bp=async(e,t)=>{if(0===e.length)return t&&t(!0);const[a,...l]=e;try{const e=await a();t&&t(e)}catch(s){}return bp(l,t)},_p=async({promises:e,callback:t,delay:a,isRouter:l,check:s})=>{const i=window.location.pathname;return await new Promise(e=>{setTimeout(()=>{l||(l=window.location.pathname),l&&!s?e(ke(l,i)):s&&s()?e(!0):e(!1)},a||0)})?bp(e,t):t&&t(!0)},wp=async e=>{try{let{pluginName:t,pluginInfo:a}=e;if(F(t)&&F(a))return yp.error("缺少参数: options.name 或 options.pluginInfo"),Promise.reject(new Error("缺少参数: options.name 或 options.pluginInfo"));if(Te(a))return a;A(a)&&(t=a);const{data:l}=await P({sName:t});return a=l,a}catch(t){return Promise.reject(t)}},Sp=async e=>{(e.name||e.softData)&&(e.pluginName=(null==e?void 0:e.name)||"",e.pluginInfo=(null==e?void 0:e.softData)||e.pluginInfo);const t=await wp(e),{isPay:a}=await(async e=>{if("ltd"===mp.value.authType&&mp.value.authExpirationTime>0)return{isPay:!0,type:"ltd",pluginInfo:Te(e.pluginInfo)?e.pluginInfo:e.pluginName};const t=await wp(e),{endtime:a,type:l}=t;return"pro"===mp.value.authType&&mp.value.authExpirationTime>0&&8===l?{isPay:!0,type:"pro",pluginInfo:t}:a>=0?{isPay:!0,type:"plugin",pluginInfo:t}:{isPay:!1,type:"free",pluginInfo:t}})({pluginInfo:t});if(!a&&[8,12].includes(t.type))return Gu({disablePro:8!==t.type,compulsionLtd:8!==t.type,sourceId:e.source,...(null==e?void 0:e.plugin)?{pluginInfo:t}:{}});if(!t.setup)return(async e=>{var t;await Ju({...e,name:e.name||(null==(t=e.pluginInfo)?void 0:t.name),type:"i"})})({pluginInfo:t,installNow:(null==e?void 0:e.installNow)||!1});const l=["mysql","pureftpd","nginx","apache","tomcat","memcached","openlitespeed","phpmyadmin"].includes(t.name),s=-1!==t.name.indexOf("php-");if(l||s)return Yu({pluginInfo:t});if(!(await kp(t.name)))return!1;sessionStorage.setItem("pluginViewInfo",JSON.stringify({...t,built:e.pluginInfo?"1":"0"})),hp.value.visible=!0,hp.value.id=t.name,hp.value.name=t.title,hp.value.callback=(null==e?void 0:e.callback)||null},kp=async e=>{try{const{data:t}=await Se(e);return t.msg&&-1!==t.msg.indexOf("您无操作此插件的权限")?(yp.request(t),Promise.resolve(!1)):Promise.resolve(!0)}catch(t){}},Tp=async()=>{try{if(vp.value)return d().error("当前为企业版，无法解绑账号。");await o({icon:"warning-filled",title:"解绑宝塔账号",width:"35rem",content:"解绑宝塔账号后，将无法正常使用面板功能，是否继续操作？"});const e=await xe();gp(),yp.request(e),e.status&&setTimeout(()=>Z.push({name:"bind-user"}),2e3)}catch(e){}},Lp=(e={readonly:!1,theme:"chrome"})=>({mode:"ace/mode/nginx",theme:re.value?"ace/theme/clouds_midnight":"ace/theme/".concat(e.theme||"chrome"),wrap:!0,showInvisibles:!1,showFoldWidgets:!1,useSoftTabs:!0,tabSize:2,showPrintMargin:!1,readOnly:e.readonly,fontSize:"12px"}),Ep=(e,t,a,l)=>({type:"custom",key:t,rules:(null==a?void 0:a.rules)||{},render:s=>{const i=Le({key:t},s);return De(Ee,{label:e,prop:i},{default:()=>[De(pp,jt({modelValue:s.value[i],"onUpdate:modelValue":e=>s.value[i]=e},(null==a?void 0:a.attrs)||{},{onChange:l}),null)]})}}),xp=(e,t,a,l)=>({type:"custom",key:t,rules:(null==a?void 0:a.rules)||{},render:s=>{var i;const n=Le({key:t},s);return De(Ee,{label:e,prop:n,"label-width":null==(i=null==a?void 0:a.attrs)?void 0:i.labelWidth},{default:()=>[De(dp,jt({modelValue:s.value[n],"onUpdate:modelValue":e=>s.value[n]=e},(null==a?void 0:a.attrs)||{},{onChange:l}),null)]})}}),Cp=(e,t,a,l)=>{try{let s={all:Number(a)||0,exclude_ids:[]};if(t&&Te(t[0])?s.exclude_ids=t.map(e=>e.id):s.exclude_ids=t,s.exclude_ids=JSON.stringify(s.exclude_ids),l&&l.params&&(s={...s,...l.params}),a)return s;const i=Z.currentRoute.value.meta.icon;return e&&w(e)&&(null==e||e.forEach(e=>{const t="".concat(i,"_list");s[t]||(s[t]=[]),s[t].push({id:e.id,[(null==l?void 0:l.key)||"name"]:e[(null==l?void 0:l.key)||"name"]})}),s["".concat(i,"_list")]=JSON.stringify(s["".concat(i,"_list")])),s}catch(s){}},Dp=e=>{var t,a,l,s,i,n;try{const o={data:[],msg:(null==e?void 0:e.msg)||"操作成功！"};return K("data",e)&&e.data||K("success",e)||K("error",e)?(K("data",e)&&e.data||(e.data={error:e.error||[],success:e.success||[]}),o.msg=e.msg||"操作完成！",Te(null==(t=e.data)?void 0:t.error)&&(e.data.error=Object.entries(e.data.error).map(e=>({name:e[0],msg:e[1],status:!1}))),A(null==(a=e.data)?void 0:a.success[0])&&(e.data.success=e.data.success.map(e=>({name:e,msg:"操作成功！",status:!0}))),(null==(l=e.data)?void 0:l.error.length)>0&&(e.data.error=e.data.error.map(e=>(K("status",e)||(e.status=!1),e))),(null==(s=e.data)?void 0:s.success.length)>0&&(e.data.success=e.data.success.map(e=>(K("status",e)||(e.status=!0),e))),o.data=null==(n=e.data)?void 0:n.error.concat(null==(i=e.data)?void 0:i.success)):w(e)?o.data=e:yp.request(e),o}catch(o){}},Ip=({endtime:e,type:t},a)=>e>=0||"ltd"===a||("pro"===a&&12!==t||"free"===a&&12!==t&&8!==t),Pp=e=>{var t;if("phpmyadmin"===e.name)return!1;if(!e.versions)return!1;if((null==(t=e.versions)?void 0:t.length)>1){const t=["Redis"];if(e.admin&&!t.includes(e.title)){const t=e.versions[0],a="".concat(t.m_version,".").concat(t.version);let l=e.version!==a;if(e.is_beta){const t=e.versions[e.versions.length-1];if(1===t.beta){const a="".concat(t.m_version,".").concat(t.version);l=e.version!==a&&e.version<a}}if(l&&"mongodb"!==e.name)return!0}else for(let a=0;a<e.versions.length;a++){const t=e.versions[a];if(2===Ce(e.version,"".concat(t.m_version,".").concat(t.version)))return!0}}else{const t=e.versions[0];let a=!!t.beta;void 0===a&&(a=!1),void 0===e.is_beta&&(e.is_beta=!1);const l="".concat(t.m_version,".").concat(t.version);if(e.version!==l&&a===e.is_beta&&e.version<l)return!0}return!1},Fp=e=>{let t=!1;switch(e){case"-1":t="正在安装";break;case"0":t="等待安装";break;case"-2":t="正在更新"}return t};export{Hr as $,Or as A,Ul as B,pr as C,br as D,Pl as E,gc as F,El as G,To as H,xr as I,Ir as J,$r as K,Yr as L,Bo as M,Pr as N,ar as O,Ur as P,mr as Q,Ar as R,Uo as S,No as T,nr as U,Gr as V,Jr as W,Wr as X,Kr as Y,tc as Z,dp as _,Ou as a,Qt as a$,Er as a0,Qr as a1,Zr as a2,Xr as a3,Fr as a4,ec as a5,lc as a6,hr as a7,sc as a8,ac as a9,Yc as aA,nu as aB,uc as aC,xl as aD,Ic as aE,Cc as aF,xc as aG,yl as aH,Dc as aI,up as aJ,Nu as aK,Fc as aL,Zt as aM,ma as aN,ha as aO,ba as aP,ca as aQ,ra as aR,ua as aS,da as aT,pa as aU,Ga as aV,ga as aW,va as aX,fa as aY,oa as aZ,ya as a_,Ho as aa,os as ab,hs as ac,ur as ad,fs as ae,Oo as af,rc as ag,np as ah,Wc as ai,$c as aj,ou as ak,Uu as al,yu as am,ru as an,pu as ao,bu as ap,fu as aq,du as ar,mu as as,hu as at,cp as au,rp as av,ju as aw,Kc as ax,Qc as ay,Xc as az,Hu as b,ao as b$,Kt as b0,Xt as b1,ta as b2,ea as b3,sa as b4,la as b5,aa as b6,ia as b7,na as b8,Da as b9,Ha as bA,Ba as bB,Ma as bC,Ka as bD,Jt as bE,$t as bF,Qa as bG,Wa as bH,Wt as bI,Ya as bJ,$a as bK,Ja as bL,vc as bM,Kn as bN,Br as bO,Un as bP,Gn as bQ,nc as bR,eo as bS,to as bT,_o as bU,us as bV,So as bW,ro as bX,oo as bY,lo as bZ,io as b_,Ia as ba,wa as bb,Sa as bc,_a as bd,Ta as be,ka as bf,xa as bg,Ra as bh,Na as bi,Fa as bj,Oa as bk,Za as bl,tl as bm,al as bn,ll as bo,Aa as bp,za as bq,Va as br,Ca as bs,La as bt,Ea as bu,Pa as bv,ja as bw,el as bx,qa as by,Ua as bz,ip as c,Tu as c$,Wn as c0,Bn as c1,Qo as c2,Di as c3,ni as c4,bi as c5,Ti as c6,pi as c7,Ei as c8,mi as c9,Xn as cA,Qn as cB,no as cC,Yn as cD,Zn as cE,so as cF,Hn as cG,qn as cH,Yi as cI,kc as cJ,Lc as cK,Ec as cL,$n as cM,ko as cN,gs as cO,on as cP,_n as cQ,an as cR,ys as cS,Cn as cT,Ep as cU,pp as cV,xp as cW,Tp as cX,zu as cY,wu as cZ,eu as c_,ki as ca,ci as cb,zi as cc,jl as cd,kr as ce,ui as cf,ji as cg,gi as ch,oi as ci,_i as cj,di as ck,Si as cl,hi as cm,Sn as cn,On as co,jn as cp,Ai as cq,Vi as cr,Fi as cs,Vn as ct,Hi as cu,zn as cv,mn as cw,Yl as cx,ps as cy,cs as cz,$u as d,Lu as d0,gu as d1,vu as d2,cu as d3,uu as d4,Zc as d5,Lp as d6,Xa as d7,iu as d8,au as d9,lu as da,su as db,tu as dc,_u as dd,Eu as de,xu as df,Su as dg,ku as dh,Cu as di,qr as dj,wo as dk,Pc as dl,Vu as e,qu as f,_p as g,Cp as h,Dp as i,Bu as j,Ju as k,Sp as l,Ru as m,Au as n,op as o,Gu as p,hc as q,gr as r,Mu as s,oc as t,Dr as u,qo as v,wr as w,$o as x,ir as y,Vr as z};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
